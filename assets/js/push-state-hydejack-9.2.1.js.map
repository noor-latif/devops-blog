{"version":3,"sources":["webpack:///./_js/src/cross-fader.js","webpack:///./_js/src/flip/index.js","webpack:///./_js/src/flip/title.js","webpack:///./_js/src/push-state.js"],"names":["RE_CSS_URL","calcHash","doc","_pageStyle$innerText","sidebar","getElementById","sidebarBg","querySelector","pageStyle","innerText","trim","classList","style","backgroundImage","join","isExternal","_ref","protocol","host","location","arguments","length","undefined","window","objectURLs","WeakMap","CrossFader","constructor","fadeDuration","document","prevHash","themeColorEl","fetchImage2","newDocument","_newDocument$querySel","_newDocument$querySel2","result","exec","of","url","URL","origin","fetchRx","href","_objectSpread","method","headers","Accept","mode","pipe","switchMap","r","blob","map","createObjectURL","catchError","fetchImage","hash","EMPTY","objectURL","_newDocument$querySel3","div","createElement","concat","set","updateStyle","_newDocument$getEleme","setAttribute","_newDocument$head$que","themeColor","head","content","setTimeout","_pageStyle$parentNode","newPageStyle","parentNode","replaceChild","e","process","console","error","fade","_ref2","_ref3","_prevDiv$parentNode","prevDiv","insertBefore","nextElementSibling","animate","opacity","duration","easing","finalize","_prevDiv$parentNode2","has","revokeObjectURL","get","removeChild","FLIP_TYPES","setupFLIP","start$","ready$","fadeIn$","options","other$","filter","flipType","includes","merge","setupFLIPTitle","TITLE_SELECTOR","animationMain","settings","flip$","anchor","title","add","textContent","transformOrigin","page","empty","call","appendChild","position","first","getBoundingClientRect","last","firstFontSize","parseInt","getComputedStyle","fontSize","lastFontSize","invertX","left","invertY","top","invertScale","transform","tap","complete","_ref4","zip","_ref5","replaceEls","main","_ref6","x","subscribe","_asyncToGenerator","Promise","all","Element","prototype","webComponentsReady","NAVBAR_SEL","CROSS_FADE_DURATION","FADE_OUT","FADE_IN","setupAnimationMain","pushStateEl","_pushStateEl$parentNo","importTemplate","previousElementSibling","setupLoading","navbarEl","lastElementChild","setupErrorPage","pathname","getFlipType","el","_el$getAttribute","contains","getAttribute","Number","animateFadeOut","fill","mapTo","animateFadeIn","drawerEl","loadingEl","fromEventX","eventName","mapFn","fromEvent","detail","_","share","Object","assign","after$","progress$","error$","fadeOut$","context","pointerEvents","_noDrawer","_drawerEl$parentNode","remove","exhaustMap","display","p","toPromise","transitionUntil","promise","timer","crossFader","_ref7","_ref8","takeUntil","startWith","pairwise","mergeMap","_ref9","prev","curr","_ref10","_pushState"],"mappings":"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","file":"push-state-hydejack-9.2.1.js","sourcesContent":["// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { EMPTY, of } from 'rxjs';\nimport { catchError, finalize, map, switchMap } from 'rxjs/operators';\n\nimport { animate, fetchRx } from './common';\n\nconst RE_CSS_URL = /url\\s*\\(['\"]?(([^'\"\\\\]|\\\\.)*)['\"]?\\)/u;\n\n/** @param {Document} doc */\nconst calcHash = (doc) => {\n  const sidebar = doc.getElementById('_sidebar');\n  const sidebarBg = sidebar?.querySelector('.sidebar-bg');\n  const pageStyle = doc.getElementById('_pageStyle');\n  // const rule = Array.from(pageStyle?.sheet?.rules ?? []).find(r => r.selectorText === 'html');\n  // const accentColor = rule?.style.getPropertyValue('--accent-color') ?? '';\n  // const themeColor = rule?.style.getPropertyValue('--theme-color') ?? '';\n  return [\n    pageStyle?.innerText?.trim(),\n    sidebar?.classList,\n    sidebarBg?.classList,\n    sidebarBg?.style.backgroundImage,\n  ].join('\\n');\n};\n\n/**\n * Consider a URL external if either the protocol, hostname or port is different.\n * @param {URL} param0\n * @param {Location=} location\n */\nfunction isExternal({ protocol, host }, location = window.location) {\n  return protocol !== location.protocol || host !== location.host;\n}\n\nconst objectURLs = new WeakMap();\n\nexport class CrossFader {\n  /** @param {number} fadeDuration */\n  constructor(fadeDuration) {\n    this.sidebar = document.getElementById('_sidebar');\n    this.fadeDuration = fadeDuration;\n    this.prevHash = calcHash(document);\n    this.themeColorEl = document.querySelector('meta[name=\"theme-color\"]');\n  }\n\n  /** @param {Document} newDocument */\n  fetchImage2(newDocument) {\n    const { backgroundImage = '' } = newDocument.querySelector('.sidebar-bg')?.style ?? {};\n    const result = RE_CSS_URL.exec(backgroundImage);\n    if (!result) {\n      return of('');\n    }\n\n    const url = new URL(result[1], window.location.origin);\n\n    return fetchRx(url.href, {\n      method: 'GET',\n      headers: { Accept: 'image/*' },\n      ...(isExternal(url) ? { mode: 'cors' } : {}),\n    }).pipe(\n      switchMap((r) => r.blob()),\n      map((blob) => URL.createObjectURL(blob)),\n      catchError(() => of(url.href)),\n    );\n  }\n\n  /** @param {Document} newDocument */\n  fetchImage(newDocument) {\n    const hash = calcHash(newDocument);\n    if (hash === this.prevHash) return EMPTY;\n\n    return this.fetchImage2(newDocument).pipe(\n      map((objectURL) => {\n        /** @type {HTMLDivElement} */\n        const div = newDocument.querySelector('.sidebar-bg') ?? document.createElement('div');\n\n        if (objectURL) {\n          div.style.backgroundImage = `url(${objectURL})`;\n          objectURLs.set(div, objectURL);\n        }\n\n        return [div, hash, newDocument];\n      }),\n    );\n  }\n\n  /** @param {Document} newDocument */\n  updateStyle(newDocument) {\n    const classList = newDocument.getElementById('_sidebar')?.classList;\n    if (classList) this.sidebar.setAttribute('class', classList);\n\n    if (this.themeColorEl) {\n      const themeColor = newDocument.head.querySelector('meta[name=\"theme-color\"]')?.content;\n      if (themeColor) {\n        window.setTimeout(() => {\n          if (this.themeColorEl) {\n            this.themeColorEl.content = themeColor;\n          }\n        }, 250);\n      }\n    }\n\n    try {\n      const pageStyle = document.getElementById('_pageStyle');\n      const newPageStyle = newDocument.getElementById('_pageStyle');\n      if (!newPageStyle) return;\n      pageStyle?.parentNode?.replaceChild(newPageStyle, pageStyle);\n    } catch (e) {\n      if (process.env.DEBUG) console.error(e);\n    }\n  }\n\n  /**\n   * @param {[HTMLDivElement]} param0\n   * @param {[HTMLDListElement, string, Document]} param1\n   */\n  fade([prevDiv], [div, hash, newDocument]) {\n    prevDiv?.parentNode?.insertBefore(div, prevDiv.nextElementSibling);\n\n    this.updateStyle(newDocument);\n\n    // Only update the prev hash after we're actually in the fade stage\n    this.prevHash = hash;\n\n    return animate(div, [{ opacity: 0 }, { opacity: 1 }], {\n      duration: this.fadeDuration,\n      easing: 'ease',\n    }).pipe(\n      finalize(() => {\n        if (objectURLs.has(prevDiv)) URL.revokeObjectURL(objectURLs.get(prevDiv));\n        prevDiv?.parentNode?.removeChild(prevDiv);\n      }),\n    );\n  }\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { merge } from 'rxjs';\nimport { filter } from 'rxjs/operators';\n\nimport { setupFLIPTitle } from './title';\n\nconst FLIP_TYPES = ['title'];\n\nexport function setupFLIP(start$, ready$, fadeIn$, options) {\n  const other$ = start$.pipe(filter(({ flipType }) => !FLIP_TYPES.includes(flipType)));\n\n  return merge(setupFLIPTitle(start$, ready$, fadeIn$, options), other$);\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { Observable, of, zip } from 'rxjs';\nimport { tap, finalize, filter, map, switchMap } from 'rxjs/operators';\n\nimport { animate, empty } from '../common';\n\nconst TITLE_SELECTOR = '.page-title, .post-title';\n\n/**\n * @param {Observable<any>} start$\n * @param {Observable<any>} ready$\n * @param {Observable<any>} fadeIn$\n * @param {any} opts\n */\nexport function setupFLIPTitle(start$, ready$, fadeIn$, { animationMain, settings }) {\n  if (!animationMain) return start$;\n\n  const flip$ = start$.pipe(\n    filter(({ flipType }) => flipType === 'title'),\n    switchMap(({ anchor }) => {\n      if (!anchor) return of({});\n\n      const title = document.createElement('h1');\n\n      title.classList.add('page-title');\n      title.textContent = anchor.textContent;\n      title.style.transformOrigin = 'left top';\n\n      const page = animationMain.querySelector('.page');\n      if (!page) return of({});\n\n      empty.call(page);\n      page.appendChild(title);\n\n      animationMain.style.position = 'fixed';\n      animationMain.style.opacity = 1;\n\n      const first = anchor.getBoundingClientRect();\n      const last = title.getBoundingClientRect();\n      const firstFontSize = parseInt(getComputedStyle(anchor).fontSize, 10);\n      const lastFontSize = parseInt(getComputedStyle(title).fontSize, 10);\n\n      const invertX = first.left - last.left;\n      const invertY = first.top - last.top;\n      const invertScale = firstFontSize / lastFontSize;\n\n      anchor.style.opacity = 0;\n\n      const transform = [\n        {\n          transform: `translate3d(${invertX}px, ${invertY}px, 0) scale(${invertScale})`,\n        },\n        { transform: 'translate3d(0, 0, 0) scale(1)' },\n      ];\n\n      return animate(title, transform, settings).pipe(\n        tap({\n          complete() {\n            animationMain.style.position = 'absolute';\n          },\n        }),\n      );\n    }),\n  );\n\n  start$\n    .pipe(\n      switchMap(({ flipType }) =>\n        zip(\n          ready$.pipe(\n            filter(() => flipType === 'title'),\n            map(({ replaceEls: [main] }) => {\n              const title = main.querySelector(TITLE_SELECTOR);\n              if (title) title.style.opacity = 0;\n              return title;\n            }),\n          ),\n          fadeIn$,\n        ).pipe(\n          map(([x]) => x),\n          tap((title) => {\n            if (title) title.style.opacity = 1;\n            animationMain.style.opacity = 0;\n          }),\n          finalize(() => {\n            animationMain.style.opacity = 0;\n\n            const page = animationMain.querySelector('.page');\n            empty.call(page);\n          }),\n        ),\n      ),\n    )\n    .subscribe();\n\n  return flip$;\n}\n","// Copyright (c) 2019 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { fromEvent, merge, timer, zip } from 'rxjs';\nimport {\n  tap,\n  exhaustMap,\n  map,\n  mapTo,\n  mergeMap,\n  pairwise,\n  share,\n  startWith,\n  switchMap,\n  takeUntil,\n} from 'rxjs/operators';\n\nimport { animate, empty, importTemplate, webComponentsReady } from './common';\nimport { CrossFader } from './cross-fader';\nimport { setupFLIP } from './flip';\n\n(async () => {\n  await Promise.all([\n    ...('fetch' in window ? [] : [import(/* webpackChunkName: \"fetch\" */ './polyfills/fetch')]),\n    ...('customElements' in window\n      ? []\n      : [import(/* webpackChunkName: \"webcomponents\" */ './polyfills/webcomponents')]),\n    ...('animate' in Element.prototype ? [] : [import(/* webpackChunkName: \"webanimations\" */ 'web-animations-js')]),\n    ...('IntersectionObserver' in window\n      ? []\n      : [import(/* webpackChunkName: \"intersection-observer\" */ 'intersection-observer')]),\n  ]);\n\n  await webComponentsReady;\n\n  const NAVBAR_SEL = '#_navbar > .content > .nav-btn-bar';\n\n  const CROSS_FADE_DURATION = 2000;\n\n  const FADE_OUT = [{ opacity: 1 }, { opacity: 0 }];\n  const FADE_IN = [\n    { opacity: 0, transform: 'translateY(-3rem)' },\n    { opacity: 1, transform: 'translateY(0)' },\n  ];\n\n  function setupAnimationMain(pushStateEl) {\n    pushStateEl?.parentNode?.insertBefore(importTemplate('_animation-template'), pushStateEl);\n    return pushStateEl?.previousElementSibling;\n  }\n\n  function setupLoading(navbarEl) {\n    navbarEl?.appendChild(importTemplate('_loading-template'));\n    return navbarEl?.lastElementChild;\n  }\n\n  function setupErrorPage(main, url) {\n    const { pathname } = url;\n    const error = importTemplate('_error-template');\n    const anchor = error?.querySelector('.this-link');\n    if (anchor) {\n      anchor.href = pathname;\n      anchor.textContent = pathname;\n    }\n    main?.appendChild(error);\n    return main?.lastElementChild;\n  }\n\n  function getFlipType(el) {\n    if (el?.classList.contains('flip-title')) return 'title';\n    if (el?.classList.contains('flip-project')) return 'project';\n    return el?.getAttribute?.('data-flip');\n  }\n\n  const pushStateEl = document.querySelector('hy-push-state');\n  if (!pushStateEl) return;\n\n  const duration = Number(pushStateEl.getAttribute('duration')) || 350;\n  const settings = {\n    duration: duration,\n    easing: 'ease',\n  };\n\n  const animateFadeOut = ({ main }) => animate(main, FADE_OUT, { ...settings, fill: 'forwards' }).pipe(mapTo({ main }));\n\n  const animateFadeIn = ({ replaceEls: [main], flipType }) =>\n    animate(main, FADE_IN, settings).pipe(mapTo({ main, flipType }));\n\n  const drawerEl = document.querySelector('hy-drawer');\n  const navbarEl = document.querySelector(NAVBAR_SEL);\n\n  const animationMain = setupAnimationMain(pushStateEl);\n  const loadingEl = setupLoading(navbarEl);\n\n  const fromEventX = (eventName, mapFn) =>\n    fromEvent(pushStateEl, eventName).pipe(\n      map(({ detail }) => detail),\n      mapFn ? map(mapFn) : (_) => _,\n      share(),\n    );\n\n  const start$ = fromEventX('hy-push-state-start', (detail) =>\n    Object.assign(detail, { flipType: getFlipType(detail.anchor) }),\n  );\n  const ready$ = fromEventX('hy-push-state-ready');\n  const after$ = fromEventX('hy-push-state-after');\n  const progress$ = fromEventX('hy-push-state-progress');\n  const error$ = fromEventX('hy-push-state-networkerror');\n\n  const fadeOut$ = start$.pipe(\n    map((context) => Object.assign(context, { main: document.getElementById('_main') })),\n    tap(({ main }) => {\n      main.style.pointerEvents = 'none';\n    }),\n    window._noDrawer && drawerEl?.classList.contains('cover')\n      ? tap(() => {\n          drawerEl.classList.remove('cover');\n          drawerEl.parentNode?.appendChild(drawerEl);\n        })\n      : (_) => _,\n    exhaustMap(animateFadeOut),\n    tap(({ main }) => empty.call(main)),\n    share(),\n  );\n\n  if (loadingEl) {\n    progress$.subscribe(() => {\n      loadingEl.style.display = 'flex';\n    });\n    ready$.subscribe(() => {\n      loadingEl.style.display = 'none';\n    });\n  }\n\n  const fadeIn$ = after$.pipe(\n    switchMap((context) => {\n      const p = animateFadeIn(context).toPromise();\n      context.transitionUntil(p);\n      return p;\n    }),\n    share(),\n  );\n\n  const flip$ = setupFLIP(start$, ready$, merge(fadeIn$, error$), {\n    animationMain,\n    settings: settings,\n  }).pipe(share());\n\n  start$\n    .pipe(\n      switchMap((context) => {\n        const promise = zip(timer(duration), fadeOut$, flip$).toPromise();\n        context.transitionUntil(promise);\n        return promise;\n      }),\n    )\n    .subscribe();\n\n  // FIXME: Keeping permanent subscription? turn into hot observable?\n  fadeOut$.subscribe();\n  flip$.subscribe();\n\n  const sidebarBg = document.querySelector('.sidebar-bg');\n  if (sidebarBg) {\n    const crossFader = new CrossFader(CROSS_FADE_DURATION);\n    after$\n      .pipe(\n        switchMap(({ document }) =>\n          zip(crossFader.fetchImage(document), fadeIn$).pipe(\n            map(([x]) => x),\n            takeUntil(start$),\n          ),\n        ),\n        startWith([sidebarBg]),\n        pairwise(),\n        mergeMap(([prev, curr]) => crossFader.fade(prev, curr)),\n      )\n      .subscribe();\n  }\n\n  error$\n    .pipe(\n      switchMap(({ url }) => {\n        if (loadingEl) loadingEl.style.display = 'none';\n\n        const main = document.getElementById('_main');\n        if (main) main.style.pointerEvents = '';\n        empty.call(animationMain?.querySelector('.page'));\n        empty.call(main);\n\n        setupErrorPage(main, url);\n\n        return animate(main, FADE_IN, { ...settings, fill: 'forwards' });\n      }),\n    )\n    .subscribe();\n\n  import(/* webpackMode: \"eager\" */ '@hydecorp/push-state');\n\n  window._pushState = pushStateEl;\n})();\n"],"sourceRoot":""}