{"version":3,"sources":["webpack:///./node_modules/@webcomponents/shadycss/entrypoints/scoping-shim.js","webpack:///./node_modules/@webcomponents/shadycss/src/apply-shim-utils.js","webpack:///./node_modules/@webcomponents/shadycss/src/common-regex.js","webpack:///./node_modules/@webcomponents/shadycss/src/common-utils.js","webpack:///./node_modules/@webcomponents/shadycss/src/css-parse.js","webpack:///./node_modules/@webcomponents/shadycss/src/custom-style-interface.js","webpack:///./node_modules/@webcomponents/shadycss/src/document-wait.js","webpack:///./node_modules/@webcomponents/shadycss/src/document-watcher.js","webpack:///./node_modules/@webcomponents/shadycss/src/scoping-shim.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-cache.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-info.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-placeholder.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-properties.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-settings.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-transformer.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-util.js","webpack:///./node_modules/@webcomponents/shadycss/src/template-map.js","webpack:///./node_modules/@webcomponents/shadycss/src/unscoped-style-handler.js","webpack:///src/shady-data.js","webpack:/// [synthetic:es6/util/arrayiterator] ","webpack:/// [synthetic:es6/util/makeiterator] ","webpack:/// [synthetic:es6/util/arrayfromiterable] ","webpack:/// [synthetic:es6/util/arrayfromiterator] ","webpack:/// [synthetic:util/global] ","webpack:///src/utils.js","webpack:///src/patch-native.js","webpack:///src/flush.js","webpack:///src/observe-changes.js","webpack:///src/innerHTML.js","webpack:///src/patch-instances.js","webpack:///src/patch-events.js","webpack:///src/array-splice.js","webpack:///src/patches/EventTarget.js","webpack:///src/style-scoping.js","webpack:///src/patches/Node.js","webpack:///src/attach-shadow.js","webpack:///src/patches/Slotable.js","webpack:///src/selector-parser.js","webpack:///src/patches/ParentNode.js","webpack:///src/patches/ChildNode.js","webpack:///src/patches/Element.js","webpack:///src/patches/ElementOrShadowRoot.js","webpack:///src/patches/HTMLElement.js","webpack:///src/patches/Slot.js","webpack:///src/patches/DocumentOrFragment.js","webpack:///src/patches/DocumentOrShadowRoot.js","webpack:///src/patches/Document.js","webpack:///src/patches/Window.js","webpack:///src/patch-prototypes.js","webpack:///src/link-nodes.js","webpack:///src/patches/ShadowRoot.js","webpack:///src/patch-shadyRoot.js","webpack:///src/wrapper.js","webpack:///src/shadydom.js","webpack:///(webpack)/buildin/global.js"],"names":["scopingShim","ScopingShim","ApplyShim","CustomStyleInterface","window","ShadyCSS","prepareTemplate","template","elementName","elementExtends","flushCustomStyles","prepareTemplateDom","prepareTemplateStyles","styleSubtree","element","properties","styleElement","styleDocument","getComputedStyleValue","property","nativeCss","nativeCssVariables","nativeShadow","cssBuild","disableRuntime","CURRENT_VERSION","NEXT_VERSION","VALIDATING_VERSION","promise","Promise","resolve","invalidate","templateMap","invalidateTemplate","isValid","templateIsValid","isValidating","templateIsValidating","startValidating","startValidatingTemplate","_validating","then","elementsAreInvalid","VAR_ASSIGN","MIXIN_MATCH","VAR_CONSUMED","ANIMATION_MATCH","MEDIA_MATCH","IS_VAR","BRACKETED","HOST_PREFIX","HOST_SUFFIX","updateNativeProperties","p","style","removeProperty","setProperty","value","getComputedStyle","getPropertyValue","trim","detectMixin","cssText","has","test","lastIndex","StyleNode","constructor","parse","text","clean","parseCss","lex","replace","RX","comments","port","root","length","n","i","l","OPEN_BRACE","previous","push","CLOSE_BRACE","node","t","substring","ss","_expandUnicodeEscapes","multipleSpaces","lastIndexOf","s","indexOf","AT_START","MEDIA_START","types","MEDIA_RULE","match","keyframesRule","KEYFRAMES_RULE","split","pop","VAR_START","MIXIN_RULE","STYLE_RULE","r$","r","code","arguments","repeat","stringify","preserveProperties","undefined","_hasMixinRules","removeCustomProps","rules","Boolean","removeCustomPropAssignment","removeCustomPropApply","customProp","mixinProp","mixinApply","varApply","CustomStyleProvider","SEEN_MARKER","CACHED_STYLE","transformFn","validateFn","documentWait","enqueueDocumentValidation","addCustomStyle","getStyleForCustomStyle","customStyle","processStyles","cs","styleToTransform","prototype","Object","defineProperties","get","set","fn","needsEnqueue","CustomStyleInterfaceInterface","readyPromise","whenReady","resolveFn","callback","requestAnimationFrame","document","readyState","addEventListener","flush","getClasses","classList","getAttribute","scopeRegExp","RegExp","concat","StyleTransformer","SCOPE_NAME","getCurrentScope","getOwnerScope","ownerRoot","wrap","getRootNode","ownerDocument","host","getIsExtends","is","ensureCorrectScope","currentScope","domRemoveScope","ShadowRoot","ownerScope","domReplaceScope","ensureCorrectSubtreeScoping","unscopedNodes","call","j","unscopedNode","scopeForPreviouslyUnscopedNode","isElementWithBuiltCss","el","localName","elementHasBuiltCss","handler","mxns","x","mxn","target","documentElement","head","addedNodes","nodeType","Node","ELEMENT_NODE","newScope","observer","MutationObserver","start","observe","childList","subtree","nativeCustomElements","delayedStart","body","listener","removeEventListener","takeRecords","adoptedCssTextMap","styleCache","StyleCache","_scopeCounter","_documentOwner","ast","_documentOwnerStyleInfo","StyleInfo","_elementsHaveApplied","_applyShim","_customStyleInterface","watcherFlush","_generateScopeSelector","name","id","getStyleAst","StyleUtil","styleAstToString","_gatherStyles","content","typeExtension","_prepared","ensureStylePlaceholder","extends","optimalBuild","info","_ensure","hasMixins","ownPropertyNames","StyleProperties","decorateStyles","placeholder","getStylePlaceholder","_generateStaticStyle","_style","_ownPropertyNames","prepareAdoptedCssText","cssTextArray","join","_domPrepared","domAddScope","shadowroot","elementStyles","_prepareHost","ownStylePropertyNames","styleInfo","_ensureApplyShim","ApplyShimUtils","_ensureCustomStyleInterface","transformCustomStyleForDocument","needsApplyShimUpdate","customStyles","_reorderCustomStylesRules","_updateProperties","_applyCustomStyles","_revalidateCustomStyleApplyShim","styles","map","c","filter","sort","a","b","position","compareDocumentPosition","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_PRECEDING","styleRules","overrideProps","_mixOverrideStyleProps","styleElementNativeVariables","_isRootOwner","styleElementShimVariables","overrideStyleProperties","assign","_applyStyleProperties","textContent","shadowRoot","querySelector","_styleOwnerForNode","cacheEntry","fetch","styleProperties","cachedScopeSelector","scopeSelector","cachedStyle","oldScopeSelector","applyElementStyle","applyElementScopeSelector","store","owner","ownerStyleInfo","ownerProperties","props","create","hostAndRootProps","hostAndRootPropertiesForScope","propertyData","propertyDataFromStyles","propertiesMatchingHost","hostProps","rootProps","_mixinOverrideStyles","reify","overrides","v","wrappedHost","isRootOwner","descendantRoot","descendantHosts","Array","from","querySelectorAll","_revalidateApplyShim","applyCustomStyle","rule","normalizeRootSelector","documentRule","setElementClass","classString","classes","definitelyString","String","scopeName","classAttr","k$","XSCOPE_NAME","_styleInfoForNode","scopeNode","scope","unscopeNode","scopeForNode","currentScopeForNode","typeMax","cache","_validate","idx","pn","tagname","list","shift","entry","infoKey","_getStyleRules","placeholderMap","applyStylePlaceHolder","ce","origDefine","wrappedDefine","clazz","options","matchesSelector","selector","method","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","rootSelector","checkRoot","hostScope","IS_IE","navigator","userAgent","self","keyframes","ruleIndex","decorateRule","index","collectPropertiesInCssText","propertyInfo","onKeyframesRule","_keyframes","names","hasProperties","collectProperties","collectCssText","m","rx","any","exec","collectConsumingCssText","getOwnPropertyNames","valueForProperty","valueForProperties","prefix","fallback","suffix","propertyValue","parts","colon","pp","slice","applyProperties","output","applyKeyframeTransforms","keyframeTransforms","input","hasAnimations","transform","keyframeNamesToTransform","keyframe","o","selectorToMatch","transformedSelector","addToBitMask","key","whenHostOrRootRule","_calcHostScope","parsedSelector","isRoot","isHost","_transformRuleCss","_transformComplexSelector","_calcElementScope","_element","transformStyles","hostSelector","rxHostSelector","hostRx","_elementKeyframeTransforms","_scopeSelector","keyframesRules","_scopeKeyframes","_keyframesRuleTransformer","keyframesNameRx","transformedKeyframesName","scopeId","old","parentNode","removeChild","css","bits","parseInt","nativeCssVariables_","calcCssVariables","settings","shimcssproperties","CSS","supports","dom","shouldRemoveScope","_transformDom","startNode","transformer","c$","_content","childNodes","children","remove","add","CLASS","newValue","oldScope","ext","isScoped","CSS_CLASS_PREFIX","_transformRule","p$","part","COMPLEX_SELECTOR_SEP","_twiddleNthPlus","NTH","type","inside","_preserveMatchesPseudo","MATCHES","end","Error","MATCHES_REPLACEMENT","_replaceMatchesPseudo","reduce","acc","cur","stop","isNth","inner","isMatches","SLOTTED_START","HOST","SIMPLE_SELECTOR_SEP","_transformCompoundSelector","combinator","DIR_PAREN","before","dir","after","slottedIndex","SLOTTED","_transformHostSelector","_transformSimpleSelector","slotted","SLOTTED_PAREN","paren","attributes","PSEUDO_PREFIX","HOST_PAREN","SIMPLE_SELECTOR_PREFIX","typeSelector","SELECTOR_NO_MATCH","_transformDocumentSelector","ROOT","SCOPE_DOC_SELECTOR","toCssText","forEachRule","rulesForStyle","isKeyframesSelector","styleRuleCallback","keyframesRuleCallback","onlyActiveRules","skipRules","matchMedia","applyCss","moniker","contextNode","createScopeStyle","applyStyle","createElement","setAttribute","lastHeadApplyNode","placeHolder","createComment","insertBefore","firstChild","nextSibling","isTargetedBuild","buildType","findMatchingParen","level","processVariableAndFallback","str","comma","setElementClassRaw","gatherStyleText","styleTextParts","isUnscopedStyle","processUnscopedStyle","splitSelectorList","CSS_BUILD_ATTR","getCssBuild","__cssBuild","attrValue","buildComment","getBuildComment","removeBuildComment","Comment","commentParts","isOptimalCssBuild","styleTextSet","Set","scopingAttribute","newStyle","appendChild","hasAttribute","aa","done","Symbol","iterator","next","q","ba","globalThis","global","Math","ca","da","ShadyData","toJSON","ensureShadyDataForNode","__shady","u","shadyDataForNode","ShadyDOM","Element","attachShadow","ea","getOwnPropertyDescriptor","configurable","N","force","noPatch","C","preferPerformance","O","fa","ha","querySelectorImplementation","ga","V","ia","Document","msElementsFromPoint","w","ja","ka","y","la","ma","createTextNode","na","oa","characterData","pa","qa","contains","__shady_native_contains","ra","__shady_parentNode","z","d","isNaN","item","e","namedItem","f","g","sa","__shady_native_firstChild","__shady_native_nextSibling","ta","__shady_firstChild","__shady_nextSibling","ua","defineProperty","A","va","B","forEach","wa","xa","D","createDocumentFragment","ya","isArray","apply","za","E","Aa","Ba","enqueue","F","Ca","AsyncObserver","removedNodes","H","Da","Ea","Z","Fa","delete","size","Ga","filterMutations","Ha","Ia","Ja","escapeReplace","Ka","makeSet","La","Ma","Na","getInnerHTML","h","k","S","TEXT_NODE","data","COMMENT_NODE","console","error","G","Oa","__shady_native_querySelector","__shady_native_querySelectorAll","Pa","Qa","I","J","createTreeWalker","NodeFilter","SHOW_ALL","K","SHOW_ELEMENT","Ra","implementation","createHTMLDocument","Sa","__shady_native_removeChild","Ta","Ua","Va","EventTarget","__shady_native_addEventListener","Window","XMLHttpRequest","currentNode","lastChild","previousSibling","parentElement","DOCUMENT_FRAGMENT_NODE","SHOW_TEXT","nextNode","nodeValue","__shady_native_insertBefore","HTMLElement","firstElementChild","lastElementChild","childElementCount","previousElementSibling","nextElementSibling","innerHTML","namespaceURI","createElementNS","className","HTMLTemplateElement","DocumentFragment","Wa","__shady_childNodes","__shady_lastChild","__shady_childElementCount","__shady_children","__shady_firstElementChild","__shady_lastElementChild","__shady_shadowRoot","Xa","__shady_textContent","__shady_innerHTML","Ya","__shady_parentElement","__shady_previousSibling","__shady_nextElementSibling","__shady_previousElementSibling","__shady_className","Za","enumerable","$a","ab","X","bb","W","customElements","polyfillWrapFlushCallback","L","Date","now","cb","Event","db","capture","eb","once","U","T","fb","blur","focus","focusin","focusout","click","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","wheel","beforeinput","keydown","keyup","compositionstart","compositionupdate","compositionend","touchstart","touchend","touchmove","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","DOMActivate","DOMFocusIn","DOMFocusOut","keypress","gb","DOMAttrModified","DOMAttributeNameChanged","DOMCharacterDataModified","DOMElementNameChanged","DOMNodeInserted","DOMNodeInsertedIntoDocument","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMSubtreeModified","hb","getRootNodeWithFallback","__shady_getRootNode","M","pathComposer","__shady_assignedSlot","ib","__composedPath","jb","retarget","kb","composed","__composed","isTrusted","composedPath","__target","currentTarget","__previousCurrentTarget","relatedTarget","__relatedTarget","__relatedTargetComposedPath","stopPropagation","stopImmediatePropagation","__immediatePropagationStopped","lb","AT_TARGET","__shady_native_eventPhase","mb","mixinComposedFlag","__proto__","nb","ob","hasRetargeted","pb","fireHandlers","__handlers","qb","hasOwnProperty","rb","shadyDispatchEvent","bubbles","CAPTURING_PHASE","BUBBLING_PHASE","eventPhase","sb","findListener","tb","dispatchEvent","ub","__shady_native_dispatchEvent","vb","handleEvent","__shady_removeEventListener","bubble","wb","__shady_native_removeEventListener","splice","xb","activateFocusEventOverrides","yb","patchEvent","getPrototypeOf","__shady_sourceProto","__shady_patchedProto","zb","Ab","CustomEvent","Bb","MouseEvent","Cb","patchClick","cancelable","__shady_dispatchEvent","Db","Eb","Fb","__shady_addEventListener","newSplice","Gb","calcSplices","min","Hb","reverse","equals","Ib","Jb","getScopingShim","Kb","scopeClassAttribute","Lb","removeShadyScoping","Mb","currentScopeIsCorrect","Nb","Ob","treeVisitor","Pb","Qb","Rb","Sb","Tb","clearNode","__shady_removeChild","Ub","removeOwnerShadyRoot","Vb","firstComposedNode","Wb","scheduleObserver","ac","__shady_native_parentNode","__shady_native_lastChild","__shady_native_previousSibling","__shady_native_childNodes","__shady_native_parentElement","isConnected","__shady_native_textContent","__shady_insertBefore","P","__noInsertionPoint","Xb","Q","Yb","__shady_native_appendChild","adoptNode","Zb","$b","replaceChild","cloneNode","__shady_native_cloneNode","ATTRIBUTE_NODE","__shady_cloneNode","__shady_appendChild","R","assignedSlot","bc","cc","Map","dc","ec","fc","query","gc","queryChildNodes","hc","__shady_native_firstElementChild","__shady_native_lastElementChild","__shady_native_children","append","prepend","replaceChildren","ic","some","jc","kc","lc","replaceWith","mc","nc","distributeAttributeChange","oc","Y","pc","qc","rc","__shady_native_previousElementSibling","__shady_native_nextElementSibling","slot","__shady_setAttribute","__shady_native_setAttribute","removeAttribute","__shady_native_removeAttribute","toggleAttribute","__shady_native_toggleAttribute","wc","shadyUpgradeFragment","sc","tc","uc","vc","__CE_shadowRoot","xc","yc","__shady_native_innerHTML","zc","activeElement","__shady_blur","__shady_native_blur","Ac","assignedNodes","flatten","Bc","getElementById","Cc","getElInRoot","Dc","getAncestorRoots","Ec","Fc","__shady_native_activeElement","elementsFromPoint","useNativeDocumentEFP","elementFromPoint","__shady_native_elementFromPoint","__shady_elementsFromPoint","Gc","Hc","importNode","__shady_native_importNode","__shady_importNode","Ic","bind","Text","CDATASection","ProcessingInstruction","HTMLSlotElement","CharacterData","Jc","applyPatchList","Kc","__shady_protoIsPatched","Lc","Mc","Nc","Oc","patchNode","setPrototypeOf","Pc","linkNode","Qc","Rc","deferConnectionCallbacks","Sc","Tc","ancestorList","unshift","ShadyRoot","TypeError","mode","_renderSelf","Uc","Vc","Wc","__shady_slot","nodeName","define","Xc","rootRendered","clear","__shadydom_connectedCallback","__shadydom_disconnectedCallback","Yc","connectedCallback","disconnectedCallback","Zc","$c","CustomElementRegistry","Wrapper","__shady_replaceChild","__shady_contains","__shady_native_getAttribute","__shady_removeAttribute","__shady_toggleAttribute","__shady_attachShadow","__shady_native_focus","DOCUMENT_NODE","__shady_getElementById","__shady_elementFromPoint","__shady_querySelector","__shady_querySelectorAll","__shady_assignedNodes","__shady_append","__shady_prepend","__shady_after","__shady_before","__shady_remove","__shady_replaceWith","__shady_activeElement","_activeElement","__shady_isConnected","ad","bd","WeakMap","cd","dd","inUse","patch","isShadyRoot","flushInitial","observeChildren","unobserveChildren","handlesDynamicScoping","wrapIfNeeded","patchOnDemand","nativeMethods","nativeTree","patchElementProto","Function","module","exports"],"mappings":"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","file":"vendors~shadydom-hydejack-9.2.1.js","sourcesContent":["/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport ScopingShim from '../src/scoping-shim.js';\n// prettier-ignore\nimport {nativeCssVariables, nativeShadow, cssBuild, disableRuntime} from '../src/style-settings.js';\n\n/** @const {ScopingShim} */\nconst scopingShim = new ScopingShim();\n\nlet ApplyShim, CustomStyleInterface;\n\nif (window['ShadyCSS']) {\n  ApplyShim = window['ShadyCSS']['ApplyShim'];\n  CustomStyleInterface = window['ShadyCSS']['CustomStyleInterface'];\n}\n\nwindow.ShadyCSS = {\n  ScopingShim: scopingShim,\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplate(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplate(template, elementName, elementExtends);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    scopingShim.prepareTemplateDom(template, elementName);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplateStyles(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplateStyles(template, elementName, elementExtends);\n  },\n  /**\n   * @param {!HTMLElement} element\n   * @param {Object=} properties\n   */\n  styleSubtree(element, properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleSubtree(element, properties);\n  },\n\n  /**\n   * @param {!HTMLElement} element\n   */\n  styleElement(element) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleElement(element);\n  },\n\n  /**\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleDocument(properties);\n  },\n\n  flushCustomStyles() {\n    scopingShim.flushCustomStyles();\n  },\n\n  /**\n   * @param {Element} element\n   * @param {string} property\n   * @return {string}\n   */\n  getComputedStyleValue(element, property) {\n    return scopingShim.getComputedStyleValue(element, property);\n  },\n\n  nativeCss: nativeCssVariables,\n\n  nativeShadow: nativeShadow,\n\n  cssBuild: cssBuild,\n\n  disableRuntime: disableRuntime,\n};\n\nif (ApplyShim) {\n  window.ShadyCSS.ApplyShim = ApplyShim;\n}\n\nif (CustomStyleInterface) {\n  window.ShadyCSS.CustomStyleInterface = CustomStyleInterface;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\nimport templateMap from './template-map.js';\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/*\n * Utilities for handling invalidating apply-shim mixins for a given template.\n *\n * The invalidation strategy involves keeping track of the \"current\" version of a template's mixins, and updating that count when a mixin is invalidated.\n * The template\n */\n\n/** @const {string} */\nconst CURRENT_VERSION = '_applyShimCurrentVersion';\n\n/** @const {string} */\nconst NEXT_VERSION = '_applyShimNextVersion';\n\n/** @const {string} */\nconst VALIDATING_VERSION = '_applyShimValidatingVersion';\n\n/**\n * @const {Promise<void>}\n */\nconst promise = Promise.resolve();\n\n/**\n * @param {string} elementName\n */\nexport function invalidate(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    invalidateTemplate(template);\n  }\n}\n\n/**\n * This function can be called multiple times to mark a template invalid\n * and signal that the style inside must be regenerated.\n *\n * Use `startValidatingTemplate` to begin an asynchronous validation cycle.\n * During that cycle, call `templateIsValidating` to see if the template must\n * be revalidated\n * @param {HTMLTemplateElement} template\n */\nexport function invalidateTemplate(template) {\n  // default the current version to 0\n  template[CURRENT_VERSION] = template[CURRENT_VERSION] || 0;\n  // ensure the \"validating for\" flag exists\n  template[VALIDATING_VERSION] = template[VALIDATING_VERSION] || 0;\n  // increment the next version\n  template[NEXT_VERSION] = (template[NEXT_VERSION] || 0) + 1;\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValid(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValid(template);\n  }\n  return true;\n}\n\n/**\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValid(template) {\n  return template[CURRENT_VERSION] === template[NEXT_VERSION];\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValidating(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValidating(template);\n  }\n  return false;\n}\n\n/**\n * Returns true if the template is currently invalid and `startValidating` has been called since the last invalidation.\n * If false, the template must be validated.\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValidating(template) {\n  return (\n    !templateIsValid(template) &&\n    template[VALIDATING_VERSION] === template[NEXT_VERSION]\n  );\n}\n\n/**\n * the template is marked as `validating` for one microtask so that all instances\n * found in the tree crawl of `applyStyle` will update themselves,\n * but the template will only be updated once.\n * @param {string} elementName\n */\nexport function startValidating(elementName) {\n  let template = templateMap[elementName];\n  startValidatingTemplate(template);\n}\n\n/**\n * Begin an asynchronous invalidation cycle.\n * This should be called after every validation of a template\n *\n * After one microtask, the template will be marked as valid until the next call to `invalidateTemplate`\n * @param {HTMLTemplateElement} template\n */\nexport function startValidatingTemplate(template) {\n  // remember that the current \"next version\" is the reason for this validation cycle\n  template[VALIDATING_VERSION] = template[NEXT_VERSION];\n  // however, there only needs to be one async task to clear the counters\n  if (!template._validating) {\n    template._validating = true;\n    promise.then(function () {\n      // sync the current version to let future invalidations cause a refresh cycle\n      template[CURRENT_VERSION] = template[NEXT_VERSION];\n      template._validating = false;\n    });\n  }\n}\n\n/**\n * @return {boolean}\n */\nexport function elementsAreInvalid() {\n  for (let elementName in templateMap) {\n    let template = templateMap[elementName];\n    if (!templateIsValid(template)) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport const VAR_ASSIGN = /(?:^|[;\\s{]\\s*)(--[\\w-]*?)\\s*:\\s*(?:((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^)]*?\\)|[^};{])+)|\\{([^}]*)\\}(?:(?=[;\\s}])|$))/gi;\nexport const MIXIN_MATCH = /(?:^|\\W+)@apply\\s*\\(?([^);\\n]*)\\)?/gi;\nexport const VAR_CONSUMED = /(--[\\w-]+)\\s*([:,;)]|$)/gi;\nexport const ANIMATION_MATCH = /(animation\\s*:)|(animation-name\\s*:)/;\nexport const MEDIA_MATCH = /@media\\s(.*)/;\nexport const IS_VAR = /^--/;\nexport const BRACKETED = /\\{[^}]*\\}/g;\nexport const HOST_PREFIX = '(?:^|[^.#[:])';\nexport const HOST_SUFFIX = '($|[.:[\\\\s>+~])';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {MIXIN_MATCH, VAR_ASSIGN} from './common-regex.js';\n\n/**\n * @param {Element} element\n * @param {Object=} properties\n */\nexport function updateNativeProperties(element, properties) {\n  // remove previous properties\n  for (let p in properties) {\n    // NOTE: for bc with shim, don't apply null values.\n    if (p === null) {\n      element.style.removeProperty(p);\n    } else {\n      element.style.setProperty(p, properties[p]);\n    }\n  }\n}\n\n/**\n * @param {Element} element\n * @param {string} property\n * @return {string}\n */\nexport function getComputedStyleValue(element, property) {\n  /**\n   * @const {string}\n   */\n  const value = window.getComputedStyle(element).getPropertyValue(property);\n  if (!value) {\n    return '';\n  } else {\n    return value.trim();\n  }\n}\n\n/**\n * return true if `cssText` contains a mixin definition or consumption\n * @param {string} cssText\n * @return {boolean}\n */\nexport function detectMixin(cssText) {\n  const has = MIXIN_MATCH.test(cssText) || VAR_ASSIGN.test(cssText);\n  // reset state of the regexes\n  MIXIN_MATCH.lastIndex = 0;\n  VAR_ASSIGN.lastIndex = 0;\n  return has;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/*\nExtremely simple css parser. Intended to be not more than what we need\nand definitely not necessarily correct =).\n*/\n\n'use strict';\n\n/** @unrestricted */\nclass StyleNode {\n  constructor() {\n    /** @type {number} */\n    this['start'] = 0;\n    /** @type {number} */\n    this['end'] = 0;\n    /** @type {StyleNode} */\n    this['previous'] = null;\n    /** @type {StyleNode} */\n    this['parent'] = null;\n    /** @type {Array<StyleNode>} */\n    this['rules'] = null;\n    /** @type {string} */\n    this['parsedCssText'] = '';\n    /** @type {string} */\n    this['cssText'] = '';\n    /** @type {boolean} */\n    this['atRule'] = false;\n    /** @type {number} */\n    this['type'] = 0;\n    /** @type {string} */\n    this['keyframesName'] = '';\n    /** @type {string} */\n    this['selector'] = '';\n    /** @type {string} */\n    this['parsedSelector'] = '';\n  }\n}\n\nexport {StyleNode};\n\n// given a string of css, return a simple rule tree\n/**\n * @param {string} text\n * @return {StyleNode}\n */\nexport function parse(text) {\n  text = clean(text);\n  return parseCss(lex(text), text);\n}\n\n// remove stuff we don't care about that may hinder parsing\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction clean(cssText) {\n  return cssText.replace(RX.comments, '').replace(RX.port, '');\n}\n\n// super simple {...} lexer that returns a node tree\n/**\n * @param {string} text\n * @return {!StyleNode}\n */\nfunction lex(text) {\n  let root = new StyleNode();\n  root['start'] = 0;\n  root['end'] = text.length;\n  let n = root;\n  for (let i = 0, l = text.length; i < l; i++) {\n    if (text[i] === OPEN_BRACE) {\n      if (!n['rules']) {\n        n['rules'] = [];\n      }\n      let p = n;\n      let previous = p['rules'][p['rules'].length - 1] || null;\n      n = new StyleNode();\n      n['start'] = i + 1;\n      n['parent'] = p;\n      n['previous'] = previous;\n      p['rules'].push(n);\n    } else if (text[i] === CLOSE_BRACE) {\n      n['end'] = i + 1;\n      n = n['parent'] || root;\n    }\n  }\n  return root;\n}\n\n// add selectors/cssText to node tree\n/**\n * @param {StyleNode} node\n * @param {string} text\n * @return {!StyleNode}\n */\nfunction parseCss(node, text) {\n  let t = text.substring(node['start'], node['end'] - 1);\n  node['parsedCssText'] = node['cssText'] = t.trim();\n  if (node['parent']) {\n    let ss = node['previous']\n      ? node['previous']['end']\n      : node['parent']['start'];\n    t = text.substring(ss, node['start'] - 1);\n    t = _expandUnicodeEscapes(t);\n    t = t.replace(RX.multipleSpaces, ' ');\n    // TODO(sorvell): ad hoc; make selector include only after last ;\n    // helps with mixin syntax\n    t = t.substring(t.lastIndexOf(';') + 1);\n    let s = (node['parsedSelector'] = node['selector'] = t.trim());\n    node['atRule'] = s.indexOf(AT_START) === 0;\n    // note, support a subset of rule types...\n    if (node['atRule']) {\n      if (s.indexOf(MEDIA_START) === 0) {\n        node['type'] = types.MEDIA_RULE;\n      } else if (s.match(RX.keyframesRule)) {\n        node['type'] = types.KEYFRAMES_RULE;\n        node['keyframesName'] = node['selector'].split(RX.multipleSpaces).pop();\n      }\n    } else {\n      if (s.indexOf(VAR_START) === 0) {\n        node['type'] = types.MIXIN_RULE;\n      } else {\n        node['type'] = types.STYLE_RULE;\n      }\n    }\n  }\n  let r$ = node['rules'];\n  if (r$) {\n    for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n      parseCss(r, text);\n    }\n  }\n  return node;\n}\n\n/**\n * conversion of sort unicode escapes with spaces like `\\33 ` (and longer) into\n * expanded form that doesn't require trailing space `\\000033`\n * @param {string} s\n * @return {string}\n */\nfunction _expandUnicodeEscapes(s) {\n  return s.replace(/\\\\([0-9a-f]{1,6})\\s/gi, function () {\n    let code = arguments[1],\n      repeat = 6 - code.length;\n    while (repeat--) {\n      code = '0' + code;\n    }\n    return '\\\\' + code;\n  });\n}\n\n/**\n * stringify parsed css.\n * @param {StyleNode} node\n * @param {boolean=} preserveProperties\n * @param {string=} text\n * @return {string}\n */\nexport function stringify(node, preserveProperties, text = '') {\n  // calc rule cssText\n  let cssText = '';\n  if (node['cssText'] || node['rules']) {\n    let r$ = node['rules'];\n    if (r$ && !_hasMixinRules(r$)) {\n      for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n        cssText = stringify(r, preserveProperties, cssText);\n      }\n    } else {\n      cssText = preserveProperties\n        ? node['cssText']\n        : removeCustomProps(node['cssText']);\n      cssText = cssText.trim();\n      if (cssText) {\n        cssText = '  ' + cssText + '\\n';\n      }\n    }\n  }\n  // emit rule if there is cssText\n  if (cssText) {\n    if (node['selector']) {\n      text += node['selector'] + ' ' + OPEN_BRACE + '\\n';\n    }\n    text += cssText;\n    if (node['selector']) {\n      text += CLOSE_BRACE + '\\n\\n';\n    }\n  }\n  return text;\n}\n\n/**\n * @param {Array<StyleNode>} rules\n * @return {boolean}\n */\nfunction _hasMixinRules(rules) {\n  let r = rules[0];\n  return (\n    Boolean(r) &&\n    Boolean(r['selector']) &&\n    r['selector'].indexOf(VAR_START) === 0\n  );\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomProps(cssText) {\n  cssText = removeCustomPropAssignment(cssText);\n  return removeCustomPropApply(cssText);\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nexport function removeCustomPropAssignment(cssText) {\n  return cssText.replace(RX.customProp, '').replace(RX.mixinProp, '');\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomPropApply(cssText) {\n  return cssText.replace(RX.mixinApply, '').replace(RX.varApply, '');\n}\n\n/** @enum {number} */\nexport const types = {\n  STYLE_RULE: 1,\n  KEYFRAMES_RULE: 7,\n  MEDIA_RULE: 4,\n  MIXIN_RULE: 1000,\n};\n\nconst OPEN_BRACE = '{';\nconst CLOSE_BRACE = '}';\n\n// helper regexp's\nconst RX = {\n  comments: /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//gim,\n  port: /@import[^;]*;/gim,\n  customProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\\n]|$)/gim,\n  mixinProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\\n]|$)?/gim,\n  mixinApply: /@apply\\s*\\(?[^);]*\\)?\\s*(?:[;\\n]|$)?/gim,\n  varApply: /[^;:]*?:[^;]*?var\\([^;]*\\)(?:[;\\n]|$)?/gim,\n  keyframesRule: /^@[^\\s]*keyframes/,\n  multipleSpaces: /\\s+/g,\n};\n\nconst VAR_START = '--';\nconst MEDIA_START = '@media';\nconst AT_START = '@';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport documentWait from './document-wait.js';\n\n/**\n * @typedef {HTMLStyleElement | {getStyle: function():HTMLStyleElement}}\n */\nexport let CustomStyleProvider;\n\nconst SEEN_MARKER = '__seenByShadyCSS';\nconst CACHED_STYLE = '__shadyCSSCachedStyle';\n\n/** @type {?function(!HTMLStyleElement)} */\nlet transformFn = null;\n\n/** @type {?function()} */\nlet validateFn = null;\n\n/**\nThis interface is provided to add document-level <style> elements to ShadyCSS for processing.\nThese styles must be processed by ShadyCSS to simulate ShadowRoot upper-bound encapsulation from outside styles\nIn addition, these styles may also need to be processed for @apply rules and CSS Custom Properties\n\nTo add document-level styles to ShadyCSS, one can call `ShadyCSS.addDocumentStyle(styleElement)` or `ShadyCSS.addDocumentStyle({getStyle: () => styleElement})`\n\nIn addition, if the process used to discover document-level styles can be synchronously flushed, one should set `ShadyCSS.documentStyleFlush`.\nThis function will be called when calculating styles.\n\nAn example usage of the document-level styling api can be found in `examples/document-style-lib.js`\n\n@unrestricted\n*/\nexport default class CustomStyleInterface {\n  constructor() {\n    /** @type {!Array<!CustomStyleProvider>} */\n    this['customStyles'] = [];\n    this['enqueued'] = false;\n    // NOTE(dfreedm): use quotes here to prevent closure inlining to `function(){}`;\n    documentWait(() => {\n      if (window['ShadyCSS']['flushCustomStyles']) {\n        window['ShadyCSS']['flushCustomStyles']();\n      }\n    });\n  }\n  /**\n   * Queue a validation for new custom styles to batch style recalculations\n   */\n  enqueueDocumentValidation() {\n    if (this['enqueued'] || !validateFn) {\n      return;\n    }\n    this['enqueued'] = true;\n    documentWait(validateFn);\n  }\n  /**\n   * @param {!HTMLStyleElement} style\n   */\n  addCustomStyle(style) {\n    if (!style[SEEN_MARKER]) {\n      style[SEEN_MARKER] = true;\n      this['customStyles'].push(style);\n      this.enqueueDocumentValidation();\n    }\n  }\n  /**\n   * @param {!CustomStyleProvider} customStyle\n   * @return {HTMLStyleElement}\n   */\n  getStyleForCustomStyle(customStyle) {\n    if (customStyle[CACHED_STYLE]) {\n      return customStyle[CACHED_STYLE];\n    }\n    let style;\n    if (customStyle['getStyle']) {\n      style = customStyle['getStyle']();\n    } else {\n      style = customStyle;\n    }\n    return style;\n  }\n  /**\n   * @return {!Array<!CustomStyleProvider>}\n   */\n  processStyles() {\n    const cs = this['customStyles'];\n    for (let i = 0; i < cs.length; i++) {\n      const customStyle = cs[i];\n      if (customStyle[CACHED_STYLE]) {\n        continue;\n      }\n      const style = this.getStyleForCustomStyle(customStyle);\n      if (style) {\n        // HTMLImports polyfill may have cloned the style into the main document,\n        // which is referenced with __appliedElement.\n        const styleToTransform = /** @type {!HTMLStyleElement} */ (style[\n          '__appliedElement'\n        ] || style);\n        if (transformFn) {\n          transformFn(styleToTransform);\n        }\n        customStyle[CACHED_STYLE] = styleToTransform;\n      }\n    }\n    return cs;\n  }\n}\n\n/* eslint-disable no-self-assign */\nCustomStyleInterface.prototype['addCustomStyle'] =\n  CustomStyleInterface.prototype.addCustomStyle;\nCustomStyleInterface.prototype['getStyleForCustomStyle'] =\n  CustomStyleInterface.prototype.getStyleForCustomStyle;\nCustomStyleInterface.prototype['processStyles'] =\n  CustomStyleInterface.prototype.processStyles;\n/* eslint-enable no-self-assign */\n\nObject.defineProperties(CustomStyleInterface.prototype, {\n  'transformCallback': {\n    /** @return {?function(!HTMLStyleElement)} */\n    get() {\n      return transformFn;\n    },\n    /** @param {?function(!HTMLStyleElement)} fn */\n    set(fn) {\n      transformFn = fn;\n    },\n  },\n  'validateCallback': {\n    /** @return {?function()} */\n    get() {\n      return validateFn;\n    },\n    /**\n     * @param {?function()} fn\n     * @this {CustomStyleInterface}\n     */\n    set(fn) {\n      let needsEnqueue = false;\n      if (!validateFn) {\n        needsEnqueue = true;\n      }\n      validateFn = fn;\n      if (needsEnqueue) {\n        this.enqueueDocumentValidation();\n      }\n    },\n  },\n});\n\n/** @typedef {{\n * customStyles: !Array<!CustomStyleProvider>,\n * addCustomStyle: function(!CustomStyleProvider),\n * getStyleForCustomStyle: function(!CustomStyleProvider): HTMLStyleElement,\n * findStyles: function(),\n * transformCallback: ?function(!HTMLStyleElement),\n * validateCallback: ?function()\n * }}\n */\nexport const CustomStyleInterfaceInterface = {};\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {Promise<void>} */\nlet readyPromise = null;\n\n/** @type {?function(?function())} */\nlet whenReady =\n  (window['HTMLImports'] && window['HTMLImports']['whenReady']) || null;\n\n/** @type {function()} */\nlet resolveFn;\n\n/**\n * @param {?function()} callback\n */\nexport default function documentWait(callback) {\n  requestAnimationFrame(function () {\n    if (whenReady) {\n      whenReady(callback);\n    } else {\n      if (!readyPromise) {\n        readyPromise = new Promise((resolve) => {\n          resolveFn = resolve;\n        });\n        if (document.readyState === 'complete') {\n          resolveFn();\n        } else {\n          document.addEventListener('readystatechange', () => {\n            if (document.readyState === 'complete') {\n              resolveFn();\n            }\n          });\n        }\n      }\n      readyPromise.then(function () {\n        callback && callback();\n      });\n    }\n  });\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport {getIsExtends, elementHasBuiltCss, wrap} from './style-util.js';\n\nexport let flush = function () {};\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nfunction getClasses(element) {\n  if (element.classList && element.classList.value) {\n    return element.classList.value;\n  } else {\n    // NOTE: className is patched to remove scoping classes in ShadyDOM\n    // use getAttribute('class') instead, which is unpatched\n    return element.getAttribute('class') || '';\n  }\n}\n\nconst scopeRegExp = new RegExp(`${StyleTransformer.SCOPE_NAME}\\\\s*([^\\\\s]*)`);\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nexport function getCurrentScope(element) {\n  const match = getClasses(element).match(scopeRegExp);\n  if (match) {\n    return match[1];\n  } else {\n    return '';\n  }\n}\n\n/**\n * @param {!Node} node\n */\nexport function getOwnerScope(node) {\n  const ownerRoot = wrap(node).getRootNode();\n  if (ownerRoot === node || ownerRoot === node.ownerDocument) {\n    return '';\n  }\n  const host = /** @type {!ShadowRoot} */ (ownerRoot).host;\n  if (!host) {\n    // this may actually be a document fragment\n    return '';\n  }\n  return getIsExtends(host).is;\n}\n\n/**\n * @param {!Element} element\n */\nexport function ensureCorrectScope(element) {\n  const currentScope = getCurrentScope(element);\n  const ownerRoot = wrap(element).getRootNode();\n  if (ownerRoot === element) {\n    return;\n  }\n  if (currentScope && ownerRoot === element.ownerDocument) {\n    // node was scoped, but now is in document\n    StyleTransformer.domRemoveScope(element, currentScope);\n  } else if (ownerRoot instanceof ShadowRoot) {\n    const ownerScope = getOwnerScope(element);\n    if (ownerScope !== currentScope) {\n      // node was scoped, but not by its current owner\n      StyleTransformer.domReplaceScope(element, currentScope, ownerScope);\n    }\n  }\n}\n\n/**\n * @param {!HTMLElement|!HTMLDocument} element\n */\nexport function ensureCorrectSubtreeScoping(element) {\n  // find unscoped subtree nodes\n  const unscopedNodes = window['ShadyDOM']['nativeMethods'][\n    'querySelectorAll'\n  ].call(element, `:not(.${StyleTransformer.SCOPE_NAME})`);\n\n  for (let j = 0; j < unscopedNodes.length; j++) {\n    // it's possible, during large batch inserts, that nodes that aren't\n    // scoped within the current scope were added.\n    // To make sure that any unscoped nodes that were inserted in the current batch are correctly styled,\n    // query all unscoped nodes and force their style-scope to be applied.\n    // This could happen if a sub-element appended an unscoped node in its shadowroot and this function\n    // runs on a parent element of the host of that unscoped node:\n    // parent-element -> element -> unscoped node\n    // Here unscoped node should have the style-scope element, not parent-element.\n    const unscopedNode = unscopedNodes[j];\n    const scopeForPreviouslyUnscopedNode = getOwnerScope(unscopedNode);\n    if (scopeForPreviouslyUnscopedNode) {\n      StyleTransformer.element(unscopedNode, scopeForPreviouslyUnscopedNode);\n    }\n  }\n}\n\n/**\n * @param {HTMLElement} el\n * @return {boolean}\n */\nfunction isElementWithBuiltCss(el) {\n  if (el.localName === 'style' || el.localName === 'template') {\n    return elementHasBuiltCss(el);\n  }\n  return false;\n}\n\n/**\n * @param {Array<MutationRecord|null>|null} mxns\n */\nfunction handler(mxns) {\n  for (let x = 0; x < mxns.length; x++) {\n    let mxn = mxns[x];\n    if (\n      mxn.target === document.documentElement ||\n      mxn.target === document.head\n    ) {\n      continue;\n    }\n    for (let i = 0; i < mxn.addedNodes.length; i++) {\n      let n = mxn.addedNodes[i];\n      if (n.nodeType !== Node.ELEMENT_NODE) {\n        continue;\n      }\n      n = /** @type {HTMLElement} */ (n); // eslint-disable-line no-self-assign\n      let root = n.getRootNode();\n      let currentScope = getCurrentScope(n);\n      // node was scoped, but now is in document\n      // If this element has built css, we must not remove scoping as this node\n      // will be used as a template or style without re - applying scoping as an optimization\n      if (\n        currentScope &&\n        root === n.ownerDocument &&\n        !isElementWithBuiltCss(n)\n      ) {\n        StyleTransformer.domRemoveScope(n, currentScope);\n      } else if (root instanceof ShadowRoot) {\n        const newScope = getOwnerScope(n);\n        // rescope current node and subtree if necessary\n        if (newScope !== currentScope) {\n          StyleTransformer.domReplaceScope(n, currentScope, newScope);\n        }\n        // make sure all the subtree elements are scoped correctly\n        ensureCorrectSubtreeScoping(n);\n      }\n    }\n  }\n}\n\n// if native Shadow DOM is being used, or ShadyDOM handles dynamic scoiping, do not activate the MutationObserver\nif (\n  !nativeShadow &&\n  !(window['ShadyDOM'] && window['ShadyDOM']['handlesDynamicScoping'])\n) {\n  let observer = new MutationObserver(handler);\n  let start = (node) => {\n    observer.observe(node, {childList: true, subtree: true});\n  };\n  let nativeCustomElements =\n    window['customElements'] &&\n    !window['customElements']['polyfillWrapFlushCallback'];\n  // need to start immediately with native custom elements\n  // TODO(dfreedm): with polyfilled HTMLImports and native custom elements\n  // excessive mutations may be observed; this can be optimized via cooperation\n  // with the HTMLImports polyfill.\n  if (nativeCustomElements) {\n    start(document);\n  } else {\n    let delayedStart = () => {\n      start(document.body);\n    };\n    // use polyfill timing if it's available\n    if (window['HTMLImports']) {\n      window['HTMLImports']['whenReady'](delayedStart);\n      // otherwise push beyond native imports being ready\n      // which requires RAF + readystate interactive.\n    } else {\n      requestAnimationFrame(function () {\n        if (document.readyState === 'loading') {\n          let listener = function () {\n            delayedStart();\n            document.removeEventListener('readystatechange', listener);\n          };\n          document.addEventListener('readystatechange', listener);\n        } else {\n          delayedStart();\n        }\n      });\n    }\n  }\n\n  flush = function () {\n    handler(observer.takeRecords());\n  };\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {parse, StyleNode} from './css-parse.js';\n// prettier-ignore\nimport {nativeShadow, nativeCssVariables, disableRuntime} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport StyleProperties from './style-properties.js';\n// prettier-ignore\nimport {ensureStylePlaceholder, getStylePlaceholder} from './style-placeholder.js';\nimport StyleInfo from './style-info.js';\nimport StyleCache from './style-cache.js';\n// prettier-ignore\nimport {flush as watcherFlush, getOwnerScope, getCurrentScope} from './document-watcher.js';\nimport templateMap from './template-map.js';\nimport * as ApplyShimUtils from './apply-shim-utils.js';\nimport {updateNativeProperties, detectMixin} from './common-utils.js';\n// prettier-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport {CustomStyleInterfaceInterface, CustomStyleProvider} from './custom-style-interface.js';\n\n/** @type {!Object<string, string>} */\nconst adoptedCssTextMap = {};\n\n/**\n * @const {StyleCache}\n */\nconst styleCache = new StyleCache();\n\nexport default class ScopingShim {\n  constructor() {\n    this._scopeCounter = {};\n    this._documentOwner = /** @type {!HTMLElement} */ (document.documentElement);\n    let ast = new StyleNode();\n    ast['rules'] = [];\n    this._documentOwnerStyleInfo = StyleInfo.set(\n      this._documentOwner,\n      new StyleInfo(ast)\n    );\n    this._elementsHaveApplied = false;\n    /** @type {?Object} */\n    this._applyShim = null;\n    /** @type {?CustomStyleInterfaceInterface} */\n    this._customStyleInterface = null;\n  }\n  flush() {\n    watcherFlush();\n  }\n  _generateScopeSelector(name) {\n    let id = (this._scopeCounter[name] = (this._scopeCounter[name] || 0) + 1);\n    return `${name}-${id}`;\n  }\n  getStyleAst(style) {\n    return StyleUtil.rulesForStyle(style);\n  }\n  styleAstToString(ast) {\n    return StyleUtil.toCssText(ast);\n  }\n  _gatherStyles(template) {\n    return StyleUtil.gatherStyleText(template.content);\n  }\n  /**\n   * Prepare the styling and template for the given element type\n   *\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplate(template, elementName, typeExtension) {\n    this.prepareTemplateDom(template, elementName);\n    this.prepareTemplateStyles(template, elementName, typeExtension);\n  }\n  /**\n   * Prepare styling for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplateStyles(template, elementName, typeExtension) {\n    if (template._prepared || disableRuntime) {\n      return;\n    }\n    // style placeholders are only used when ShadyDOM is active\n    if (!nativeShadow) {\n      ensureStylePlaceholder(elementName);\n    }\n    template._prepared = true;\n    template.name = elementName;\n    template.extends = typeExtension;\n    templateMap[elementName] = template;\n    let cssBuild = StyleUtil.getCssBuild(template);\n    const optimalBuild = StyleUtil.isOptimalCssBuild(cssBuild);\n    let info = {\n      is: elementName,\n      extends: typeExtension,\n    };\n    let cssText =\n      this._gatherStyles(template) + (adoptedCssTextMap[elementName] || '');\n    // check if the styling has mixin definitions or uses\n    this._ensure();\n    if (!optimalBuild) {\n      let hasMixins = !cssBuild && detectMixin(cssText);\n      let ast = parse(cssText);\n      // only run the applyshim transforms if there is a mixin involved\n      if (hasMixins && nativeCssVariables && this._applyShim) {\n        this._applyShim['transformRules'](ast, elementName);\n      }\n      template['_styleAst'] = ast;\n    }\n    let ownPropertyNames = [];\n    if (!nativeCssVariables) {\n      ownPropertyNames = StyleProperties.decorateStyles(template['_styleAst']);\n    }\n    if (!ownPropertyNames.length || nativeCssVariables) {\n      let root = nativeShadow ? template.content : null;\n      let placeholder = getStylePlaceholder(elementName);\n      let style = this._generateStaticStyle(\n        info,\n        template['_styleAst'],\n        root,\n        placeholder,\n        cssBuild,\n        optimalBuild ? cssText : ''\n      );\n      template._style = style;\n    }\n    template._ownPropertyNames = ownPropertyNames;\n  }\n\n  /**\n   * @param {!Array<string>} cssTextArray\n   * @param {string} elementName\n   */\n  prepareAdoptedCssText(cssTextArray, elementName) {\n    adoptedCssTextMap[elementName] = cssTextArray.join(' ');\n  }\n  /**\n   * Prepare template for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    if (disableRuntime) {\n      return;\n    }\n    const cssBuild = StyleUtil.getCssBuild(template);\n    if (!nativeShadow && cssBuild !== 'shady' && !template._domPrepared) {\n      template._domPrepared = true;\n      StyleTransformer.domAddScope(template.content, elementName);\n    }\n  }\n  /**\n   * @param {!{is: string, extends: (string|undefined)}} info\n   * @param {!StyleNode} rules\n   * @param {DocumentFragment} shadowroot\n   * @param {Node} placeholder\n   * @param {string} cssBuild\n   * @param {string=} cssText\n   * @return {?HTMLStyleElement}\n   */\n  _generateStaticStyle(\n    info,\n    rules,\n    shadowroot,\n    placeholder,\n    cssBuild,\n    cssText\n  ) {\n    cssText = StyleTransformer.elementStyles(\n      info,\n      rules,\n      null,\n      cssBuild,\n      cssText\n    );\n    if (cssText.length) {\n      return StyleUtil.applyCss(cssText, info.is, shadowroot, placeholder);\n    }\n    return null;\n  }\n  _prepareHost(host) {\n    const {is, typeExtension} = StyleUtil.getIsExtends(host);\n    const placeholder = getStylePlaceholder(is);\n    const template = templateMap[is];\n    if (!template) {\n      return;\n    }\n    const ast = template['_styleAst'];\n    const ownStylePropertyNames = template._ownPropertyNames;\n    const cssBuild = StyleUtil.getCssBuild(template);\n    const styleInfo = new StyleInfo(\n      ast,\n      placeholder,\n      ownStylePropertyNames,\n      is,\n      typeExtension,\n      cssBuild\n    );\n    StyleInfo.set(host, styleInfo);\n    return styleInfo;\n  }\n  /**\n   * Returns a boolean that indicates if styles need to be reprocessed because\n   * the apply shim is now available.\n   * @return {boolean}\n   */\n  _ensureApplyShim() {\n    if (!this._applyShim && window.ShadyCSS && window.ShadyCSS.ApplyShim) {\n      this._applyShim = /** @type {!Object} */ (window.ShadyCSS.ApplyShim);\n      this._applyShim['invalidCallback'] = ApplyShimUtils.invalidate;\n      return true;\n    }\n    return false;\n  }\n  _ensureCustomStyleInterface() {\n    if (this._customStyleInterface) {\n      return;\n    } else if (window.ShadyCSS && window.ShadyCSS.CustomStyleInterface) {\n      this._customStyleInterface = /** @type {!CustomStyleInterfaceInterface} */ (window\n        .ShadyCSS.CustomStyleInterface);\n      /** @type {function(!HTMLStyleElement)} */\n      this._customStyleInterface['transformCallback'] = (style) => {\n        this.transformCustomStyleForDocument(style);\n      };\n      this._customStyleInterface['validateCallback'] = () => {\n        requestAnimationFrame(() => {\n          if (\n            this._customStyleInterface['enqueued'] ||\n            this._elementsHaveApplied\n          ) {\n            this.flushCustomStyles();\n          }\n        });\n      };\n    }\n  }\n  /**\n   * Returns a boolean that indicates if styles need to be reprocessed because\n   * the apply shim is now available.\n   * @return {boolean}\n   */\n  _ensure() {\n    const needsApplyShimUpdate = this._ensureApplyShim();\n    this._ensureCustomStyleInterface();\n    return needsApplyShimUpdate;\n  }\n  /**\n   * Flush and apply custom styles to document\n   */\n  flushCustomStyles() {\n    if (disableRuntime) {\n      return;\n    }\n    const needsApplyShimUpdate = this._ensure();\n    if (!this._customStyleInterface) {\n      return;\n    }\n    let customStyles = this._customStyleInterface['processStyles']();\n    // early return if custom-styles don't need validation\n    if (!needsApplyShimUpdate && !this._customStyleInterface['enqueued']) {\n      return;\n    }\n    // bail if custom styles are built optimally\n    if (StyleUtil.isOptimalCssBuild(this._documentOwnerStyleInfo.cssBuild)) {\n      return;\n    }\n    if (!nativeCssVariables) {\n      this._reorderCustomStylesRules(customStyles);\n      this._updateProperties(this._documentOwner, this._documentOwnerStyleInfo);\n      this._applyCustomStyles(customStyles);\n      if (this._elementsHaveApplied) {\n        // if custom elements have upgraded and there are no native css variables, we must recalculate the whole tree\n        this.styleDocument();\n      }\n    } else if (!this._documentOwnerStyleInfo.cssBuild) {\n      this._revalidateCustomStyleApplyShim(customStyles);\n    }\n    this._customStyleInterface['enqueued'] = false;\n  }\n  /**\n   * Reorder of custom styles for Custom Property shim\n   * @param {!Array<!CustomStyleProvider>} customStyles\n   */\n  _reorderCustomStylesRules(customStyles) {\n    const styles = customStyles\n      .map((c) => this._customStyleInterface['getStyleForCustomStyle'](c))\n      .filter((s) => !!s);\n    // sort styles in document order\n    styles.sort((a, b) => {\n      // use `b.compare(a)` to be more straightforward\n      const position = b.compareDocumentPosition(a);\n      if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n        // A is after B, A should be higher sorted\n        return 1;\n      } else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n        // A is before B, A should be lower sorted\n        return -1;\n      } else {\n        return 0;\n      }\n    });\n    // sort ast ordering for document\n    this._documentOwnerStyleInfo.styleRules['rules'] = styles.map((s) =>\n      StyleUtil.rulesForStyle(s)\n    );\n  }\n  /**\n   * Apply styles for the given element\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} overrideProps\n   */\n  styleElement(host, overrideProps) {\n    if (disableRuntime) {\n      if (overrideProps) {\n        if (!StyleInfo.get(host)) {\n          StyleInfo.set(host, new StyleInfo(null));\n        }\n        const styleInfo = /** @type {!StyleInfo} */ (StyleInfo.get(host));\n        this._mixOverrideStyleProps(styleInfo, overrideProps);\n        this.styleElementNativeVariables(host, styleInfo);\n      }\n      return;\n    }\n    const styleInfo = StyleInfo.get(host) || this._prepareHost(host);\n    // if there is no style info at this point, bail\n    if (!styleInfo) {\n      return;\n    }\n    // Only trip the `elementsHaveApplied` flag if a node other that the root document has `applyStyle` called\n    if (!this._isRootOwner(host)) {\n      this._elementsHaveApplied = true;\n    }\n    if (overrideProps) {\n      this._mixOverrideStyleProps(styleInfo, overrideProps);\n    }\n    if (!nativeCssVariables) {\n      this.styleElementShimVariables(host, styleInfo);\n    } else {\n      this.styleElementNativeVariables(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!StyleInfo} styleInfo\n   * @param {Object} overrideProps\n   */\n  _mixOverrideStyleProps(styleInfo, overrideProps) {\n    styleInfo.overrideStyleProperties = styleInfo.overrideStyleProperties || {};\n    Object.assign(styleInfo.overrideStyleProperties, overrideProps);\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementShimVariables(host, styleInfo) {\n    this.flush();\n    this._updateProperties(host, styleInfo);\n    if (\n      styleInfo.ownStylePropertyNames &&\n      styleInfo.ownStylePropertyNames.length\n    ) {\n      this._applyStyleProperties(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementNativeVariables(host, styleInfo) {\n    const {is} = StyleUtil.getIsExtends(host);\n    if (styleInfo.overrideStyleProperties) {\n      updateNativeProperties(host, styleInfo.overrideStyleProperties);\n    }\n    const template = templateMap[is];\n    // bail early if there is no shadowroot for this element\n    if (!template && !this._isRootOwner(host)) {\n      return;\n    }\n    // bail early if the template was built with polymer-css-build\n    if (template && StyleUtil.elementHasBuiltCss(template)) {\n      return;\n    }\n    if (\n      template &&\n      template._style &&\n      !ApplyShimUtils.templateIsValid(template)\n    ) {\n      // update template\n      if (!ApplyShimUtils.templateIsValidating(template)) {\n        this._ensure();\n        this._applyShim &&\n          this._applyShim['transformRules'](template['_styleAst'], is);\n        template._style.textContent = StyleTransformer.elementStyles(\n          host,\n          styleInfo.styleRules\n        );\n        ApplyShimUtils.startValidatingTemplate(template);\n      }\n      // update instance if native shadowdom\n      if (nativeShadow) {\n        let root = host.shadowRoot;\n        if (root) {\n          let style = root.querySelector('style');\n          if (style) {\n            style.textContent = StyleTransformer.elementStyles(\n              host,\n              styleInfo.styleRules\n            );\n          }\n        }\n      }\n      styleInfo.styleRules = template['_styleAst'];\n    }\n  }\n  _styleOwnerForNode(node) {\n    let root = StyleUtil.wrap(node).getRootNode();\n    let host = root.host;\n    if (host) {\n      if (StyleInfo.get(host) || this._prepareHost(host)) {\n        return host;\n      } else {\n        return this._styleOwnerForNode(host);\n      }\n    }\n    return this._documentOwner;\n  }\n  _isRootOwner(node) {\n    return node === this._documentOwner;\n  }\n  _applyStyleProperties(host, styleInfo) {\n    let is = StyleUtil.getIsExtends(host).is;\n    let cacheEntry = styleCache.fetch(\n      is,\n      styleInfo.styleProperties,\n      styleInfo.ownStylePropertyNames\n    );\n    let cachedScopeSelector = cacheEntry && cacheEntry.scopeSelector;\n    let cachedStyle = cacheEntry ? cacheEntry.styleElement : null;\n    let oldScopeSelector = styleInfo.scopeSelector;\n    // only generate new scope if cached style is not found\n    styleInfo.scopeSelector =\n      cachedScopeSelector || this._generateScopeSelector(is);\n    let style = StyleProperties.applyElementStyle(\n      host,\n      styleInfo.styleProperties,\n      styleInfo.scopeSelector,\n      cachedStyle\n    );\n    if (!nativeShadow) {\n      StyleProperties.applyElementScopeSelector(\n        host,\n        styleInfo.scopeSelector,\n        oldScopeSelector\n      );\n    }\n    if (!cacheEntry) {\n      styleCache.store(\n        is,\n        styleInfo.styleProperties,\n        style,\n        styleInfo.scopeSelector\n      );\n    }\n    return style;\n  }\n  _updateProperties(host, styleInfo) {\n    let owner = this._styleOwnerForNode(host);\n    let ownerStyleInfo = StyleInfo.get(owner);\n    let ownerProperties = ownerStyleInfo.styleProperties;\n    // style owner has not updated properties yet\n    // go up the chain and force property update,\n    // except if the owner is the document\n    if (owner !== this._documentOwner && !ownerProperties) {\n      this._updateProperties(owner, ownerStyleInfo);\n      ownerProperties = ownerStyleInfo.styleProperties;\n    }\n    let props = Object.create(ownerProperties || null);\n    let hostAndRootProps = StyleProperties.hostAndRootPropertiesForScope(\n      host,\n      styleInfo.styleRules,\n      styleInfo.cssBuild\n    );\n    let propertyData = StyleProperties.propertyDataFromStyles(\n      ownerStyleInfo.styleRules,\n      host\n    );\n    let propertiesMatchingHost = propertyData.properties;\n    Object.assign(\n      props,\n      hostAndRootProps.hostProps,\n      propertiesMatchingHost,\n      hostAndRootProps.rootProps\n    );\n    this._mixinOverrideStyles(props, styleInfo.overrideStyleProperties);\n    StyleProperties.reify(props);\n    styleInfo.styleProperties = props;\n  }\n  _mixinOverrideStyles(props, overrides) {\n    for (let p in overrides) {\n      let v = overrides[p];\n      // skip override props if they are not truthy or 0\n      // in order to fall back to inherited values\n      if (v || v === 0) {\n        props[p] = v;\n      }\n    }\n  }\n  /**\n   * Update styles of the whole document\n   *\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    this.styleSubtree(this._documentOwner, properties);\n  }\n  /**\n   * Update styles of a subtree\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} properties\n   */\n  styleSubtree(host, properties) {\n    const wrappedHost = StyleUtil.wrap(host);\n    const root = wrappedHost.shadowRoot;\n    const isRootOwner = this._isRootOwner(host);\n    if (root || isRootOwner) {\n      this.styleElement(host, properties);\n    }\n    const descendantRoot = isRootOwner ? wrappedHost : root;\n    if (descendantRoot) {\n      const descendantHosts = Array.from(\n        descendantRoot.querySelectorAll('*')\n      ).filter((x) => StyleUtil.wrap(x).shadowRoot);\n      for (let i = 0; i < descendantHosts.length; i++) {\n        this.styleSubtree(descendantHosts[i]);\n      }\n    }\n  }\n  /* Custom Style operations */\n  _revalidateCustomStyleApplyShim(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        this._revalidateApplyShim(s);\n      }\n    }\n  }\n  _applyCustomStyles(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        StyleProperties.applyCustomStyle(\n          s,\n          this._documentOwnerStyleInfo.styleProperties\n        );\n      }\n    }\n  }\n  transformCustomStyleForDocument(style) {\n    const cssBuild = StyleUtil.getCssBuild(style);\n    if (cssBuild !== this._documentOwnerStyleInfo.cssBuild) {\n      this._documentOwnerStyleInfo.cssBuild = cssBuild;\n    }\n    if (StyleUtil.isOptimalCssBuild(cssBuild)) {\n      return;\n    }\n    let ast = StyleUtil.rulesForStyle(style);\n    StyleUtil.forEachRule(ast, (rule) => {\n      if (nativeShadow) {\n        StyleTransformer.normalizeRootSelector(rule);\n      } else {\n        StyleTransformer.documentRule(rule);\n      }\n      if (nativeCssVariables && cssBuild === '') {\n        this._ensure();\n        this._applyShim && this._applyShim['transformRule'](rule);\n      }\n    });\n    if (nativeCssVariables) {\n      style.textContent = StyleUtil.toCssText(ast);\n    } else {\n      this._documentOwnerStyleInfo.styleRules['rules'].push(ast);\n    }\n  }\n  _revalidateApplyShim(style) {\n    if (nativeCssVariables && this._applyShim) {\n      let ast = StyleUtil.rulesForStyle(style);\n      this._ensure();\n      this._applyShim['transformRules'](ast);\n      style.textContent = StyleUtil.toCssText(ast);\n    }\n  }\n  getComputedStyleValue(element, property) {\n    let value;\n    if (!nativeCssVariables) {\n      // element is either a style host, or an ancestor of a style host\n      let styleInfo =\n        StyleInfo.get(element) ||\n        StyleInfo.get(this._styleOwnerForNode(element));\n      value = styleInfo.styleProperties[property];\n    }\n    // fall back to the property value from the computed styling\n    value =\n      value || window.getComputedStyle(element).getPropertyValue(property);\n    // trim whitespace that can come after the `:` in css\n    // example: padding: 2px -> \" 2px\"\n    return value ? value.trim() : '';\n  }\n  // given an element and a classString, replaces\n  // the element's class with the provided classString and adds\n  // any necessary ShadyCSS static and property based scoping selectors\n  setElementClass(element, classString) {\n    let root = StyleUtil.wrap(element).getRootNode();\n    let classes;\n    if (classString) {\n      let definitelyString =\n        typeof classString === 'string' ? classString : String(classString);\n      classes = definitelyString.split(/\\s/);\n    } else {\n      classes = [];\n    }\n    let scopeName = root.host && root.host.localName;\n    // If no scope, try to discover scope name from existing class.\n    // This can occur if, for example, a template stamped element that\n    // has been scoped is manipulated when not in a root.\n    if (!scopeName) {\n      var classAttr = element.getAttribute('class');\n      if (classAttr) {\n        let k$ = classAttr.split(/\\s/);\n        for (let i = 0; i < k$.length; i++) {\n          if (k$[i] === StyleTransformer.SCOPE_NAME) {\n            scopeName = k$[i + 1];\n            break;\n          }\n        }\n      }\n    }\n    if (scopeName) {\n      classes.push(StyleTransformer.SCOPE_NAME, scopeName);\n    }\n    if (!nativeCssVariables) {\n      let styleInfo = StyleInfo.get(element);\n      if (styleInfo && styleInfo.scopeSelector) {\n        classes.push(StyleProperties.XSCOPE_NAME, styleInfo.scopeSelector);\n      }\n    }\n    StyleUtil.setElementClassRaw(element, classes.join(' '));\n  }\n  _styleInfoForNode(node) {\n    return StyleInfo.get(node);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  scopeNode(node, scope) {\n    StyleTransformer.element(node, scope);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  unscopeNode(node, scope) {\n    StyleTransformer.element(node, scope, true);\n  }\n  /**\n   * @param {!Node} node\n   * @return {string}\n   */\n  scopeForNode(node) {\n    return getOwnerScope(node);\n  }\n  /**\n   * @param {!Element} node\n   * @return {string}\n   */\n  currentScopeForNode(node) {\n    return getCurrentScope(node);\n  }\n}\n\n/* exports */\n/* eslint-disable no-self-assign */\nScopingShim.prototype['flush'] = ScopingShim.prototype.flush;\nScopingShim.prototype['prepareTemplate'] =\n  ScopingShim.prototype.prepareTemplate;\nScopingShim.prototype['styleElement'] = ScopingShim.prototype.styleElement;\nScopingShim.prototype['styleDocument'] = ScopingShim.prototype.styleDocument;\nScopingShim.prototype['styleSubtree'] = ScopingShim.prototype.styleSubtree;\nScopingShim.prototype['getComputedStyleValue'] =\n  ScopingShim.prototype.getComputedStyleValue;\nScopingShim.prototype['setElementClass'] =\n  ScopingShim.prototype.setElementClass;\nScopingShim.prototype['_styleInfoForNode'] =\n  ScopingShim.prototype._styleInfoForNode;\nScopingShim.prototype['transformCustomStyleForDocument'] =\n  ScopingShim.prototype.transformCustomStyleForDocument;\nScopingShim.prototype['getStyleAst'] = ScopingShim.prototype.getStyleAst;\nScopingShim.prototype['styleAstToString'] =\n  ScopingShim.prototype.styleAstToString;\nScopingShim.prototype['flushCustomStyles'] =\n  ScopingShim.prototype.flushCustomStyles;\nScopingShim.prototype['scopeNode'] = ScopingShim.prototype.scopeNode;\nScopingShim.prototype['unscopeNode'] = ScopingShim.prototype.unscopeNode;\nScopingShim.prototype['scopeForNode'] = ScopingShim.prototype.scopeForNode;\nScopingShim.prototype['currentScopeForNode'] =\n  ScopingShim.prototype.currentScopeForNode;\nScopingShim.prototype['prepareAdoptedCssText'] =\n  ScopingShim.prototype.prepareAdoptedCssText;\n/* eslint-enable no-self-assign */\nObject.defineProperties(ScopingShim.prototype, {\n  'nativeShadow': {\n    get() {\n      return nativeShadow;\n    },\n  },\n  'nativeCss': {\n    get() {\n      return nativeCssVariables;\n    },\n  },\n});\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n'use strict';\n\nexport default class StyleCache {\n  constructor(typeMax = 100) {\n    // map element name -> [{properties, styleElement, scopeSelector}]\n    this.cache = {};\n    /** @type {number} */\n    this.typeMax = typeMax;\n  }\n\n  _validate(cacheEntry, properties, ownPropertyNames) {\n    for (let idx = 0; idx < ownPropertyNames.length; idx++) {\n      let pn = ownPropertyNames[idx];\n      if (cacheEntry.properties[pn] !== properties[pn]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  store(tagname, properties, styleElement, scopeSelector) {\n    let list = this.cache[tagname] || [];\n    list.push({properties, styleElement, scopeSelector});\n    if (list.length > this.typeMax) {\n      list.shift();\n    }\n    this.cache[tagname] = list;\n  }\n\n  fetch(tagname, properties, ownPropertyNames) {\n    let list = this.cache[tagname];\n    if (!list) {\n      return;\n    }\n    // reverse list for most-recent lookups\n    for (let idx = list.length - 1; idx >= 0; idx--) {\n      let entry = list[idx];\n      if (this._validate(entry, properties, ownPropertyNames)) {\n        return entry;\n      }\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/** @const {string} */\nconst infoKey = '__styleInfo';\n\nexport default class StyleInfo {\n  /**\n   * @param {Element} node\n   * @return {StyleInfo}\n   */\n  static get(node) {\n    if (node) {\n      return node[infoKey];\n    } else {\n      return null;\n    }\n  }\n  /**\n   * @param {!Element} node\n   * @param {StyleInfo} styleInfo\n   * @return {StyleInfo}\n   */\n  static set(node, styleInfo) {\n    node[infoKey] = styleInfo;\n    return styleInfo;\n  }\n  /**\n   * @param {StyleNode} ast\n   * @param {Node=} placeholder\n   * @param {Array<string>=} ownStylePropertyNames\n   * @param {string=} elementName\n   * @param {string=} typeExtension\n   * @param {string=} cssBuild\n   */\n  constructor(\n    ast,\n    placeholder,\n    ownStylePropertyNames,\n    elementName,\n    typeExtension,\n    cssBuild\n  ) {\n    /** @type {StyleNode} */\n    this.styleRules = ast || null;\n    /** @type {Node} */\n    this.placeholder = placeholder || null;\n    /** @type {!Array<string>} */\n    this.ownStylePropertyNames = ownStylePropertyNames || [];\n    /** @type {Object} */\n    this.overrideStyleProperties = null;\n    /** @type {string} */\n    this.elementName = elementName || '';\n    /** @type {string} */\n    this.cssBuild = cssBuild || '';\n    /** @type {string} */\n    this.typeExtension = typeExtension || '';\n    /** @type {Object<string, string>} */\n    this.styleProperties = null;\n    /** @type {?string} */\n    this.scopeSelector = null;\n    /** @type {HTMLStyleElement} */\n    this.customStyle = null;\n  }\n  _getStyleRules() {\n    return this.styleRules;\n  }\n}\n\n/* eslint-disable-next-line no-self-assign */\nStyleInfo.prototype['_getStyleRules'] = StyleInfo.prototype._getStyleRules;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {applyStylePlaceHolder} from './style-util.js';\nimport {nativeShadow, disableRuntime} from './style-settings.js';\n\n/** @type {!Object<string, !Node>} */\nconst placeholderMap = {};\n\n/**\n * @param {string} elementName\n * @return {Node}\n */\nexport function getStylePlaceholder(elementName) {\n  return placeholderMap[elementName] || null;\n}\n\n/**\n * @param {string} elementName\n */\nexport function ensureStylePlaceholder(elementName) {\n  if (!placeholderMap[elementName]) {\n    placeholderMap[elementName] = applyStylePlaceHolder(elementName);\n  }\n}\n\n/**\n * @const {CustomElementRegistry}\n */\nconst ce = window['customElements'];\nif (ce && !nativeShadow && !disableRuntime) {\n  /**\n   * @const {function(this:CustomElementRegistry, string,function(new:HTMLElement),{extends: string}=)}\n   */\n  const origDefine = ce['define'];\n  /**\n   * @param {string} name\n   * @param {function(new:HTMLElement)} clazz\n   * @param {{extends: string}=} options\n   */\n  const wrappedDefine = (name, clazz, options) => {\n    ensureStylePlaceholder(name);\n    origDefine.call(\n      /** @type {!CustomElementRegistry} */ (ce),\n      name,\n      clazz,\n      options\n    );\n  };\n  ce['define'] = wrappedDefine;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {removeCustomPropAssignment, StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport * as RX from './common-regex.js';\nimport StyleInfo from './style-info.js';\n\n// TODO: dedupe with shady\n/**\n * @param {string} selector\n * @return {boolean}\n * @this {Element}\n */\nconst matchesSelector = function (selector) {\n  const method =\n    this.matches ||\n    this.matchesSelector ||\n    this.mozMatchesSelector ||\n    this.msMatchesSelector ||\n    this.oMatchesSelector ||\n    this.webkitMatchesSelector;\n  return method && method.call(this, selector);\n};\n\nconst rootSelector = /:host\\s*>\\s*/;\n\nfunction checkRoot(hostScope, selector) {\n  return (\n    Boolean(selector.match(rootSelector)) ||\n    (hostScope === 'html' && selector.indexOf('html') > -1)\n  );\n}\n\nconst IS_IE = navigator.userAgent.match('Trident');\n\nconst XSCOPE_NAME = 'x-scope';\n\nclass StyleProperties {\n  /** @return {string} */\n  get XSCOPE_NAME() {\n    return XSCOPE_NAME;\n  }\n  /**\n   * decorates styles with rule info and returns an array of used style property names\n   *\n   * @param {StyleNode} rules\n   * @return {!Array<string>}\n   */\n  decorateStyles(rules) {\n    let self = this,\n      props = {},\n      keyframes = [],\n      ruleIndex = 0;\n    StyleUtil.forEachRule(\n      rules,\n      function (rule) {\n        self.decorateRule(rule);\n        // mark in-order position of ast rule in styles block, used for cache key\n        rule.index = ruleIndex++;\n        self.collectPropertiesInCssText(rule.propertyInfo.cssText, props);\n      },\n      function onKeyframesRule(rule) {\n        keyframes.push(rule);\n      }\n    );\n    // Cache all found keyframes rules for later reference:\n    rules._keyframes = keyframes;\n    // return this list of property names *consumes* in these styles.\n    let names = [];\n    for (let i in props) {\n      names.push(i);\n    }\n    return names;\n  }\n\n  // decorate a single rule with property info\n  decorateRule(rule) {\n    if (rule.propertyInfo) {\n      return rule.propertyInfo;\n    }\n    let info = {},\n      properties = {};\n    let hasProperties = this.collectProperties(rule, properties);\n    if (hasProperties) {\n      info.properties = properties;\n      // TODO(sorvell): workaround parser seeing mixins as additional rules\n      rule['rules'] = null;\n    }\n    info.cssText = this.collectCssText(rule);\n    rule.propertyInfo = info;\n    return info;\n  }\n\n  // collects the custom properties from a rule's cssText\n  collectProperties(rule, properties) {\n    let info = rule.propertyInfo;\n    if (info) {\n      if (info.properties) {\n        Object.assign(properties, info.properties);\n        return true;\n      }\n    } else {\n      let m,\n        rx = RX.VAR_ASSIGN;\n      let cssText = rule['parsedCssText'];\n      let value;\n      let any;\n      while ((m = rx.exec(cssText))) {\n        // note: group 2 is var, 3 is mixin\n        value = (m[2] || m[3]).trim();\n        // value of 'inherit' or 'unset' is equivalent to not setting the property here\n        if (value !== 'inherit' || value !== 'unset') {\n          properties[m[1].trim()] = value;\n        }\n        any = true;\n      }\n      return any;\n    }\n  }\n\n  // returns cssText of properties that consume variables/mixins\n  collectCssText(rule) {\n    return this.collectConsumingCssText(rule['parsedCssText']);\n  }\n\n  // NOTE: we support consumption inside mixin assignment\n  // but not production, so strip out {...}\n  collectConsumingCssText(cssText) {\n    return cssText.replace(RX.BRACKETED, '').replace(RX.VAR_ASSIGN, '');\n  }\n\n  collectPropertiesInCssText(cssText, props) {\n    let m;\n    while ((m = RX.VAR_CONSUMED.exec(cssText))) {\n      let name = m[1];\n      // This regex catches all variable names, and following non-whitespace char\n      // If next char is not ':', then variable is a consumer\n      if (m[2] !== ':') {\n        props[name] = true;\n      }\n    }\n  }\n\n  // turns custom properties into realized values.\n  reify(props) {\n    // big perf optimization here: reify only *own* properties\n    // since this object has __proto__ of the element's scope properties\n    let names = Object.getOwnPropertyNames(props);\n    for (let i = 0, n; i < names.length; i++) {\n      n = names[i];\n      props[n] = this.valueForProperty(props[n], props);\n    }\n  }\n\n  // given a property value, returns the reified value\n  // a property value may be:\n  // (1) a literal value like: red or 5px;\n  // (2) a variable value like: var(--a), var(--a, red), or var(--a, --b) or\n  // var(--a, var(--b));\n  // (3) a literal mixin value like { properties }. Each of these properties\n  // can have values that are: (a) literal, (b) variables, (c) @apply mixins.\n  valueForProperty(property, props) {\n    // case (1) default\n    // case (3) defines a mixin and we have to reify the internals\n    if (property) {\n      if (property.indexOf(';') >= 0) {\n        property = this.valueForProperties(property, props);\n      } else {\n        // case (2) variable\n        let self = this;\n        let fn = function (prefix, value, fallback, suffix) {\n          if (!value) {\n            return prefix + suffix;\n          }\n          let propertyValue = self.valueForProperty(props[value], props);\n          // if value is \"initial\", then the variable should be treated as unset\n          if (!propertyValue || propertyValue === 'initial') {\n            // fallback may be --a or var(--a) or literal\n            propertyValue =\n              self.valueForProperty(props[fallback] || fallback, props) ||\n              fallback;\n          } else if (propertyValue === 'apply-shim-inherit') {\n            // CSS build will replace `inherit` with `apply-shim-inherit`\n            // for use with native css variables.\n            // Since we have full control, we can use `inherit` directly.\n            propertyValue = 'inherit';\n          }\n          return prefix + (propertyValue || '') + suffix;\n        };\n        property = StyleUtil.processVariableAndFallback(property, fn);\n      }\n    }\n    return (property && property.trim()) || '';\n  }\n\n  // note: we do not yet support mixin within mixin\n  valueForProperties(property, props) {\n    let parts = property.split(';');\n    for (let i = 0, p, m; i < parts.length; i++) {\n      if ((p = parts[i])) {\n        RX.MIXIN_MATCH.lastIndex = 0;\n        m = RX.MIXIN_MATCH.exec(p);\n        if (m) {\n          p = this.valueForProperty(props[m[1]], props);\n        } else {\n          let colon = p.indexOf(':');\n          if (colon !== -1) {\n            let pp = p.substring(colon);\n            pp = pp.trim();\n            pp = this.valueForProperty(pp, props) || pp;\n            p = p.substring(0, colon) + pp;\n          }\n        }\n        parts[i] =\n          p && p.lastIndexOf(';') === p.length - 1\n            ? p.slice(0, -1) // strip trailing ;\n            : p || '';\n      }\n    }\n    return parts.join(';');\n  }\n\n  applyProperties(rule, props) {\n    let output = '';\n    // dynamically added sheets may not be decorated so ensure they are.\n    if (!rule.propertyInfo) {\n      this.decorateRule(rule);\n    }\n    if (rule.propertyInfo.cssText) {\n      output = this.valueForProperties(rule.propertyInfo.cssText, props);\n    }\n    rule['cssText'] = output;\n  }\n\n  // Apply keyframe transformations to the cssText of a given rule. The\n  // keyframeTransforms object is a map of keyframe names to transformer\n  // functions which take in cssText and spit out transformed cssText.\n  applyKeyframeTransforms(rule, keyframeTransforms) {\n    let input = rule['cssText'];\n    let output = rule['cssText'];\n    if (rule.hasAnimations == null) {\n      // Cache whether or not the rule has any animations to begin with:\n      rule.hasAnimations = RX.ANIMATION_MATCH.test(input);\n    }\n    // If there are no animations referenced, we can skip transforms:\n    if (rule.hasAnimations) {\n      let transform;\n      // If we haven't transformed this rule before, we iterate over all\n      // transforms:\n      if (rule.keyframeNamesToTransform == null) {\n        rule.keyframeNamesToTransform = [];\n        for (let keyframe in keyframeTransforms) {\n          transform = keyframeTransforms[keyframe];\n          output = transform(input);\n          // If the transform actually changed the CSS text, we cache the\n          // transform name for future use:\n          if (input !== output) {\n            input = output;\n            rule.keyframeNamesToTransform.push(keyframe);\n          }\n        }\n      } else {\n        // If we already have a list of keyframe names that apply to this\n        // rule, we apply only those keyframe name transforms:\n        for (let i = 0; i < rule.keyframeNamesToTransform.length; ++i) {\n          transform = keyframeTransforms[rule.keyframeNamesToTransform[i]];\n          input = transform(input);\n        }\n        output = input;\n      }\n    }\n    rule['cssText'] = output;\n  }\n\n  // Test if the rules in these styles matches the given `element` and if so,\n  // collect any custom properties into `props`.\n  /**\n   * @param {StyleNode} rules\n   * @param {Element} element\n   */\n  propertyDataFromStyles(rules, element) {\n    let props = {};\n    // generates a unique key for these matches\n    let o = [];\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(\n      rules,\n      (rule) => {\n        // TODO(sorvell): we could trim the set of rules at declaration\n        // time to only include ones that have properties\n        if (!rule.propertyInfo) {\n          this.decorateRule(rule);\n        }\n        // match element against transformedSelector: selector may contain\n        // unwanted uniquification and parsedSelector does not directly match\n        // for :host selectors.\n        let selectorToMatch =\n          rule.transformedSelector || rule['parsedSelector'];\n        if (element && rule.propertyInfo.properties && selectorToMatch) {\n          if (matchesSelector.call(element, selectorToMatch)) {\n            this.collectProperties(rule, props);\n            // produce numeric key for these matches for lookup\n            addToBitMask(rule.index, o);\n          }\n        }\n      },\n      null,\n      true\n    );\n    return {properties: props, key: o};\n  }\n\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rule\n   * @param {string} cssBuild\n   * @param {function(Object)} callback\n   */\n  whenHostOrRootRule(scope, rule, cssBuild, callback) {\n    if (!(/** @type {?} */ (rule.propertyInfo))) {\n      this.decorateRule(rule);\n    }\n    if (!(/** @type {?} */ (rule.propertyInfo).properties)) {\n      return;\n    }\n    let {is, typeExtension} = StyleUtil.getIsExtends(scope);\n    let hostScope = is\n      ? StyleTransformer._calcHostScope(is, typeExtension)\n      : 'html';\n    let parsedSelector = rule['parsedSelector'];\n    let isRoot = checkRoot(hostScope, parsedSelector);\n    let isHost = parsedSelector.indexOf(':host') === 0 && !isRoot;\n    // build info is either in scope (when scope is an element) or in the style\n    // when scope is the default scope; note: this allows default scope to have\n    // mixed mode built and unbuilt styles.\n    if (cssBuild === 'shady') {\n      // :root -> x-foo > *.x-foo for elements and html for custom-style\n      isRoot =\n        parsedSelector === hostScope + ' > *.' + hostScope ||\n        parsedSelector.indexOf('html') !== -1;\n      // :host -> x-foo for elements, but sub-rules have .x-foo in them\n      isHost = !isRoot && parsedSelector.indexOf(hostScope) === 0;\n    }\n    if (!isRoot && !isHost) {\n      return;\n    }\n    let selectorToMatch = hostScope;\n    if (isHost) {\n      // need to transform :host because `:host` does not work with `matches`\n      if (!(/** @type {?} */ (rule.transformedSelector))) {\n        // transform :host into a matchable selector\n        rule.transformedSelector = StyleTransformer._transformRuleCss(\n          rule,\n          StyleTransformer._transformComplexSelector,\n          StyleTransformer._calcElementScope(is),\n          hostScope\n        );\n      }\n      selectorToMatch =\n        /** @type {?} */ (rule.transformedSelector) || hostScope;\n    }\n    if (isRoot && hostScope === 'html') {\n      selectorToMatch =\n        /** @type {?} */ (rule.transformedSelector) ||\n        /** @type {?} */ (rule.parsedSelector);\n    }\n    callback({\n      selector: selectorToMatch,\n      isHost: isHost,\n      isRoot: isRoot,\n    });\n  }\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rules\n   * @param {string} cssBuild\n   * @return {!Object}\n   */\n  hostAndRootPropertiesForScope(scope, rules, cssBuild) {\n    let hostProps = {},\n      rootProps = {};\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(\n      rules,\n      (rule) => {\n        // if scope is StyleDefaults, use _element for matchesSelector\n        this.whenHostOrRootRule(scope, rule, cssBuild, (info) => {\n          let element = scope._element || scope;\n          if (matchesSelector.call(element, info.selector)) {\n            if (info.isHost) {\n              this.collectProperties(rule, hostProps);\n            } else {\n              this.collectProperties(rule, rootProps);\n            }\n          }\n        });\n      },\n      null,\n      true\n    );\n    return {rootProps: rootProps, hostProps: hostProps};\n  }\n\n  /**\n   * @param {Element} element\n   * @param {Object} properties\n   * @param {string} scopeSelector\n   */\n  transformStyles(element, properties, scopeSelector) {\n    let self = this;\n    let {is, typeExtension} = StyleUtil.getIsExtends(element);\n    let hostSelector = StyleTransformer._calcHostScope(is, typeExtension);\n    let rxHostSelector = element.extends\n      ? '\\\\' + hostSelector.slice(0, -1) + '\\\\]'\n      : hostSelector;\n    let hostRx = new RegExp(RX.HOST_PREFIX + rxHostSelector + RX.HOST_SUFFIX);\n    let {styleRules: rules, cssBuild} = StyleInfo.get(element);\n    let keyframeTransforms = this._elementKeyframeTransforms(\n      element,\n      rules,\n      scopeSelector\n    );\n    return StyleTransformer.elementStyles(\n      element,\n      rules,\n      function (rule) {\n        self.applyProperties(rule, properties);\n        if (\n          !nativeShadow &&\n          !StyleUtil.isKeyframesSelector(rule) &&\n          rule['cssText']\n        ) {\n          // NOTE: keyframe transforms only scope munge animation names, so it\n          // is not necessary to apply them in ShadowDOM.\n          self.applyKeyframeTransforms(rule, keyframeTransforms);\n          self._scopeSelector(rule, hostRx, hostSelector, scopeSelector);\n        }\n      },\n      cssBuild\n    );\n  }\n\n  /**\n   * @param {Element} element\n   * @param {StyleNode} rules\n   * @param {string} scopeSelector\n   * @return {!Object}\n   */\n  _elementKeyframeTransforms(element, rules, scopeSelector) {\n    let keyframesRules = rules._keyframes;\n    let keyframeTransforms = {};\n    if (!nativeShadow && keyframesRules) {\n      // For non-ShadowDOM, we transform all known keyframes rules in\n      // advance for the current scope. This allows us to catch keyframes\n      // rules that appear anywhere in the stylesheet:\n      for (\n        let i = 0, keyframesRule = keyframesRules[i];\n        i < keyframesRules.length;\n        keyframesRule = keyframesRules[++i]\n      ) {\n        this._scopeKeyframes(keyframesRule, scopeSelector);\n        keyframeTransforms[\n          keyframesRule['keyframesName']\n        ] = this._keyframesRuleTransformer(keyframesRule);\n      }\n    }\n    return keyframeTransforms;\n  }\n\n  // Generate a factory for transforming a chunk of CSS text to handle a\n  // particular scoped keyframes rule.\n  /**\n   * @param {StyleNode} keyframesRule\n   * @return {function(string):string}\n   */\n  _keyframesRuleTransformer(keyframesRule) {\n    return function (cssText) {\n      return cssText.replace(\n        /** @type {?} */ (keyframesRule.keyframesNameRx),\n        /** @type {?} */ (keyframesRule.transformedKeyframesName)\n      );\n    };\n  }\n\n  /**\n   * Transforms `@keyframes` names to be unique for the current host.\n   * Example: @keyframes foo-anim -> @keyframes foo-anim-x-foo-0\n   *\n   * @param {StyleNode} rule\n   * @param {string} scopeId\n   */\n  _scopeKeyframes(rule, scopeId) {\n    // Animation names are of the form [\\w-], so ensure that the name regex does not partially apply\n    // to similarly named keyframe names by checking for a word boundary at the beginning and\n    // a non-word boundary or `-` at the end.\n    rule.keyframesNameRx = new RegExp(\n      `\\\\b${rule['keyframesName']}(?!\\\\B|-)`,\n      'g'\n    );\n    rule.transformedKeyframesName = rule['keyframesName'] + '-' + scopeId;\n    rule.transformedSelector =\n      /** @type {?} */ (rule.transformedSelector) || rule['selector'];\n    rule['selector'] = /** @type {?} */ (rule.transformedSelector).replace(\n      rule['keyframesName'],\n      rule.transformedKeyframesName\n    );\n  }\n\n  // Strategy: x scope shim a selector e.g. to scope `.x-foo-42` (via classes):\n  // non-host selector: .a.x-foo -> .x-foo-42 .a.x-foo\n  // host selector: x-foo.wide -> .x-foo-42.wide\n  // note: we use only the scope class (.x-foo-42) and not the hostSelector\n  // (x-foo) to scope :host rules; this helps make property host rules\n  // have low specificity. They are overrideable by class selectors but,\n  // unfortunately, not by type selectors (e.g. overriding via\n  // `.special` is ok, but not by `x-foo`).\n  /**\n   * @param {StyleNode} rule\n   * @param {RegExp} hostRx\n   * @param {string} hostSelector\n   * @param {string} scopeId\n   */\n  _scopeSelector(rule, hostRx, hostSelector, scopeId) {\n    rule.transformedSelector =\n      /** @type {?} */ (rule.transformedSelector) || rule['selector'];\n    let selector = rule.transformedSelector;\n    let scope = '.' + scopeId;\n    let parts = StyleUtil.splitSelectorList(selector);\n    for (let i = 0, l = parts.length, p; i < l && (p = parts[i]); i++) {\n      parts[i] = p.match(hostRx)\n        ? p.replace(hostSelector, scope)\n        : scope + ' ' + p;\n    }\n    rule['selector'] = parts.join(',');\n  }\n\n  /**\n   * @param {Element} element\n   * @param {string} selector\n   * @param {string} old\n   */\n  applyElementScopeSelector(element, selector, old) {\n    let c = element.getAttribute('class') || '';\n    let v = c;\n    if (old) {\n      v = c.replace(\n        new RegExp('\\\\s*' + XSCOPE_NAME + '\\\\s*' + old + '\\\\s*', 'g'),\n        ' '\n      );\n    }\n    v += (v ? ' ' : '') + XSCOPE_NAME + ' ' + selector;\n    if (c !== v) {\n      StyleUtil.setElementClassRaw(element, v);\n    }\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object} properties\n   * @param {string} selector\n   * @param {HTMLStyleElement} style\n   * @return {HTMLStyleElement}\n   */\n  applyElementStyle(element, properties, selector, style) {\n    // calculate cssText to apply\n    let cssText = style\n      ? style.textContent || ''\n      : this.transformStyles(element, properties, selector);\n    // if shady and we have a cached style that is not style, decrement\n    let styleInfo = StyleInfo.get(element);\n    let s = styleInfo.customStyle;\n    if (s && !nativeShadow && s !== style) {\n      s['_useCount']--;\n      if (s['_useCount'] <= 0 && s.parentNode) {\n        s.parentNode.removeChild(s);\n      }\n    }\n    // apply styling always under native or if we generated style\n    // or the cached style is not in document(!)\n    if (nativeShadow) {\n      // update existing style only under native\n      if (styleInfo.customStyle) {\n        styleInfo.customStyle.textContent = cssText;\n        style = styleInfo.customStyle;\n        // otherwise, if we have css to apply, do so\n      } else if (cssText) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        style = StyleUtil.applyCss(\n          cssText,\n          selector,\n          element.shadowRoot,\n          styleInfo.placeholder\n        );\n      }\n    } else {\n      // shady and no cache hit\n      if (!style) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        if (cssText) {\n          style = StyleUtil.applyCss(\n            cssText,\n            selector,\n            null,\n            styleInfo.placeholder\n          );\n        }\n        // shady and cache hit but not in document\n      } else if (!style.parentNode) {\n        if (IS_IE && cssText.indexOf('@media') > -1) {\n          // @media rules may be stale in IE 10 and 11\n          // refresh the text content of the style to revalidate them.\n          style.textContent = cssText;\n        }\n        StyleUtil.applyStyle(style, null, styleInfo.placeholder);\n      }\n    }\n    // ensure this style is our custom style and increment its use count.\n    if (style) {\n      style['_useCount'] = style['_useCount'] || 0;\n      // increment use count if we changed styles\n      if (styleInfo.customStyle != style) {\n        style['_useCount']++;\n      }\n      styleInfo.customStyle = style;\n    }\n    return style;\n  }\n\n  /**\n   * @param {Element} style\n   * @param {Object} properties\n   */\n  applyCustomStyle(style, properties) {\n    let rules = StyleUtil.rulesForStyle(\n      /** @type {HTMLStyleElement} */ (style)\n    );\n    let self = this;\n    style.textContent = StyleUtil.toCssText(rules, function (\n      /** StyleNode */ rule\n    ) {\n      let css = (rule['cssText'] = rule['parsedCssText']);\n      if (\n        /** @type {?} */ (rule.propertyInfo) &&\n        /** @type {?} */ (rule.propertyInfo).cssText\n      ) {\n        // remove property assignments\n        // so next function isn't confused\n        // NOTE: we have 3 categories of css:\n        // (1) normal properties,\n        // (2) custom property assignments (--foo: red;),\n        // (3) custom property usage: border: var(--foo); @apply(--foo);\n        // In elements, 1 and 3 are separated for efficiency; here they\n        // are not and this makes this case unique.\n        css = removeCustomPropAssignment(/** @type {string} */ (css));\n        // replace with reified properties, scenario is same as mixin\n        rule['cssText'] = self.valueForProperties(css, properties);\n      }\n    });\n  }\n}\n\n/**\n * @param {number} n\n * @param {Array<number>} bits\n */\nfunction addToBitMask(n, bits) {\n  let o = parseInt(n / 32, 10);\n  let v = 1 << n % 32;\n  bits[o] = (bits[o] || 0) | v;\n}\n\nexport default new StyleProperties();\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nexport const nativeShadow = !(\n  window['ShadyDOM'] && window['ShadyDOM']['inUse']\n);\n/** @type {boolean} */\nlet nativeCssVariables_;\n\n/**\n * @param {(ShadyCSSOptions | ShadyCSSInterface)=} settings\n */\nfunction calcCssVariables(settings) {\n  if (settings && settings.shimcssproperties) {\n    nativeCssVariables_ = false;\n  } else {\n    // chrome 49 has semi-working css vars, check if box-shadow works\n    // safari 9.1 has a recalc bug: https://bugs.webkit.org/show_bug.cgi?id=155782\n    // However, shim css custom properties are only supported with ShadyDOM enabled,\n    // so fall back on native if we do not detect ShadyDOM\n    // Edge 15: custom properties used in ::before and ::after will also be used in the parent element\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12414257/\n    nativeCssVariables_ =\n      nativeShadow ||\n      Boolean(\n        !navigator.userAgent.match(/AppleWebKit\\/601|Edge\\/15/) &&\n          window.CSS &&\n          CSS.supports &&\n          CSS.supports('box-shadow', '0 0 0 var(--foo)')\n      );\n  }\n}\n\n/** @type {string | undefined} */\nexport let cssBuild;\nif (window.ShadyCSS && window.ShadyCSS.cssBuild !== undefined) {\n  cssBuild = window.ShadyCSS.cssBuild;\n}\n\n/** @type {boolean} */\nexport const disableRuntime = Boolean(\n  window.ShadyCSS && window.ShadyCSS.disableRuntime\n);\n\nif (window.ShadyCSS && window.ShadyCSS.nativeCss !== undefined) {\n  nativeCssVariables_ = window.ShadyCSS.nativeCss;\n} else if (window.ShadyCSS) {\n  calcCssVariables(window.ShadyCSS);\n  // reset window variable to let ShadyCSS API take its place\n  window.ShadyCSS = undefined;\n} else {\n  calcCssVariables(window['WebComponents'] && window['WebComponents']['flags']);\n}\n\n// Hack for type error under new type inference which doesn't like that\n// nativeCssVariables is updated in a function and assigns the type\n// `function(): ?` instead of `boolean`.\nexport const nativeCssVariables = /** @type {boolean} */ (nativeCssVariables_);\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport * as StyleUtil from './style-util.js';\nimport {nativeShadow} from './style-settings.js';\n\n/* Transforms ShadowDOM styling into ShadyDOM styling\n\n* scoping:\n\n  * elements in scope get scoping selector class=\"x-foo-scope\"\n  * selectors re-written as follows:\n\n    div button -> div.x-foo-scope button.x-foo-scope\n\n* :host -> scopeName\n\n* :host(...) -> scopeName...\n\n* ::slotted(...) -> scopeName > ...\n\n* ...:dir(ltr|rtl) -> [dir=\"ltr|rtl\"] ..., ...[dir=\"ltr|rtl\"]\n\n* :host(:dir[rtl]) -> scopeName:dir(rtl) -> [dir=\"rtl\"] scopeName, scopeName[dir=\"rtl\"]\n\n*/\nconst SCOPE_NAME = 'style-scope';\n\nclass StyleTransformer {\n  /** @return {string} */\n  get SCOPE_NAME() {\n    return SCOPE_NAME;\n  }\n  /**\n   * Given a node and scope name, add a scoping class to each node\n   * in the tree. This facilitates transforming css into scoped rules.\n   * @param {!Node} node\n   * @param {string} scope\n   * @param {boolean=} shouldRemoveScope\n   * @deprecated\n   */\n  dom(node, scope, shouldRemoveScope) {\n    const fn = (node) => {\n      this.element(node, scope || '', shouldRemoveScope);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * Given a node and scope name, add a scoping class to each node in the tree.\n   * @param {!Node} node\n   * @param {string} scope\n   */\n  domAddScope(node, scope) {\n    const fn = (node) => {\n      this.element(node, scope || '');\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {!Node} startNode\n   * @param {function(!Node)} transformer\n   */\n  _transformDom(startNode, transformer) {\n    if (startNode.nodeType === Node.ELEMENT_NODE) {\n      transformer(startNode);\n    }\n    let c$;\n    if (startNode.localName === 'template') {\n      const template = /** @type {!HTMLTemplateElement} */ (startNode);\n      // In case the template is in svg context, fall back to the node\n      // since it won't be an HTMLTemplateElement with a .content property\n      c$ = (template.content || template._content || template).childNodes;\n    } else {\n      c$ =\n        /** @type {!ParentNode} */ (startNode).children || startNode.childNodes;\n    }\n    if (c$) {\n      for (let i = 0; i < c$.length; i++) {\n        this._transformDom(c$[i], transformer);\n      }\n    }\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} scope\n   * @param {?=} shouldRemoveScope\n   */\n  element(element, scope, shouldRemoveScope) {\n    // note: if using classes, we add both the general 'style-scope' class\n    // as well as the specific scope. This enables easy filtering of all\n    // `style-scope` elements\n    if (scope) {\n      // note: svg on IE does not have classList so fallback to class\n      if (element.classList) {\n        if (shouldRemoveScope) {\n          element.classList.remove(SCOPE_NAME);\n          element.classList.remove(scope);\n        } else {\n          element.classList.add(SCOPE_NAME);\n          element.classList.add(scope);\n        }\n      } else if (element.getAttribute) {\n        let c = element.getAttribute(CLASS);\n        if (shouldRemoveScope) {\n          if (c) {\n            let newValue = c.replace(SCOPE_NAME, '').replace(scope, '');\n            StyleUtil.setElementClassRaw(element, newValue);\n          }\n        } else {\n          let newValue = (c ? c + ' ' : '') + SCOPE_NAME + ' ' + scope;\n          StyleUtil.setElementClassRaw(element, newValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Given a node, replace the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   * @param {string} newScope\n   */\n  domReplaceScope(node, oldScope, newScope) {\n    const fn = (node) => {\n      this.element(node, oldScope, true);\n      this.element(node, newScope);\n    };\n    this._transformDom(node, fn);\n  }\n  /**\n   * Given a node, remove the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   */\n  domRemoveScope(node, oldScope) {\n    const fn = (node) => {\n      this.element(node, oldScope || '', true);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} styleRules\n   * @param {?=} callback\n   * @param {string=} cssBuild\n   * @param {string=} cssText\n   * @return {string}\n   */\n  elementStyles(element, styleRules, callback, cssBuild = '', cssText = '') {\n    // no need to shim selectors if settings.useNativeShadow, also\n    // a shady css build will already have transformed selectors\n    // NOTE: This method may be called as part of static or property shimming.\n    // When there is a targeted build it will not be called for static shimming,\n    // but when the property shim is used it is called and should opt out of\n    // static shimming work when a proper build exists.\n    if (cssText === '') {\n      if (nativeShadow || cssBuild === 'shady') {\n        cssText = StyleUtil.toCssText(styleRules, callback);\n      } else {\n        let {is, typeExtension} = StyleUtil.getIsExtends(element);\n        cssText = this.css(styleRules, is, typeExtension, callback) + '\\n\\n';\n      }\n    }\n    return cssText.trim();\n  }\n\n  // Given a string of cssText and a scoping string (scope), returns\n  // a string of scoped css where each selector is transformed to include\n  // a class created from the scope. ShadowDOM selectors are also transformed\n  // (e.g. :host) to use the scoping selector.\n  css(rules, scope, ext, callback) {\n    let hostScope = this._calcHostScope(scope, ext);\n    scope = this._calcElementScope(scope);\n    let self = this;\n    return StyleUtil.toCssText(rules, function (/** StyleNode */ rule) {\n      if (!(/** @type {?} */ (rule.isScoped))) {\n        self.rule(rule, scope, hostScope);\n        rule.isScoped = true;\n      }\n      if (callback) {\n        callback(rule, scope, hostScope);\n      }\n    });\n  }\n\n  _calcElementScope(scope) {\n    if (scope) {\n      return CSS_CLASS_PREFIX + scope;\n    } else {\n      return '';\n    }\n  }\n\n  _calcHostScope(scope, ext) {\n    return ext ? `[is=${scope}]` : scope;\n  }\n\n  rule(rule, scope, hostScope) {\n    this._transformRule(rule, this._transformComplexSelector, scope, hostScope);\n  }\n\n  /**\n   * transforms a css rule to a scoped rule.\n   *\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRule(rule, transformer, scope, hostScope) {\n    // NOTE: save transformedSelector for subsequent matching of elements\n    // against selectors (e.g. when calculating style properties)\n    rule[\n      'selector'\n    ] = /** @type {?} */ (rule).transformedSelector = this._transformRuleCss(\n      rule,\n      transformer,\n      scope,\n      hostScope\n    );\n  }\n\n  /**\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRuleCss(rule, transformer, scope, hostScope) {\n    let p$ = StyleUtil.splitSelectorList(rule['selector']);\n    // we want to skip transformation of rules that appear in keyframes,\n    // because they are keyframe selectors, not element selectors.\n    if (!StyleUtil.isKeyframesSelector(rule)) {\n      for (let i = 0, l = p$.length, p; i < l && (p = p$[i]); i++) {\n        p$[i] = transformer.call(this, p, scope, hostScope);\n      }\n    }\n    return p$.filter((part) => Boolean(part)).join(COMPLEX_SELECTOR_SEP);\n  }\n\n  /**\n   * @param {string} selector\n   * @return {string}\n   */\n  _twiddleNthPlus(selector) {\n    return selector.replace(NTH, (m, type, inside) => {\n      if (inside.indexOf('+') > -1) {\n        inside = inside.replace(/\\+/g, '___');\n      } else if (inside.indexOf('___') > -1) {\n        inside = inside.replace(/___/g, '+');\n      }\n      return `:${type}(${inside})`;\n    });\n  }\n\n  /**\n   * Preserve `:matches()` selectors by replacing them with MATCHES_REPLACMENT\n   * and returning an array of `:matches()` selectors.\n   * Use `_replacesMatchesPseudo` to replace the `:matches()` parts\n   *\n   * @param {string} selector\n   * @return {{selector: string, matches: !Array<string>}}\n   */\n  _preserveMatchesPseudo(selector) {\n    /** @type {!Array<string>} */\n    const matches = [];\n    let match;\n    while ((match = selector.match(MATCHES))) {\n      const start = match.index;\n      const end = StyleUtil.findMatchingParen(selector, start);\n      if (end === -1) {\n        throw new Error(`${match.input} selector missing ')'`);\n      }\n      const part = selector.slice(start, end + 1);\n      selector = selector.replace(part, MATCHES_REPLACEMENT);\n      matches.push(part);\n    }\n    return {selector, matches};\n  }\n\n  /**\n   * Replace MATCHES_REPLACMENT character with the given set of `:matches()`\n   * selectors.\n   *\n   * @param {string} selector\n   * @param {!Array<string>} matches\n   * @return {string}\n   */\n  _replaceMatchesPseudo(selector, matches) {\n    const parts = selector.split(MATCHES_REPLACEMENT);\n    return matches.reduce(\n      (acc, cur, idx) => acc + cur + parts[idx + 1],\n      parts[0]\n    );\n  }\n\n  /**\n   * @param {string} selector\n   * @param {string} scope\n   * @param {string=} hostScope\n   */\n  _transformComplexSelector(selector, scope, hostScope) {\n    let stop = false;\n    selector = selector.trim();\n    // Remove spaces inside of selectors like `:nth-of-type` because it confuses SIMPLE_SELECTOR_SEP\n    let isNth = NTH.test(selector);\n    if (isNth) {\n      selector = selector.replace(\n        NTH,\n        (m, type, inner) => `:${type}(${inner.replace(/\\s/g, '')})`\n      );\n      selector = this._twiddleNthPlus(selector);\n    }\n    // Preserve selectors like `:-webkit-any` so that SIMPLE_SELECTOR_SEP does\n    // not get confused by spaces inside the pseudo selector\n    const isMatches = MATCHES.test(selector);\n    /** @type {!Array<string>} */\n    let matches;\n    if (isMatches) {\n      ({selector, matches} = this._preserveMatchesPseudo(selector));\n    }\n    selector = selector.replace(SLOTTED_START, `${HOST} $1`);\n    selector = selector.replace(SIMPLE_SELECTOR_SEP, (m, c, s) => {\n      if (!stop) {\n        let info = this._transformCompoundSelector(s, c, scope, hostScope);\n        stop = stop || info.stop;\n        c = info.combinator;\n        s = info.value;\n      }\n      return c + s;\n    });\n    // replace `:matches()` selectors\n    if (isMatches) {\n      selector = this._replaceMatchesPseudo(selector, matches);\n    }\n    if (isNth) {\n      selector = this._twiddleNthPlus(selector);\n    }\n    selector = selector.replace(\n      DIR_PAREN,\n      (m, before, dir, after) =>\n        `[dir=\"${dir}\"] ${before}${after}, ${before}[dir=\"${dir}\"]${after}`\n    );\n    return selector;\n  }\n\n  _transformCompoundSelector(selector, combinator, scope, hostScope) {\n    // replace :host with host scoping class\n    let slottedIndex = selector.indexOf(SLOTTED);\n    if (selector.indexOf(HOST) >= 0) {\n      selector = this._transformHostSelector(selector, hostScope);\n      // replace other selectors with scoping class\n    } else if (slottedIndex !== 0) {\n      selector = scope\n        ? this._transformSimpleSelector(selector, scope)\n        : selector;\n    }\n    // mark ::slotted() scope jump to replace with descendant selector + arg\n    // also ignore left-side combinator\n    let slotted = false;\n    if (slottedIndex >= 0) {\n      combinator = '';\n      slotted = true;\n    }\n    // process scope jumping selectors up to the scope jump and then stop\n    let stop;\n    if (slotted) {\n      stop = true;\n      if (slotted) {\n        // .zonk ::slotted(.foo) -> .zonk.scope > .foo\n        selector = selector.replace(SLOTTED_PAREN, (m, paren) => ` > ${paren}`);\n      }\n    }\n    return {value: selector, combinator, stop};\n  }\n\n  _transformSimpleSelector(selector, scope) {\n    const attributes = selector.split(/(\\[.+?\\])/);\n\n    const output = [];\n    for (let i = 0; i < attributes.length; i++) {\n      // Do not attempt to transform any attribute selector content\n      if (i % 2 === 1) {\n        output.push(attributes[i]);\n      } else {\n        const part = attributes[i];\n\n        if (!(part === '' && i === attributes.length - 1)) {\n          let p$ = part.split(PSEUDO_PREFIX);\n          p$[0] += scope;\n          output.push(p$.join(PSEUDO_PREFIX));\n        }\n      }\n    }\n\n    return output.join('');\n  }\n\n  // :host(...) -> scopeName...\n  _transformHostSelector(selector, hostScope) {\n    let m = selector.match(HOST_PAREN);\n    let paren = (m && m[2].trim()) || '';\n    if (paren) {\n      if (!paren[0].match(SIMPLE_SELECTOR_PREFIX)) {\n        // paren starts with a type selector\n        let typeSelector = paren.split(SIMPLE_SELECTOR_PREFIX)[0];\n        // if the type selector is our hostScope then avoid pre-pending it\n        if (typeSelector === hostScope) {\n          return paren;\n        }\n        // otherwise, this selector should not match in this scope so\n        // output a bogus selector.\n        else {\n          return SELECTOR_NO_MATCH;\n        }\n      } else {\n        // make sure to do a replace here to catch selectors like:\n        // `:host(.foo)::before`\n        return selector.replace(HOST_PAREN, function (m, host, paren) {\n          return hostScope + paren;\n        });\n      }\n    }\n    // if no paren, do a straight :host replacement.\n    // TODO(sorvell): this should not strictly be necessary but\n    // it's needed to maintain support for `:host[foo]` type selectors\n    // which have been improperly used under Shady DOM. This should be\n    // deprecated.\n    else {\n      return selector.replace(HOST, hostScope);\n    }\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  documentRule(rule) {\n    // reset selector in case this is redone.\n    rule['selector'] = rule['parsedSelector'];\n    this.normalizeRootSelector(rule);\n    this._transformRule(rule, this._transformDocumentSelector);\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  normalizeRootSelector(rule) {\n    if (rule['selector'] === ROOT) {\n      rule['selector'] = 'html';\n    }\n  }\n\n  /**\n   * @param {string} selector\n   */\n  _transformDocumentSelector(selector) {\n    if (selector.match(HOST)) {\n      // remove ':host' type selectors in document rules\n      return '';\n    } else if (selector.match(SLOTTED)) {\n      return this._transformComplexSelector(selector, SCOPE_DOC_SELECTOR);\n    } else {\n      return this._transformSimpleSelector(selector.trim(), SCOPE_DOC_SELECTOR);\n    }\n  }\n}\n\nconst NTH = /:(nth[-\\w]+)\\(([^)]+)\\)/;\nconst SCOPE_DOC_SELECTOR = `:not(.${SCOPE_NAME})`;\nconst COMPLEX_SELECTOR_SEP = ',';\nconst SIMPLE_SELECTOR_SEP = /(^|[\\s>+~]+)((?:\\[.+?\\]|[^\\s>+~=[])+)/g;\nconst SIMPLE_SELECTOR_PREFIX = /[[.:#*]/;\nconst HOST = ':host';\nconst ROOT = ':root';\nconst SLOTTED = '::slotted';\nconst SLOTTED_START = new RegExp(`^(${SLOTTED})`);\n// NOTE: this supports 1 nested () pair for things like\n// :host(:not([selected]), more general support requires\n// parsing which seems like overkill\nconst HOST_PAREN = /(:host)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\n// similar to HOST_PAREN\nconst SLOTTED_PAREN = /(?:::slotted)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\nconst DIR_PAREN = /(.*):dir\\((?:(ltr|rtl))\\)(.*)/;\nconst CSS_CLASS_PREFIX = '.';\nconst PSEUDO_PREFIX = ':';\nconst CLASS = 'class';\nconst SELECTOR_NO_MATCH = 'should_not_match';\nconst MATCHES = /:(?:matches|any|-(?:webkit|moz)-any)/;\nconst MATCHES_REPLACEMENT = '\\u{e000}';\n\nexport default new StyleTransformer();\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow, nativeCssVariables, cssBuild} from './style-settings.js';\nimport {parse, stringify, types, StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport {MEDIA_MATCH} from './common-regex.js';\n// prettier-ignore\nimport {processUnscopedStyle, isUnscopedStyle} from './unscoped-style-handler.js';\n\n/**\n * @param {string|StyleNode} rules\n * @param {function(StyleNode)=} callback\n * @return {string}\n */\nexport function toCssText(rules, callback) {\n  if (!rules) {\n    return '';\n  }\n  if (typeof rules === 'string') {\n    rules = parse(rules);\n  }\n  if (callback) {\n    forEachRule(rules, callback);\n  }\n  return stringify(rules, nativeCssVariables);\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @return {StyleNode}\n */\nexport function rulesForStyle(style) {\n  if (!style['__cssRules'] && style.textContent) {\n    style['__cssRules'] = parse(style.textContent);\n  }\n  return style['__cssRules'] || null;\n}\n\n// Tests if a rule is a keyframes selector, which looks almost exactly\n// like a normal selector but is not (it has nothing to do with scoping\n// for example).\n/**\n * @param {StyleNode} rule\n * @return {boolean}\n */\nexport function isKeyframesSelector(rule) {\n  return (\n    Boolean(rule['parent']) && rule['parent']['type'] === types.KEYFRAMES_RULE\n  );\n}\n\n/**\n * @param {StyleNode} node\n * @param {Function=} styleRuleCallback\n * @param {Function=} keyframesRuleCallback\n * @param {boolean=} onlyActiveRules\n */\nexport function forEachRule(\n  node,\n  styleRuleCallback,\n  keyframesRuleCallback,\n  onlyActiveRules\n) {\n  if (!node) {\n    return;\n  }\n  let skipRules = false;\n  let type = node['type'];\n  if (onlyActiveRules) {\n    if (type === types.MEDIA_RULE) {\n      let matchMedia = node['selector'].match(MEDIA_MATCH);\n      if (matchMedia) {\n        // if rule is a non matching @media rule, skip subrules\n        if (!window.matchMedia(matchMedia[1]).matches) {\n          skipRules = true;\n        }\n      }\n    }\n  }\n  if (type === types.STYLE_RULE) {\n    styleRuleCallback(node);\n  } else if (keyframesRuleCallback && type === types.KEYFRAMES_RULE) {\n    keyframesRuleCallback(node);\n  } else if (type === types.MIXIN_RULE) {\n    skipRules = true;\n  }\n  let r$ = node['rules'];\n  if (r$ && !skipRules) {\n    for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n      forEachRule(r, styleRuleCallback, keyframesRuleCallback, onlyActiveRules);\n    }\n  }\n}\n\n// add a string of cssText to the document.\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @param {Node} target\n * @param {Node} contextNode\n * @return {HTMLStyleElement}\n */\nexport function applyCss(cssText, moniker, target, contextNode) {\n  let style = createScopeStyle(cssText, moniker);\n  applyStyle(style, target, contextNode);\n  return style;\n}\n\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @return {!HTMLStyleElement}\n */\nexport function createScopeStyle(cssText, moniker) {\n  let style = /** @type {HTMLStyleElement} */ (document.createElement('style'));\n  if (moniker) {\n    style.setAttribute('scope', moniker);\n  }\n  style.textContent = cssText;\n  return style;\n}\n\n/**\n * Track the position of the last added style for placing placeholders\n * @type {Node}\n */\nlet lastHeadApplyNode = null;\n\n// insert a comment node as a styling position placeholder.\n/**\n * @param {string} moniker\n * @return {!Comment}\n */\nexport function applyStylePlaceHolder(moniker) {\n  let placeHolder = document.createComment(\n    ' Shady DOM styles for ' + moniker + ' '\n  );\n  let after = lastHeadApplyNode ? lastHeadApplyNode['nextSibling'] : null;\n  let scope = document.head;\n  scope.insertBefore(placeHolder, after || scope.firstChild);\n  lastHeadApplyNode = placeHolder;\n  return placeHolder;\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @param {?Node} target\n * @param {?Node} contextNode\n */\nexport function applyStyle(style, target, contextNode) {\n  target = target || document.head;\n  let after = (contextNode && contextNode.nextSibling) || target.firstChild;\n  target.insertBefore(style, after);\n  if (!lastHeadApplyNode) {\n    lastHeadApplyNode = style;\n  } else {\n    // only update lastHeadApplyNode if the new style is inserted after the old lastHeadApplyNode\n    let position = style.compareDocumentPosition(lastHeadApplyNode);\n    if (position === Node.DOCUMENT_POSITION_PRECEDING) {\n      lastHeadApplyNode = style;\n    }\n  }\n}\n\n/**\n * @param {string} buildType\n * @return {boolean}\n */\nexport function isTargetedBuild(buildType) {\n  return nativeShadow ? buildType === 'shadow' : buildType === 'shady';\n}\n\n/**\n * Walk from text[start] matching parens and\n * returns position of the outer end paren\n * @param {string} text\n * @param {number} start\n * @return {number}\n */\nexport function findMatchingParen(text, start) {\n  let level = 0;\n  for (let i = start, l = text.length; i < l; i++) {\n    if (text[i] === '(') {\n      level++;\n    } else if (text[i] === ')') {\n      if (--level === 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * @param {string} str\n * @param {function(string, string, string, string)} callback\n */\nexport function processVariableAndFallback(str, callback) {\n  // find 'var('\n  let start = str.indexOf('var(');\n  if (start === -1) {\n    // no var?, everything is prefix\n    return callback(str, '', '', '');\n  }\n  //${prefix}var(${inner})${suffix}\n  let end = findMatchingParen(str, start + 3);\n  let inner = str.substring(start + 4, end);\n  let prefix = str.substring(0, start);\n  // suffix may have other variables\n  let suffix = processVariableAndFallback(str.substring(end + 1), callback);\n  let comma = inner.indexOf(',');\n  // value and fallback args should be trimmed to match in property lookup\n  if (comma === -1) {\n    // variable, no fallback\n    return callback(prefix, inner.trim(), '', suffix);\n  }\n  // var(${value},${fallback})\n  let value = inner.substring(0, comma).trim();\n  let fallback = inner.substring(comma + 1).trim();\n  return callback(prefix, value, fallback, suffix);\n}\n\n/**\n * @param {Element} element\n * @param {string} value\n */\nexport function setElementClassRaw(element, value) {\n  // use native setAttribute provided by ShadyDOM when setAttribute is patched\n  if (nativeShadow) {\n    element.setAttribute('class', value);\n  } else {\n    window['ShadyDOM']['nativeMethods']['setAttribute'].call(\n      element,\n      'class',\n      value\n    );\n  }\n}\n\n/**\n * @type {function(*):*}\n */\nexport const wrap =\n  (window['ShadyDOM'] && window['ShadyDOM']['wrap']) || ((node) => node);\n\n/**\n * @param {Element | {is: string, extends: string}} element\n * @return {{is: string, typeExtension: string}}\n */\nexport function getIsExtends(element) {\n  let localName = element['localName'];\n  let is = '',\n    typeExtension = '';\n  /*\n  NOTE: technically, this can be wrong for certain svg elements\n  with `-` in the name like `<font-face>`\n  */\n  if (localName) {\n    if (localName.indexOf('-') > -1) {\n      is = localName;\n    } else {\n      typeExtension = localName;\n      is = (element.getAttribute && element.getAttribute('is')) || '';\n    }\n  } else {\n    is = /** @type {?} */ (element).is;\n    typeExtension = /** @type {?} */ (element).extends;\n  }\n  return {is, typeExtension};\n}\n\n/**\n * @param {Element|DocumentFragment} element\n * @return {string}\n */\nexport function gatherStyleText(element) {\n  /** @type {!Array<string>} */\n  const styleTextParts = [];\n  const styles = /** @type {!NodeList<!HTMLStyleElement>} */ (element.querySelectorAll(\n    'style'\n  ));\n  for (let i = 0; i < styles.length; i++) {\n    const style = styles[i];\n    if (isUnscopedStyle(style)) {\n      if (!nativeShadow) {\n        processUnscopedStyle(style);\n        style.parentNode.removeChild(style);\n      }\n    } else {\n      styleTextParts.push(style.textContent);\n      style.parentNode.removeChild(style);\n    }\n  }\n  return styleTextParts.join('').trim();\n}\n\n/**\n * Split a selector separated by commas into an array in a smart way\n * @param {string} selector\n * @return {!Array<string>}\n */\nexport function splitSelectorList(selector) {\n  const parts = [];\n  let part = '';\n  for (let i = 0; i >= 0 && i < selector.length; i++) {\n    // A selector with parentheses will be one complete part\n    if (selector[i] === '(') {\n      // find the matching paren\n      const end = findMatchingParen(selector, i);\n      // push the paren block into the part\n      part += selector.slice(i, end + 1);\n      // move the index to after the paren block\n      i = end;\n    } else if (selector[i] === ',') {\n      parts.push(part);\n      part = '';\n    } else {\n      part += selector[i];\n    }\n  }\n  // catch any pieces after the last comma\n  if (part) {\n    parts.push(part);\n  }\n  return parts;\n}\n\nconst CSS_BUILD_ATTR = 'css-build';\n\n/**\n * Return the polymer-css-build \"build type\" applied to this element\n *\n * @param {!HTMLElement} element\n * @return {string} Can be \"\", \"shady\", or \"shadow\"\n */\nexport function getCssBuild(element) {\n  if (cssBuild !== undefined) {\n    return /** @type {string} */ (cssBuild);\n  }\n  if (element.__cssBuild === undefined) {\n    // try attribute first, as it is the common case\n    const attrValue = element.getAttribute(CSS_BUILD_ATTR);\n    if (attrValue) {\n      element.__cssBuild = attrValue;\n    } else {\n      const buildComment = getBuildComment(element);\n      if (buildComment !== '') {\n        // remove build comment so it is not needlessly copied into every element instance\n        removeBuildComment(element);\n      }\n      element.__cssBuild = buildComment;\n    }\n  }\n  return element.__cssBuild || '';\n}\n\n/**\n * Check if the given element, either a <template> or <style>, has been processed\n * by polymer-css-build.\n *\n * If so, then we can make a number of optimizations:\n * - polymer-css-build will decompose mixins into individual CSS Custom Properties,\n * so the ApplyShim can be skipped entirely.\n * - Under native ShadowDOM, the style text can just be copied into each instance\n * without modification\n * - If the build is \"shady\" and ShadyDOM is in use, the styling does not need\n * scoping beyond the shimming of CSS Custom Properties\n *\n * @param {!HTMLElement} element\n * @return {boolean}\n */\nexport function elementHasBuiltCss(element) {\n  return getCssBuild(element) !== '';\n}\n\n/**\n * For templates made with tagged template literals, polymer-css-build will\n * insert a comment of the form `<!--css-build:shadow-->`\n *\n * @param {!HTMLElement} element\n * @return {string}\n */\nexport function getBuildComment(element) {\n  const buildComment =\n    element.localName === 'template'\n      ? /** @type {!HTMLTemplateElement} */ (element).content.firstChild\n      : element.firstChild;\n  if (buildComment instanceof Comment) {\n    const commentParts = buildComment.textContent.trim().split(':');\n    if (commentParts[0] === CSS_BUILD_ATTR) {\n      return commentParts[1];\n    }\n  }\n  return '';\n}\n\n/**\n * Check if the css build status is optimal, and do no unneeded work.\n *\n * @param {string=} cssBuild CSS build status\n * @return {boolean} css build is optimal or not\n */\nexport function isOptimalCssBuild(cssBuild = '') {\n  // CSS custom property shim always requires work\n  if (cssBuild === '' || !nativeCssVariables) {\n    return false;\n  }\n  return nativeShadow ? cssBuild === 'shadow' : cssBuild === 'shady';\n}\n\n/**\n * @param {!HTMLElement} element\n */\nfunction removeBuildComment(element) {\n  const buildComment =\n    element.localName === 'template'\n      ? /** @type {!HTMLTemplateElement} */ (element).content.firstChild\n      : element.firstChild;\n  buildComment.parentNode.removeChild(buildComment);\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/**\n * @const {!Object<string, !HTMLTemplateElement>}\n */\nconst templateMap = {};\nexport default templateMap;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {!Set<string>} */\nconst styleTextSet = new Set();\n\nexport const scopingAttribute = 'shady-unscoped';\n\n/**\n * Add a specifically-marked style to the document directly, and only one copy of that style.\n *\n * @param {!HTMLStyleElement} style\n * @return {undefined}\n */\nexport function processUnscopedStyle(style) {\n  const text = style.textContent;\n  if (!styleTextSet.has(text)) {\n    styleTextSet.add(text);\n    const newStyle = document.createElement('style');\n    newStyle.setAttribute('shady-unscoped', '');\n    newStyle.textContent = text;\n    document.head.appendChild(newStyle);\n  }\n}\n\n/**\n * Check if a style is supposed to be unscoped\n * @param {!HTMLStyleElement} style\n * @return {boolean} true if the style has the unscoping attribute\n */\nexport function isUnscopedStyle(style) {\n  return style.hasAttribute(scopingAttribute);\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport class ShadyData {\n  /** @override */\n  toJSON() {\n    return {};\n  }\n}\n\nexport function ensureShadyDataForNode(node) {\n  if (!node.__shady) {\n    node.__shady = new ShadyData();\n  }\n  return node.__shady;\n}\n\nexport function shadyDataForNode(node) {\n  return node && node.__shady;\n}\n",null,null,null,null,null,"/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport {shadyDataForNode} from './shady-data.js';\n\n/** @type {!Object} */\nexport const settings = window['ShadyDOM'] || {};\n\nsettings.hasNativeShadowDOM = Boolean(\n  Element.prototype.attachShadow && Node.prototype.getRootNode\n);\n\n// The user might need to pass the custom elements polyfill a flag by setting an\n// object to `customElements`, so check for `customElements.define` also.\nexport const hasCustomElements = () =>\n  Boolean(window.customElements && window.customElements.define);\n// The custom elements polyfill is typically loaded after Shady DOM, so this\n// check isn't reliable during initial evaluation. However, because the\n// polyfills are loaded immediately after one another, it works at runtime.\nexport const hasPolyfilledCustomElements = () =>\n  Boolean(\n    window.customElements && window.customElements['polyfillWrapFlushCallback']\n  );\n\nconst desc = Object.getOwnPropertyDescriptor(Node.prototype, 'firstChild');\n\nsettings.hasDescriptors = Boolean(desc && desc.configurable && desc.get);\nsettings.inUse = settings['force'] || !settings.hasNativeShadowDOM;\nsettings.noPatch = /** @type {string|boolean} */ (settings['noPatch'] || false);\n// eslint-disable-next-line no-self-assign\nsettings.preferPerformance = settings['preferPerformance'];\nsettings.patchOnDemand = settings.noPatch === 'on-demand';\nsettings.querySelectorImplementation = (() => {\n  const acceptedValues = ['native', 'selectorEngine'];\n  const userValue = settings['querySelectorImplementation'];\n  if (acceptedValues.indexOf(userValue) > -1) {\n    return userValue;\n  }\n  return undefined;\n})();\n\nconst IS_IE = navigator.userAgent.match('Trident');\nsettings.IS_IE = IS_IE;\n\n// Helper for prefixed properties.\nexport const getPropertyName = (obj, name) => {\n  const prefixed = `ms${name[0].toUpperCase() + name.slice(1)}`;\n  return obj[prefixed] ? prefixed : name;\n};\n\nexport const canUpgrade = () => !settings.IS_IE;\n\nexport const isTrackingLogicalChildNodes = (node) => {\n  const nodeData = shadyDataForNode(node);\n  return nodeData && nodeData.firstChild !== undefined;\n};\n\nexport const isShadyRoot = (obj) => obj instanceof ShadowRoot;\n\nexport const hasShadowRootWithSlot = (node) => {\n  const nodeData = shadyDataForNode(node);\n  let root = nodeData && nodeData.root;\n  return root && root._hasInsertionPoint();\n};\n\nlet p = Element.prototype;\nlet matches =\n  p.matches ||\n  p.matchesSelector ||\n  p.mozMatchesSelector ||\n  p.msMatchesSelector ||\n  p.oMatchesSelector ||\n  p.webkitMatchesSelector;\n\nexport const matchesSelector = (element, selector) => {\n  return matches.call(element, selector);\n};\n\nexport const mixin = (target, source) => {\n  for (var i in source) {\n    target[i] = source[i];\n  }\n  return target;\n};\n\n// NOTE, prefer MutationObserver over Promise for microtask timing\n// for consistency x-platform.\nlet twiddle = document.createTextNode('');\nlet content = 0;\nlet queue = [];\nnew MutationObserver(() => {\n  while (queue.length) {\n    // catch errors in user code...\n    try {\n      queue.shift()();\n    } catch (e) {\n      // enqueue another record and throw\n      twiddle.textContent = content++;\n      throw e;\n    }\n  }\n}).observe(twiddle, {characterData: true});\n\n// use MutationObserver to get microtask async timing.\nexport const microtask = (callback) => {\n  queue.push(callback);\n  twiddle.textContent = content++;\n};\n\n/** @type {function(!Document, !Node): boolean} */\nexport const documentContains = (() => {\n  if (document.contains) {\n    return (doc, node) => doc[NATIVE_PREFIX + 'contains'](node);\n  } else {\n    return (doc, node) =>\n      doc === node ||\n      (doc.documentElement &&\n        doc.documentElement[NATIVE_PREFIX + 'contains'](node));\n  }\n})();\n\nexport const contains = (container, node) => {\n  while (node) {\n    if (node == container) {\n      return true;\n    }\n    node = node[SHADY_PREFIX + 'parentNode'];\n  }\n  return false;\n};\n\nconst getNodeHTMLCollectionName = (node) =>\n  node.getAttribute('id') || node.getAttribute('name');\n\nconst isValidHTMLCollectionName = (name) => name !== 'length' && isNaN(name);\n\nexport const createPolyfilledHTMLCollection = (nodes) => {\n  // Note: loop in reverse so that the first named item matches the named property\n  for (let l = nodes.length - 1; l >= 0; l--) {\n    const node = nodes[l];\n    const name = getNodeHTMLCollectionName(node);\n\n    if (name && isValidHTMLCollectionName(name)) {\n      nodes[name] = node;\n    }\n  }\n  nodes.item = function (index) {\n    return nodes[index];\n  };\n  nodes.namedItem = function (name) {\n    if (isValidHTMLCollectionName(name) && nodes[name]) {\n      return nodes[name];\n    }\n\n    for (const node of nodes) {\n      const nodeName = getNodeHTMLCollectionName(node);\n\n      if (nodeName == name) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n  return nodes;\n};\n\nexport const NATIVE_PREFIX = '__shady_native_';\nexport const SHADY_PREFIX = '__shady_';\n\nexport const nativeChildNodesArray = (parent) => {\n  const result = [];\n  for (\n    let n = parent[NATIVE_PREFIX + 'firstChild'];\n    n;\n    n = n[NATIVE_PREFIX + 'nextSibling']\n  ) {\n    result.push(n);\n  }\n  return result;\n};\n\nexport const childNodesArray = (parent) => {\n  const result = [];\n  for (\n    let n = parent[SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[SHADY_PREFIX + 'nextSibling']\n  ) {\n    result.push(n);\n  }\n  return result;\n};\n\nconst patchProperty = (proto, name, descriptor) => {\n  descriptor.configurable = true;\n  // NOTE: we prefer writing directly because some browsers\n  // have descriptors that are writable but not configurable (e.g.\n  // `appendChild` on older browsers)\n  if (descriptor.value) {\n    proto[name] = descriptor.value;\n  } else {\n    try {\n      Object.defineProperty(proto, name, descriptor);\n    } catch (e) {\n      // this error is harmless so we just trap it.\n    }\n  }\n};\n\n/**\n * Patch a group of accessors on an object. By default this overrides\n * @param {!Object} proto\n * @param {!Object} descriptors\n * @param {string=} prefix\n * @param {Array=} disallowedPatches\n */\nexport const patchProperties = (\n  proto,\n  descriptors,\n  prefix = '',\n  disallowedPatches\n) => {\n  for (let name in descriptors) {\n    if (disallowedPatches && disallowedPatches.indexOf(name) >= 0) {\n      continue;\n    }\n    patchProperty(proto, prefix + name, descriptors[name]);\n  }\n};\n\nexport const patchExistingProperties = (proto, descriptors) => {\n  for (let name in descriptors) {\n    if (name in proto) {\n      patchProperty(proto, name, descriptors[name]);\n    }\n  }\n};\n\n// note, this is not a perfect polyfill since it doesn't include symbols\n/** @return {!Object<!ObjectPropertyDescriptor>} */\nexport const getOwnPropertyDescriptors = (obj) => {\n  const descriptors = {};\n  Object.getOwnPropertyNames(obj).forEach((name) => {\n    descriptors[name] = Object.getOwnPropertyDescriptor(obj, name);\n  });\n  return descriptors;\n};\n\nexport const assign = (target, source) => {\n  const names = Object.getOwnPropertyNames(source);\n  for (let i = 0, p; i < names.length; i++) {\n    p = names[i];\n    target[p] = source[p];\n  }\n};\n\nexport const arrayFrom = (object) => {\n  return [].slice.call(/** @type {IArrayLike} */ (object));\n};\n\n/**\n * Converts a single value to a node for `convertNodesIntoANode`.\n *\n * @param {*} arg\n * @return {!Node}\n */\nconst convertIntoANode = (arg) => {\n  // `\"\" + arg` is used to implicitly coerce the value to a string (coercing a\n  // symbol *should* fail here) before passing to `createTextNode`, which has\n  // argument type `(number|string)`.\n  return !(arg instanceof Node) ? document.createTextNode('' + arg) : arg;\n};\n\n/**\n * Implements 'convert nodes into a node'. The spec text indicates that strings\n * become text nodes, but doesn't describe what should happen if a non-Node,\n * non-string value is found in the arguments list. In practice, browsers coerce\n * these values to strings and convert those to text nodes.\n * https://dom.spec.whatwg.org/#converting-nodes-into-a-node\n *\n * @param {...*} args\n * @return {!Node}\n */\nexport const convertNodesIntoANode = (...args) => {\n  if (args.length === 1) {\n    return convertIntoANode(args[0]);\n  }\n\n  const fragment = document.createDocumentFragment();\n  for (const arg of args) {\n    fragment.appendChild(convertIntoANode(arg));\n  }\n  return fragment;\n};\n\n/**\n * Equivalent to `Array.prototype.flat`. Closure does not compile out this\n * function, so we need an implementation for browsers that don't natively\n * support it.\n *\n * @template T\n * @param {!Array<!T | !Array<!T>>} array\n * @param {number} depth\n * @return {!Array<!T>}\n */\nexport const flat = (array, depth = 1) => {\n  for (; depth > 0; depth--) {\n    array = array.reduce((acc, item) => {\n      if (Array.isArray(item)) {\n        acc.push(...item);\n      } else {\n        acc.push(item);\n      }\n      return acc;\n    }, []);\n  }\n\n  return array;\n};\n\n/**\n * Deduplicates items in an array.\n *\n * This function could normally be implemented as merely `Array.from(new\n * Set(...))`. However, in IE 11, `Set` does not support being constructed with\n * an iterable. Further, some polyfills for `Array.from` effectively default to\n * `Array.prototype.slice.call(...)` when they are unable to find\n * `[Symbol.iterator]`; this is incompatible with `Set` which has no `length` or\n * indexable properties.\n *\n * @template T\n * @param {!Array<!T>} array\n * @return {!Array<!T>}\n */\nexport const deduplicate = (array) => {\n  const results = [];\n  const set = new Set();\n  for (const item of array) {\n    if (!set.has(item)) {\n      results.push(item);\n      set.add(item);\n    }\n  }\n  return results;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from './utils.js';\nimport {patchProperties} from './utils.js';\nimport {getInnerHTML} from './innerHTML.js';\n\nconst hasDescriptors = utils.settings.hasDescriptors;\nexport const NATIVE_PREFIX = utils.NATIVE_PREFIX;\n\n// Object on which raw native methods are stored.\n// e.g. `nativeMethods.querySelector.call(node, selector)`\n// same as `node.querySelector(selector)`\nexport const nativeMethods = {\n  /** @this {Element} */\n  querySelector(selector) {\n    return this[NATIVE_PREFIX + 'querySelector'](selector);\n  },\n  /** @this {Element} */\n  querySelectorAll(selector) {\n    return this[NATIVE_PREFIX + 'querySelectorAll'](selector);\n  },\n};\n// Object on which raw native accessors are available via `accessorName(node)`.\n// e.g. `nativeTree.firstChild(node)`\n// same as `node.firstChild`\nexport const nativeTree = {};\n\nconst installNativeAccessor = (name) => {\n  nativeTree[name] = (node) => node[NATIVE_PREFIX + name];\n};\n\nconst installNativeMethod = (name, fn) => {\n  if (!nativeMethods[name]) {\n    nativeMethods[name] = fn;\n  }\n};\n\nconst defineNativeAccessors = (proto, descriptors) => {\n  patchProperties(proto, descriptors, NATIVE_PREFIX);\n  // make native accessors available to users\n  for (let prop in descriptors) {\n    installNativeAccessor(prop);\n  }\n};\n\nconst copyProperties = (proto, list = []) => {\n  for (let i = 0; i < list.length; i++) {\n    const name = list[i];\n    const descriptor = Object.getOwnPropertyDescriptor(proto, name);\n    if (descriptor) {\n      Object.defineProperty(proto, NATIVE_PREFIX + name, descriptor);\n      // make native methods/accessors available to users\n      if (descriptor.value) {\n        installNativeMethod(name, descriptor.value);\n      } else {\n        installNativeAccessor(name);\n      }\n    }\n  }\n};\n\n/** @type {!TreeWalker} */\nconst nodeWalker = document.createTreeWalker(\n  document,\n  NodeFilter.SHOW_ALL,\n  null,\n  false\n);\n\n/** @type {!TreeWalker} */\nconst elementWalker = document.createTreeWalker(\n  document,\n  NodeFilter.SHOW_ELEMENT,\n  null,\n  false\n);\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nconst clearNode = (node) => {\n  let firstChild;\n  while ((firstChild = node[NATIVE_PREFIX + 'firstChild'])) {\n    node[NATIVE_PREFIX + 'removeChild'](firstChild);\n  }\n};\n\nconst ParentNodeAccessors = [\n  'firstElementChild',\n  'lastElementChild',\n  'children',\n  'childElementCount',\n];\n\nconst ParentNodeMethods = [\n  'querySelector',\n  'querySelectorAll',\n  'append',\n  'prepend',\n  'replaceChildren',\n];\n\nexport const addNativePrefixedProperties = () => {\n  // EventTarget\n  const eventProps = [\n    'dispatchEvent',\n    'addEventListener',\n    'removeEventListener',\n  ];\n  if (window.EventTarget) {\n    copyProperties(window.EventTarget.prototype, eventProps);\n\n    // In Firefox 31, `EventTarget` exists, but `EventTarget.prototype` is not\n    // in the prototype chain of `window` and, strangely,\n    // `window instanceof EventTarget` still returns true.\n    if (window[NATIVE_PREFIX + 'addEventListener'] === undefined) {\n      copyProperties(Window.prototype, eventProps);\n    }\n  } else {\n    copyProperties(Node.prototype, eventProps);\n    copyProperties(Window.prototype, eventProps);\n    copyProperties(XMLHttpRequest.prototype, eventProps);\n  }\n\n  // Node\n  if (hasDescriptors) {\n    copyProperties(Node.prototype, [\n      'parentNode',\n      'firstChild',\n      'lastChild',\n      'previousSibling',\n      'nextSibling',\n      'childNodes',\n      'parentElement',\n      'textContent',\n    ]);\n  } else {\n    defineNativeAccessors(Node.prototype, {\n      parentNode: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.parentNode();\n        },\n      },\n      firstChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.firstChild();\n        },\n      },\n      lastChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.lastChild();\n        },\n      },\n      previousSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.previousSibling();\n        },\n      },\n      nextSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.nextSibling();\n        },\n      },\n      // TODO(sorvell): make this a NodeList or whatever\n      childNodes: {\n        /** @this {Node} */\n        get() {\n          const nodes = [];\n          nodeWalker.currentNode = this;\n          let n = nodeWalker.firstChild();\n          while (n) {\n            nodes.push(n);\n            n = nodeWalker.nextSibling();\n          }\n          return nodes;\n        },\n      },\n      parentElement: {\n        /** @this {Node} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.parentNode();\n        },\n      },\n      textContent: {\n        /** @this {Node} */\n        get() {\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              // TODO(sorvell): This cannot be a single TreeWalker that's reused\n              // at least for Safari 9, but it's unclear why.\n              // eslint-disable-next-line no-case-declarations\n              const textWalker = document.createTreeWalker(\n                this,\n                NodeFilter.SHOW_TEXT,\n                null,\n                false\n              );\n              // eslint-disable-next-line no-case-declarations\n              let content = '',\n                n;\n              while ((n = textWalker.nextNode())) {\n                // TODO(sorvell): can't use textContent since we patch it on Node.prototype!\n                // However, should probably patch it only on element.\n                content += n.nodeValue;\n              }\n              return content;\n            default:\n              return this.nodeValue;\n          }\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Node} */\n        set(value) {\n          if (typeof value === 'undefined' || value === null) {\n            value = '';\n          }\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              clearNode(this);\n              // Document fragments must have no childnodes if setting a blank string\n              if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n                // Note: old Chrome versions require 2nd argument here\n                this[NATIVE_PREFIX + 'insertBefore'](\n                  document.createTextNode(value),\n                  undefined\n                );\n              }\n              break;\n            default:\n              // TODO(sorvell): can't do this if patch nodeValue.\n              this.nodeValue = value;\n              break;\n          }\n        },\n      },\n    });\n  }\n\n  copyProperties(Node.prototype, [\n    'appendChild',\n    'insertBefore',\n    'removeChild',\n    'replaceChild',\n    'cloneNode',\n    'contains',\n  ]);\n\n  // NOTE, on some browsers IE 11 / Edge 15 some properties are incorrectly on HTMLElement\n  copyProperties(HTMLElement.prototype, ['parentElement', 'contains']);\n\n  const ParentNodeWalkerDescriptors = {\n    firstElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.firstChild();\n      },\n    },\n    lastElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.lastChild();\n      },\n    },\n    children: {\n      /** @this {ParentNode} */\n      get() {\n        let nodes = [];\n        elementWalker.currentNode = this;\n        let n = elementWalker.firstChild();\n        while (n) {\n          nodes.push(n);\n          n = elementWalker.nextSibling();\n        }\n        return utils.createPolyfilledHTMLCollection(nodes);\n      },\n    },\n    childElementCount: {\n      /** @this {ParentNode} */\n      get() {\n        if (this.children) {\n          return this.children.length;\n        }\n        return 0;\n      },\n    },\n  };\n\n  // Element\n  if (hasDescriptors) {\n    copyProperties(Element.prototype, ParentNodeAccessors);\n\n    copyProperties(Element.prototype, [\n      'previousElementSibling',\n      'nextElementSibling',\n      'innerHTML',\n      'className',\n    ]);\n\n    // NOTE, on some browsers IE 11 / Edge 15 some properties are incorrectly on HTMLElement\n    copyProperties(HTMLElement.prototype, [\n      'children',\n      'innerHTML',\n      'className',\n    ]);\n  } else {\n    defineNativeAccessors(Element.prototype, ParentNodeWalkerDescriptors);\n    defineNativeAccessors(Element.prototype, {\n      previousElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.previousSibling();\n        },\n      },\n      nextElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.nextSibling();\n        },\n      },\n      innerHTML: {\n        /** @this {Element} */\n        get() {\n          return getInnerHTML(this, utils.nativeChildNodesArray);\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Element} */\n        set(value) {\n          const content =\n            this.localName === 'template'\n              ? /** @type {HTMLTemplateElement} */ (this).content\n              : this;\n          clearNode(content);\n          const containerName = this.localName || 'div';\n          let htmlContainer;\n          if (\n            !this.namespaceURI ||\n            this.namespaceURI === inertDoc.namespaceURI\n          ) {\n            htmlContainer = inertDoc.createElement(containerName);\n          } else {\n            htmlContainer = inertDoc.createElementNS(\n              this.namespaceURI,\n              containerName\n            );\n          }\n          htmlContainer.innerHTML = value;\n          const newContent =\n            this.localName === 'template'\n              ? /** @type {HTMLTemplateElement} */ (htmlContainer).content\n              : htmlContainer;\n          let firstChild;\n          while ((firstChild = newContent[NATIVE_PREFIX + 'firstChild'])) {\n            // Note: old Chrome versions require 2nd argument here\n            content[NATIVE_PREFIX + 'insertBefore'](firstChild, undefined);\n          }\n        },\n      },\n      className: {\n        /** @this {Element} */\n        get() {\n          return this.getAttribute('class') || '';\n        },\n        /** @this {Element} */\n        set(value) {\n          this.setAttribute('class', value);\n        },\n      },\n    });\n  }\n\n  copyProperties(Element.prototype, [\n    'setAttribute',\n    'getAttribute',\n    'hasAttribute',\n    'removeAttribute',\n    'toggleAttribute',\n    // on older Safari, these are on Element.\n    'focus',\n    'blur',\n  ]);\n  copyProperties(Element.prototype, ParentNodeMethods);\n\n  // HTMLElement\n  copyProperties(HTMLElement.prototype, ['focus', 'blur']);\n\n  // HTMLTemplateElement\n  if (window.HTMLTemplateElement) {\n    copyProperties(window.HTMLTemplateElement.prototype, ['innerHTML']);\n  }\n\n  // DocumentFragment\n  if (hasDescriptors) {\n    // NOTE, IE 11 does not have on DocumentFragment\n    // firstElementChild\n    // lastElementChild\n    copyProperties(DocumentFragment.prototype, ParentNodeAccessors);\n  } else {\n    defineNativeAccessors(\n      DocumentFragment.prototype,\n      ParentNodeWalkerDescriptors\n    );\n  }\n\n  copyProperties(DocumentFragment.prototype, ParentNodeMethods);\n\n  // Document\n  if (hasDescriptors) {\n    copyProperties(Document.prototype, ParentNodeAccessors);\n    copyProperties(Document.prototype, ['activeElement']);\n  } else {\n    defineNativeAccessors(Document.prototype, ParentNodeWalkerDescriptors);\n  }\n\n  copyProperties(Document.prototype, [\n    'importNode',\n    'getElementById',\n    'elementFromPoint',\n    utils.getPropertyName(Document.prototype, 'elementsFromPoint'),\n  ]);\n  copyProperties(Document.prototype, ParentNodeMethods);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\n// render enqueuer/flusher\nlet flushList = [];\nlet scheduled;\nexport function enqueue(callback) {\n  if (!scheduled) {\n    scheduled = true;\n    utils.microtask(flush);\n  }\n  flushList.push(callback);\n}\n\nexport function flush() {\n  scheduled = false;\n  let didFlush = Boolean(flushList.length);\n  while (flushList.length) {\n    flushList.shift()();\n  }\n  return didFlush;\n}\n\nflush['list'] = flushList;\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nclass AsyncObserver {\n  constructor() {\n    this._scheduled = false;\n    this.addedNodes = [];\n    this.removedNodes = [];\n    this.callbacks = new Set();\n  }\n\n  schedule() {\n    if (!this._scheduled) {\n      this._scheduled = true;\n      utils.microtask(() => {\n        this.flush();\n      });\n    }\n  }\n\n  flush() {\n    if (this._scheduled) {\n      this._scheduled = false;\n      let mutations = this.takeRecords();\n      if (mutations.length) {\n        this.callbacks.forEach(function (cb) {\n          cb(mutations);\n        });\n      }\n    }\n  }\n\n  takeRecords() {\n    if (this.addedNodes.length || this.removedNodes.length) {\n      let mutations = [\n        {\n          addedNodes: this.addedNodes,\n          removedNodes: this.removedNodes,\n        },\n      ];\n      this.addedNodes = [];\n      this.removedNodes = [];\n      return mutations;\n    }\n    return [];\n  }\n}\n\n// TODO(sorvell): consider instead polyfilling MutationObserver\n// directly so that users do not have to fork their code.\n// Supporting the entire api may be challenging: e.g. filtering out\n// removed nodes in the wrong scope and seeing non-distributing\n// subtree child mutations.\nexport let observeChildren = function (node, callback) {\n  const sd = ensureShadyDataForNode(node);\n  if (!sd.observer) {\n    sd.observer = new AsyncObserver();\n  }\n  sd.observer.callbacks.add(callback);\n  let observer = sd.observer;\n  return {\n    _callback: callback,\n    _observer: observer,\n    _node: node,\n    takeRecords() {\n      return observer.takeRecords();\n    },\n  };\n};\n\nexport let unobserveChildren = function (handle) {\n  let observer = handle && handle._observer;\n  if (observer) {\n    observer.callbacks.delete(handle._callback);\n    if (!observer.callbacks.size) {\n      ensureShadyDataForNode(handle._node).observer = null;\n    }\n  }\n};\n\nexport function filterMutations(mutations, target) {\n  /** @const {Node} */\n  const targetRootNode = target.getRootNode();\n  return mutations\n    .map(function (mutation) {\n      /** @const {boolean} */\n      const mutationInScope = targetRootNode === mutation.target.getRootNode();\n      if (mutationInScope && mutation.addedNodes) {\n        let nodes = utils.arrayFrom(mutation.addedNodes).filter(function (n) {\n          return targetRootNode === n.getRootNode();\n        });\n        if (nodes.length) {\n          mutation = Object.create(mutation);\n          Object.defineProperty(mutation, 'addedNodes', {\n            value: nodes,\n            configurable: true,\n          });\n          return mutation;\n        }\n      } else if (mutationInScope) {\n        return mutation;\n      }\n    })\n    .filter(function (m) {\n      return m;\n    });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Cribbed from ShadowDOM polyfill\n// https://github.com/webcomponents/webcomponentsjs/blob/master/src/ShadowDOM/wrappers/HTMLElement.js#L28\n/////////////////////////////////////////////////////////////////////////////\n// innerHTML and outerHTML\n\n// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#escapingString\nlet escapeAttrRegExp = /[&\\u00A0\"]/g;\nlet escapeDataRegExp = /[&\\u00A0<>]/g;\n\nfunction escapeReplace(c) {\n  switch (c) {\n    case '&':\n      return '&amp;';\n    case '<':\n      return '&lt;';\n    case '>':\n      return '&gt;';\n    case '\"':\n      return '&quot;';\n    case '\\u00A0':\n      return '&nbsp;';\n  }\n}\n\nfunction escapeAttr(s) {\n  return s.replace(escapeAttrRegExp, escapeReplace);\n}\n\nfunction escapeData(s) {\n  return s.replace(escapeDataRegExp, escapeReplace);\n}\n\nfunction makeSet(arr) {\n  let set = {};\n  for (let i = 0; i < arr.length; i++) {\n    set[arr[i]] = true;\n  }\n  return set;\n}\n\n// http://www.whatwg.org/specs/web-apps/current-work/#void-elements\nlet voidElements = makeSet([\n  'area',\n  'base',\n  'br',\n  'col',\n  'command',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr',\n]);\n\nlet plaintextParents = makeSet([\n  'style',\n  'script',\n  'xmp',\n  'iframe',\n  'noembed',\n  'noframes',\n  'plaintext',\n  'noscript',\n]);\n\n/**\n * @param {Node} node\n * @param {Node} parentNode\n * @param {Function=} callback\n */\nexport function getOuterHTML(node, parentNode, callback) {\n  switch (node.nodeType) {\n    case Node.ELEMENT_NODE: {\n      let tagName = node.localName;\n      let s = '<' + tagName;\n      let attrs = node.attributes;\n      for (let i = 0, attr; (attr = attrs[i]); i++) {\n        s += ' ' + attr.name + '=\"' + escapeAttr(attr.value) + '\"';\n      }\n      s += '>';\n      if (voidElements[tagName]) {\n        return s;\n      }\n      return s + getInnerHTML(node, callback) + '</' + tagName + '>';\n    }\n    case Node.TEXT_NODE: {\n      let data = /** @type {Text} */ (node).data;\n      if (parentNode && plaintextParents[parentNode.localName]) {\n        return data;\n      }\n      return escapeData(data);\n    }\n    case Node.COMMENT_NODE: {\n      return '<!--' + /** @type {Comment} */ (node).data + '-->';\n    }\n    default: {\n      window.console.error(node);\n      throw new Error('not implemented');\n    }\n  }\n}\n\n/**\n * @param {Node} node\n * @param {Function=} callback\n */\nexport function getInnerHTML(node, callback) {\n  if (node.localName === 'template') {\n    node = /** @type {HTMLTemplateElement} */ (node).content;\n  }\n  let s = '';\n  let c$ = callback ? callback(node) : node.childNodes;\n  for (let i = 0, l = c$.length, child; i < l && (child = c$[i]); i++) {\n    s += getOuterHTML(child, node, callback);\n  }\n  return s;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nexport const InsideDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get childNodes() {\n    return this[utils.SHADY_PREFIX + 'childNodes'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    return this[utils.SHADY_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    return this[utils.SHADY_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get childElementCount() {\n    return this[utils.SHADY_PREFIX + 'childElementCount'];\n  },\n\n  /** @this {Node} */\n  get children() {\n    return this[utils.SHADY_PREFIX + 'children'];\n  },\n\n  /** @this {Node} */\n  get firstElementChild() {\n    return this[utils.SHADY_PREFIX + 'firstElementChild'];\n  },\n\n  /** @this {Node} */\n  get lastElementChild() {\n    return this[utils.SHADY_PREFIX + 'lastElementChild'];\n  },\n\n  /** @this {Node} */\n  get shadowRoot() {\n    return this[utils.SHADY_PREFIX + 'shadowRoot'];\n  },\n});\n\nexport const TextContentInnerHTMLDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get textContent() {\n    return this[utils.SHADY_PREFIX + 'textContent'];\n  },\n\n  /** @this {Node} */\n  set textContent(value) {\n    this[utils.SHADY_PREFIX + 'textContent'] = value;\n  },\n\n  /** @this {Node} */\n  get innerHTML() {\n    return this[utils.SHADY_PREFIX + 'innerHTML'];\n  },\n\n  /** @this {Node} */\n  set innerHTML(value) {\n    this[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  },\n});\n\nexport const OutsideDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get parentElement() {\n    return this[utils.SHADY_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get parentNode() {\n    return this[utils.SHADY_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    return this[utils.SHADY_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    return this[utils.SHADY_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get nextElementSibling() {\n    return this[utils.SHADY_PREFIX + 'nextElementSibling'];\n  },\n\n  /** @this {Node} */\n  get previousElementSibling() {\n    return this[utils.SHADY_PREFIX + 'previousElementSibling'];\n  },\n\n  /** @this {Node} */\n  get className() {\n    return this[utils.SHADY_PREFIX + 'className'];\n  },\n\n  /** @this {Node} */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'className'] = value;\n  },\n});\n\nconst makeNonEnumerable = (descriptors) => {\n  for (let prop in descriptors) {\n    const descriptor = descriptors[prop];\n    // NOTE, the only known reason the descriptor wouldn't exist here is\n    // if someone has patched `Object.getOwnPropertyNames`, but we've seen this\n    // so this is just to be extra safe.\n    if (descriptor) {\n      descriptor.enumerable = false;\n    }\n  }\n};\n\nmakeNonEnumerable(InsideDescriptors);\nmakeNonEnumerable(TextContentInnerHTMLDescriptors);\nmakeNonEnumerable(OutsideDescriptors);\n\nconst noInstancePatching =\n  utils.settings.hasDescriptors || utils.settings.noPatch === true;\n\n// ensure an element has patched \"outside\" accessors; no-op when not needed\nexport let patchOutsideElementAccessors = noInstancePatching\n  ? function () {}\n  : function (element) {\n      const sd = ensureShadyDataForNode(element);\n      if (!sd.__outsideAccessors) {\n        sd.__outsideAccessors = true;\n        utils.patchExistingProperties(element, OutsideDescriptors);\n      }\n    };\n\n// ensure an element has patched \"inside\" accessors; no-op when not needed\nexport let patchInsideElementAccessors = noInstancePatching\n  ? function () {}\n  : function (element) {\n      const sd = ensureShadyDataForNode(element);\n      if (!sd.__insideAccessors) {\n        sd.__insideAccessors = true;\n        utils.patchExistingProperties(element, InsideDescriptors);\n        // NOTE: There are compatibility issues with patches for `textContent`\n        // and `innerHTML` between CE and SD. Since SD patches are applied\n        // via `ShadyDOM.patch` and CE patches are applied as the tree is walked,\n        // SD patches overwrite CE patches.\n        // * When SD is in patching mode, SD calls through to native\n        // methods not patched by CE (since SD is at the bottom) and CE does not\n        // upgrade, connect, or disconnect elements. Therefore do *not patch*\n        // these accessors in this case.\n        // * When SD is in `noPatch` mode, the SD patches call through to\n        // \"native\" methods that are patched by CE (since CE is at the bottom).\n        // Therefore continue to patch in this case.\n        // If the custom elements polyfill is not loaded, then these accessors\n        // should be patched so they work correctly.\n        if (!utils.hasPolyfilledCustomElements() || utils.settings.noPatch) {\n          utils.patchExistingProperties(\n            element,\n            TextContentInnerHTMLDescriptors\n          );\n        }\n      }\n    };\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {flush} from './flush.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\n\n/*\nMake this name unique so it is unlikely to conflict with properties on objects passed to `addEventListener`\nhttps://github.com/webcomponents/shadydom/issues/173\n*/\nconst /** string */ eventWrappersName = `__eventWrappers${Date.now()}`;\n\n/** @type {?function(!Event): boolean} */\nconst composedGetter = (() => {\n  const composedProp = Object.getOwnPropertyDescriptor(\n    Event.prototype,\n    'composed'\n  );\n  return composedProp ? (ev) => composedProp.get.call(ev) : null;\n})();\n\nconst supportsEventOptions = (() => {\n  let supported = false;\n  let eventOptions = {\n    get capture() {\n      supported = true;\n      return false;\n    },\n  };\n  const listener = () => {};\n  // NOTE: These will be unpatched at this point.\n  window.addEventListener('test', listener, eventOptions);\n  window.removeEventListener('test', listener, eventOptions);\n  return supported;\n})();\n\nconst parseEventOptions = (optionsOrCapture) => {\n  let capture, once, shadyTarget;\n  if (\n    optionsOrCapture !== null &&\n    (typeof optionsOrCapture === 'object' ||\n      typeof optionsOrCapture === 'function')\n  ) {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    shadyTarget = optionsOrCapture.__shadyTarget;\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n  }\n  return {\n    shadyTarget,\n    capture,\n    once,\n    nativeEventOptions: supportsEventOptions ? optionsOrCapture : capture,\n  };\n};\n\n// https://github.com/w3c/webcomponents/issues/513#issuecomment-224183937\nconst alwaysComposed = {\n  'blur': true,\n  'focus': true,\n  'focusin': true,\n  'focusout': true,\n  'click': true,\n  'dblclick': true,\n  'mousedown': true,\n  'mouseenter': true,\n  'mouseleave': true,\n  'mousemove': true,\n  'mouseout': true,\n  'mouseover': true,\n  'mouseup': true,\n  'wheel': true,\n  'beforeinput': true,\n  'input': true,\n  'keydown': true,\n  'keyup': true,\n  'compositionstart': true,\n  'compositionupdate': true,\n  'compositionend': true,\n  'touchstart': true,\n  'touchend': true,\n  'touchmove': true,\n  'touchcancel': true,\n  'pointerover': true,\n  'pointerenter': true,\n  'pointerdown': true,\n  'pointermove': true,\n  'pointerup': true,\n  'pointercancel': true,\n  'pointerout': true,\n  'pointerleave': true,\n  'gotpointercapture': true,\n  'lostpointercapture': true,\n  'dragstart': true,\n  'drag': true,\n  'dragenter': true,\n  'dragleave': true,\n  'dragover': true,\n  'drop': true,\n  'dragend': true,\n  'DOMActivate': true,\n  'DOMFocusIn': true,\n  'DOMFocusOut': true,\n  'keypress': true,\n};\n\nconst unpatchedEvents = {\n  'DOMAttrModified': true,\n  'DOMAttributeNameChanged': true,\n  'DOMCharacterDataModified': true,\n  'DOMElementNameChanged': true,\n  'DOMNodeInserted': true,\n  'DOMNodeInsertedIntoDocument': true,\n  'DOMNodeRemoved': true,\n  'DOMNodeRemovedFromDocument': true,\n  'DOMSubtreeModified': true,\n};\n\n/**\n * Some EventTarget subclasses are not Node subclasses, and you cannot call\n * `getRootNode()` on them.\n *\n * @param {!(Node|EventTarget)} eventTarget\n * @return {!(Node|EventTarget)}\n */\nfunction getRootNodeWithFallback(eventTarget) {\n  if (eventTarget instanceof Node) {\n    return eventTarget[utils.SHADY_PREFIX + 'getRootNode']();\n  } else {\n    return eventTarget;\n  }\n}\n\nfunction pathComposer(startNode, composed) {\n  let composedPath = [];\n  let current = startNode;\n  let startRoot = getRootNodeWithFallback(startNode);\n  while (current) {\n    composedPath.push(current);\n    if (current[utils.SHADY_PREFIX + 'assignedSlot']) {\n      current = current[utils.SHADY_PREFIX + 'assignedSlot'];\n    } else if (\n      current.nodeType === Node.DOCUMENT_FRAGMENT_NODE &&\n      current.host &&\n      (composed || current !== startRoot)\n    ) {\n      current = current.host;\n    } else {\n      current = current[utils.SHADY_PREFIX + 'parentNode'];\n    }\n  }\n  // event composedPath includes window when startNode's ownerRoot is document\n  if (composedPath[composedPath.length - 1] === document) {\n    composedPath.push(window);\n  }\n  return composedPath;\n}\n\nexport const composedPath = (event) => {\n  if (!event.__composedPath) {\n    event.__composedPath = pathComposer(event.target, true);\n  }\n  return event.__composedPath;\n};\n\nfunction retarget(refNode, path) {\n  if (!utils.isShadyRoot) {\n    return refNode;\n  }\n  // If ANCESTOR's root is not a shadow root or ANCESTOR's root is BASE's\n  // shadow-including inclusive ancestor, return ANCESTOR.\n  let refNodePath = pathComposer(refNode, true);\n  let p$ = path;\n  for (let i = 0, ancestor, lastRoot, root, rootIdx; i < p$.length; i++) {\n    ancestor = p$[i];\n    root = getRootNodeWithFallback(ancestor);\n    if (root !== lastRoot) {\n      rootIdx = refNodePath.indexOf(root);\n      lastRoot = root;\n    }\n    if (!utils.isShadyRoot(root) || rootIdx > -1) {\n      return ancestor;\n    }\n  }\n}\n\nlet EventPatches = {\n  /**\n   * @this {Event}\n   */\n  get composed() {\n    if (this.__composed === undefined) {\n      // if there's an original `composed` getter on the Event prototype, use that\n      if (composedGetter) {\n        // TODO(web-padawan): see https://github.com/webcomponents/shadydom/issues/275\n        this.__composed =\n          this.type === 'focusin' ||\n          this.type === 'focusout' ||\n          composedGetter(this);\n        // If the event is trusted, or `isTrusted` is not supported, check the list of always composed events\n      } else if (this.isTrusted !== false) {\n        this.__composed = alwaysComposed[this.type];\n      }\n    }\n    return /** @type {!Event} */ (this).__composed || false;\n  },\n\n  /**\n   * @this {Event}\n   */\n  composedPath() {\n    if (!this.__composedPath) {\n      this.__composedPath = pathComposer(this['__target'], this.composed);\n    }\n    return /** @type {!Event} */ (this).__composedPath;\n  },\n\n  /**\n   * @this {Event}\n   */\n  get target() {\n    return retarget(\n      this.currentTarget || this['__previousCurrentTarget'],\n      this.composedPath()\n    );\n  },\n\n  // http://w3c.github.io/webcomponents/spec/shadow/#event-relatedtarget-retargeting\n  /**\n   * @this {Event}\n   */\n  get relatedTarget() {\n    if (!this.__relatedTarget) {\n      return null;\n    }\n    if (!this.__relatedTargetComposedPath) {\n      this.__relatedTargetComposedPath = pathComposer(\n        this.__relatedTarget,\n        true\n      );\n    }\n    // find the deepest node in relatedTarget composed path that is in the same root with the currentTarget\n    return retarget(\n      this.currentTarget || this['__previousCurrentTarget'],\n      /** @type {!Event} */ (this).__relatedTargetComposedPath\n    );\n  },\n  /**\n   * @this {Event}\n   */\n  stopPropagation() {\n    Event.prototype.stopPropagation.call(this);\n    this.__propagationStopped = true;\n  },\n  /**\n   * @this {Event}\n   */\n  stopImmediatePropagation() {\n    Event.prototype.stopImmediatePropagation.call(this);\n    this.__immediatePropagationStopped = true;\n    this.__propagationStopped = true;\n  },\n};\n\n// Some browsers have missing or broken descriptors. If this is the case\n// eventPhase can't be polyfilled. For example, Chrome 41 does not\n// have prototypical descriptors on DOM objects and Safari 9 has broken ones\n// that cannot be used.\nconst eventPhaseDescriptor =\n  utils.settings.hasDescriptors &&\n  Object.getOwnPropertyDescriptor(Event.prototype, 'eventPhase');\nif (eventPhaseDescriptor) {\n  Object.defineProperty(\n    EventPatches,\n    'eventPhase',\n    /** @type {!ObjectPropertyDescriptor<!Event>} */ ({\n      /**\n       * @this {Event}\n       */\n      get() {\n        return this.currentTarget === this.target\n          ? Event.AT_TARGET\n          : this[utils.NATIVE_PREFIX + 'eventPhase'];\n      },\n      enumerable: true,\n      configurable: true,\n    })\n  );\n\n  Object.defineProperty(\n    EventPatches,\n    utils.NATIVE_PREFIX + 'eventPhase',\n    eventPhaseDescriptor\n  );\n}\n\nfunction mixinComposedFlag(Base) {\n  // NOTE: avoiding use of `class` here so that transpiled output does not\n  // try to do `Base.call` with a dom construtor.\n  let klazz = function (type, options) {\n    let event = new Base(type, options);\n    event.__composed = options && Boolean(options['composed']);\n    return event;\n  };\n  // put constructor properties on subclass\n  klazz.__proto__ = Base;\n  klazz.prototype = Base.prototype;\n  return klazz;\n}\n\nlet nonBubblingEventsToRetarget = {\n  'focus': true,\n  'blur': true,\n};\n\n/**\n * Check if the event has been retargeted by comparing original `target`, and calculated `target`\n * @param {Event} event\n * @return {boolean} True if the original target and calculated target are the same\n */\nfunction hasRetargeted(event) {\n  return (\n    event['__target'] !== event.target ||\n    event.__relatedTarget !== event.relatedTarget\n  );\n}\n\n/**\n *\n * @param {Event} event\n * @param {Node} node\n * @param {string} phase\n */\nfunction fireHandlers(event, node, phase) {\n  let hs =\n    node.__handlers &&\n    node.__handlers[event.type] &&\n    node.__handlers[event.type][phase];\n  if (hs) {\n    for (let i = 0, fn; (fn = hs[i]); i++) {\n      if (hasRetargeted(event) && event.target === event.relatedTarget) {\n        return;\n      }\n      fn.call(node, event);\n      if (event.__immediatePropagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\n// In Chrome 41, `currentTarget` is an own property of every `Event` and its\n// descriptor is a _data_ descriptor and not an accessor descriptor (so there is\n// no getter that could be saved and wrapped) but the browser effectively treats\n// this property as if it had a getter and returns different values on getting\n// as necessary. Further, setting a new descriptor for `currentTarget`, as\n// `shadyDispatchEvent` does below, permanently breaks this special descriptor\n// behavior. In this case, `shadyDispatchEvent` creates a new object with the\n// original event as its prototype (via `Object.create`) and modifies that\n// object's `currentTarget` instead, to avoid breaking the descriptor on the\n// original event.\n//\n// In Chrome 104 and Safari 9, some getters on events do not allow `this` to be\n// anything other than exactly the original event object. This means that the\n// above process of using a proxy-like (not a `Proxy`) object for the event\n// fails because any user that attempts to use properties of the original event\n// will be using the proxy as `this`.\n//\n// Fortunately, these two issues seem to be mutually exclusive amongst the\n// browsers that we test on, so we can specifically check if `currentTarget`\n// exists on a new `Event` and switch based off of that.\n// `utils.settings.hasDescriptors` is not sufficient for deciding this behavior\n// because, in Safari 9, `currentTarget` is not an own property of events, but\n// `.hasDescriptors` is still false.\nconst shadyDispatchEventNeedsProxyEvent = new Event('e').hasOwnProperty(\n  'currentTarget'\n);\n\nfunction shadyDispatchEvent(originalEvent) {\n  const e = shadyDispatchEventNeedsProxyEvent\n    ? Object.create(originalEvent)\n    : originalEvent;\n  const path = e.composedPath();\n  const retargetedPath = path.map((node) => retarget(node, path));\n  const bubbles = e.bubbles;\n\n  let currentTarget;\n  // override `currentTarget` to let patched `target` calculate correctly\n  const prevCurrentTargetDesc = Object.getOwnPropertyDescriptor(\n    e,\n    'currentTarget'\n  );\n  Object.defineProperty(e, 'currentTarget', {\n    configurable: true,\n    enumerable: true,\n    get: function () {\n      return currentTarget;\n    },\n  });\n\n  let eventPhase = Event.CAPTURING_PHASE;\n  const prevEventPhaseDesc = Object.getOwnPropertyDescriptor(e, 'eventPhase');\n  Object.defineProperty(e, 'eventPhase', {\n    configurable: true,\n    enumerable: true,\n    get: function () {\n      return eventPhase;\n    },\n  });\n\n  try {\n    for (let i = path.length - 1; i >= 0; i--) {\n      currentTarget = path[i];\n      eventPhase =\n        currentTarget === retargetedPath[i]\n          ? Event.AT_TARGET\n          : Event.CAPTURING_PHASE;\n      // capture phase fires all capture handlers\n      fireHandlers(e, currentTarget, 'capture');\n      if (e.__propagationStopped) {\n        return;\n      }\n    }\n\n    for (let i = 0; i < path.length; i++) {\n      currentTarget = path[i];\n      const atTarget = currentTarget === retargetedPath[i];\n      if (atTarget || bubbles) {\n        eventPhase = atTarget ? Event.AT_TARGET : Event.BUBBLING_PHASE;\n        fireHandlers(e, currentTarget, 'bubble');\n        if (e.__propagationStopped) {\n          return;\n        }\n      }\n    }\n  } finally {\n    if (!shadyDispatchEventNeedsProxyEvent) {\n      // Restore previous currentTarget & eventPhase descriptors when\n      // dispatching is complete\n      if (prevCurrentTargetDesc) {\n        Object.defineProperty(e, 'currentTarget', prevCurrentTargetDesc);\n      } else {\n        delete e['currentTarget'];\n      }\n      if (prevEventPhaseDesc) {\n        Object.defineProperty(e, 'eventPhase', prevEventPhaseDesc);\n      } else {\n        delete e['eventPhase'];\n      }\n    }\n  }\n}\n\nfunction listenerSettingsEqual(savedListener, node, type, capture) {\n  let {node: savedNode, type: savedType, capture: savedCapture} = savedListener;\n  return node === savedNode && type === savedType && capture === savedCapture;\n}\n\nexport function findListener(wrappers, node, type, capture) {\n  for (let i = 0; i < wrappers.length; i++) {\n    if (listenerSettingsEqual(wrappers[i], node, type, capture)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Firefox can throw on accessing eventWrappers inside of `removeEventListener` during a selenium run\n * Try/Catch accessing eventWrappers to work around\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1353074\n */\nfunction getEventWrappers(eventLike) {\n  let wrappers = null;\n  try {\n    wrappers = eventLike[eventWrappersName];\n  } catch (e) {} // eslint-disable-line no-empty\n  return wrappers;\n}\n\nfunction targetNeedsPathCheck(node) {\n  return utils.isShadyRoot(node) || node.localName === 'slot';\n}\n\n/** @this {Node} */\nexport function dispatchEvent(event) {\n  flush();\n  // If the target is disconnected from the real document, it might still be\n  // connected in the user-facing tree. To allow its path to potentially\n  // include both connected and disconnected parts, dispatch it manually.\n  if (\n    !utils.settings.preferPerformance &&\n    this instanceof Node &&\n    !utils.documentContains(document, this)\n  ) {\n    if (!event['__target']) {\n      patchEvent(event, this);\n    }\n    return shadyDispatchEvent(event);\n  } else {\n    return this[utils.NATIVE_PREFIX + 'dispatchEvent'](event);\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function addEventListener(type, fnOrObj, optionsOrCapture) {\n  const {capture, once, shadyTarget, nativeEventOptions} = parseEventOptions(\n    optionsOrCapture\n  );\n  if (!fnOrObj) {\n    return;\n  }\n\n  const handlerType = typeof fnOrObj;\n\n  // bail if `fnOrObj` is not a function, not an object\n  if (handlerType !== 'function' && handlerType !== 'object') {\n    return;\n  }\n\n  // bail if `fnOrObj` is an object without a `handleEvent` method\n  if (\n    handlerType === 'object' &&\n    (!fnOrObj.handleEvent || typeof fnOrObj.handleEvent !== 'function')\n  ) {\n    return;\n  }\n\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'addEventListener'](\n      type,\n      fnOrObj,\n      nativeEventOptions\n    );\n  }\n\n  // hack to let ShadyRoots have event listeners\n  // event listener will be on host, but `currentTarget`\n  // will be set to shadyroot for event listener\n  let target = shadyTarget || this;\n\n  let wrappers = fnOrObj[eventWrappersName];\n  if (wrappers) {\n    // The callback `fn` might be used for multiple nodes/events. Since we generate\n    // a wrapper function, we need to keep track of it when we remove the listener.\n    // It's more efficient to store the node/type/options information as Array in\n    // `fn` itself rather than the node (we assume that the same callback is used\n    // for few nodes at most, whereas a node will likely have many event listeners).\n    // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n    // Stop if the wrapper function has already been created.\n    if (findListener(wrappers, target, type, capture) > -1) {\n      return;\n    }\n  } else {\n    fnOrObj[eventWrappersName] = [];\n  }\n\n  /**\n   * @this {EventTarget}\n   * @param {Event} e\n   */\n  const wrapperFn = (e) => {\n    // Support `once` option.\n    if (once) {\n      this[utils.SHADY_PREFIX + 'removeEventListener'](\n        type,\n        fnOrObj,\n        optionsOrCapture\n      );\n    }\n    if (!e['__target']) {\n      patchEvent(e);\n    }\n    let lastCurrentTargetDesc;\n    let lastEventPhaseDesc;\n    if (target !== this) {\n      // replace `currentTarget` to make `target` and `relatedTarget` correct for inside the shadowroot\n      lastCurrentTargetDesc = Object.getOwnPropertyDescriptor(\n        e,\n        'currentTarget'\n      );\n      Object.defineProperty(e, 'currentTarget', {\n        get() {\n          return target;\n        },\n        configurable: true,\n      });\n      lastEventPhaseDesc = Object.getOwnPropertyDescriptor(e, 'eventPhase');\n      Object.defineProperty(e, 'eventPhase', {\n        configurable: true,\n        enumerable: true,\n        get() {\n          // Shady DOM doesn't support dispatching to a shadow root as the\n          // target, so we don't need to handle Event.AT_TARGET.\n          return capture ? Event.CAPTURING_PHASE : Event.BUBBLING_PHASE;\n        },\n      });\n    }\n    e['__previousCurrentTarget'] = e['currentTarget'];\n    // Always check if a shadowRoot or slot is in the current event path.\n    // If it is not, the event was generated on either the host of the shadowRoot\n    // or a children of the host.\n    if (\n      targetNeedsPathCheck(target) &&\n      e.composedPath().indexOf(target) == -1\n    ) {\n      return;\n    }\n    // There are two critera that should stop events from firing on this node\n    // 1. the event is not composed and the current node is not in the same root as the target\n    // 2. when bubbling, if after retargeting, relatedTarget and target point to the same node\n    if (e.composed || e.composedPath().indexOf(target) > -1) {\n      if (hasRetargeted(e) && e.target === e.relatedTarget) {\n        if (e.eventPhase === Event.BUBBLING_PHASE) {\n          e.stopImmediatePropagation();\n        }\n        return;\n      }\n      // prevent non-bubbling events from triggering bubbling handlers on shadowroot, but only if not in capture phase\n      if (\n        e.eventPhase !== Event.CAPTURING_PHASE &&\n        !e.bubbles &&\n        e.target !== target &&\n        !(target instanceof Window)\n      ) {\n        return;\n      }\n      let ret =\n        handlerType === 'function'\n          ? fnOrObj.call(target, e)\n          : fnOrObj.handleEvent && fnOrObj.handleEvent(e);\n      if (target !== this) {\n        // Replace the original descriptors for `currentTarget` and `eventPhase`.\n        if (lastCurrentTargetDesc) {\n          Object.defineProperty(e, 'currentTarget', lastCurrentTargetDesc);\n          lastCurrentTargetDesc = null;\n        } else {\n          delete e['currentTarget'];\n        }\n        if (lastEventPhaseDesc) {\n          Object.defineProperty(e, 'eventPhase', lastEventPhaseDesc);\n          lastEventPhaseDesc = null;\n        } else {\n          delete e['eventPhase'];\n        }\n      }\n      return ret;\n    }\n  };\n\n  // Store the wrapper information.\n  fnOrObj[eventWrappersName].push({\n    // note: use target here which is either a shadowRoot\n    // (when the host element is proxy'ing the event) or this element\n    node: target,\n    type,\n    capture,\n    wrapperFn,\n  });\n\n  this.__handlers = this.__handlers || {};\n  this.__handlers[type] = this.__handlers[type] || {\n    'capture': [],\n    'bubble': [],\n  };\n  this.__handlers[type][capture ? 'capture' : 'bubble'].push(wrapperFn);\n\n  if (!nonBubblingEventsToRetarget[type]) {\n    this[utils.NATIVE_PREFIX + 'addEventListener'](\n      type,\n      wrapperFn,\n      nativeEventOptions\n    );\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function removeEventListener(type, fnOrObj, optionsOrCapture) {\n  if (!fnOrObj) {\n    return;\n  }\n  const {capture, shadyTarget, nativeEventOptions} = parseEventOptions(\n    optionsOrCapture\n  );\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'removeEventListener'](\n      type,\n      fnOrObj,\n      nativeEventOptions\n    );\n  }\n  let target = shadyTarget || this;\n  // Search the wrapped function.\n  let wrapperFn = undefined;\n  let wrappers = getEventWrappers(fnOrObj);\n  if (wrappers) {\n    let idx = findListener(wrappers, target, type, capture);\n    if (idx > -1) {\n      wrapperFn = wrappers.splice(idx, 1)[0].wrapperFn;\n      // Cleanup.\n      if (!wrappers.length) {\n        fnOrObj[eventWrappersName] = undefined;\n      }\n    }\n  }\n  this[utils.NATIVE_PREFIX + 'removeEventListener'](\n    type,\n    wrapperFn || fnOrObj,\n    nativeEventOptions\n  );\n  if (wrapperFn && this.__handlers && this.__handlers[type]) {\n    const arr = this.__handlers[type][capture ? 'capture' : 'bubble'];\n    const idx = arr.indexOf(wrapperFn);\n    if (idx > -1) {\n      arr.splice(idx, 1);\n    }\n  }\n}\n\nfunction activateFocusEventOverrides() {\n  for (let ev in nonBubblingEventsToRetarget) {\n    window[utils.NATIVE_PREFIX + 'addEventListener'](\n      ev,\n      function (e) {\n        if (!e['__target']) {\n          patchEvent(e);\n          shadyDispatchEvent(e);\n        }\n      },\n      true\n    );\n  }\n}\n\nconst EventPatchesDescriptors = utils.getOwnPropertyDescriptors(EventPatches);\n\nconst SHADY_PROTO = '__shady_patchedProto';\nconst SHADY_SOURCE_PROTO = '__shady_sourceProto';\n\nfunction patchEvent(event, target = event.target) {\n  event['__target'] = target;\n  event.__relatedTarget = event.relatedTarget;\n  // attempt to patch prototype (via cache)\n  if (utils.settings.hasDescriptors) {\n    const proto = Object.getPrototypeOf(event);\n    // eslint-disable-next-line no-prototype-builtins\n    if (!proto.hasOwnProperty(SHADY_PROTO)) {\n      const patchedProto = Object.create(proto);\n      patchedProto[SHADY_SOURCE_PROTO] = proto;\n      utils.patchProperties(patchedProto, EventPatchesDescriptors);\n      proto[SHADY_PROTO] = patchedProto;\n    }\n    event.__proto__ = proto[SHADY_PROTO];\n    // and fallback to patching instance\n  } else {\n    utils.patchProperties(event, EventPatchesDescriptors);\n  }\n}\n\nlet PatchedEvent = mixinComposedFlag(Event);\nlet PatchedCustomEvent = mixinComposedFlag(CustomEvent);\nlet PatchedMouseEvent = mixinComposedFlag(MouseEvent);\n\nexport function patchEvents() {\n  activateFocusEventOverrides();\n  window.Event = PatchedEvent;\n  window.CustomEvent = PatchedCustomEvent;\n  window.MouseEvent = PatchedMouseEvent;\n}\n\nexport function patchClick() {\n  // Fix up `Element.prototype.click()` if `isTrusted` is supported, but `composed` isn't\n  if (\n    !composedGetter &&\n    Object.getOwnPropertyDescriptor(Event.prototype, 'isTrusted')\n  ) {\n    /** @this {Element} */\n    const composedClickFn = function () {\n      const ev = new MouseEvent('click', {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n      });\n      this[utils.SHADY_PREFIX + 'dispatchEvent'](ev);\n    };\n    if (Element.prototype.click) {\n      Element.prototype.click = composedClickFn;\n    } else if (HTMLElement.prototype.click) {\n      HTMLElement.prototype.click = composedClickFn;\n    }\n  }\n}\n\nexport const eventPropertyNamesForElement = Object.getOwnPropertyNames(\n  Element.prototype\n).filter((name) => name.substring(0, 2) === 'on');\n\nexport const eventPropertyNamesForHTMLElement = Object.getOwnPropertyNames(\n  HTMLElement.prototype\n).filter((name) => name.substring(0, 2) === 'on');\n\n/**\n * @param {string} property\n * @return {!ObjectPropertyDescriptor<Element>}\n */\nexport const wrappedDescriptorForEventProperty = (property) => {\n  return {\n    /** @this {Element} */\n    set: function (fn) {\n      const shadyData = ensureShadyDataForNode(this);\n      const eventName = property.substring(2);\n      if (!shadyData.__onCallbackListeners) {\n        shadyData.__onCallbackListeners = {};\n      }\n      shadyData.__onCallbackListeners[property] &&\n        this.removeEventListener(\n          eventName,\n          shadyData.__onCallbackListeners[property]\n        );\n      this[utils.SHADY_PREFIX + 'addEventListener'](eventName, fn);\n      shadyData.__onCallbackListeners[property] = fn;\n    },\n    /** @this {Element} */\n    get() {\n      const shadyData = shadyDataForNode(this);\n      return (\n        shadyData &&\n        shadyData.__onCallbackListeners &&\n        shadyData.__onCallbackListeners[property]\n      );\n    },\n    configurable: true,\n  };\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount,\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\n// Note: This function is *based* on the computation of the Levenshtein\n// \"edit\" distance. The one change is that \"updates\" are treated as two\n// edits - not one. With Array splices, an update is really a delete\n// followed by an add. By retaining this, we optimize for \"keeping\" the\n// maximum array items in the original array. For example:\n//\n//   'xxxx123' -> '123yyyy'\n//\n// With 1-edit updates, the shortest path would be just to update all seven\n// characters. With 2-edit updates, we delete 4, leave 3, and add 4. This\n// leaves the substring '123' intact.\nfunction calcEditDistances(\n  current,\n  currentStart,\n  currentEnd,\n  old,\n  oldStart,\n  oldEnd\n) {\n  // \"Deletion\" columns\n  let rowCount = oldEnd - oldStart + 1;\n  let columnCount = currentEnd - currentStart + 1;\n  let distances = new Array(rowCount);\n\n  // \"Addition\" rows. Initialize null column.\n  for (let i = 0; i < rowCount; i++) {\n    distances[i] = new Array(columnCount);\n    distances[i][0] = i;\n  }\n\n  // Initialize null row\n  for (let j = 0; j < columnCount; j++) {\n    distances[0][j] = j;\n  }\n\n  for (let i = 1; i < rowCount; i++) {\n    for (let j = 1; j < columnCount; j++) {\n      if (equals(current[currentStart + j - 1], old[oldStart + i - 1])) {\n        distances[i][j] = distances[i - 1][j - 1];\n      } else {\n        let north = distances[i - 1][j] + 1;\n        let west = distances[i][j - 1] + 1;\n        distances[i][j] = north < west ? north : west;\n      }\n    }\n  }\n\n  return distances;\n}\n\n// This starts at the final weight, and walks \"backward\" by finding\n// the minimum previous weight recursively until the origin of the weight\n// matrix.\nfunction spliceOperationsFromEditDistances(distances) {\n  let i = distances.length - 1;\n  let j = distances[0].length - 1;\n  let current = distances[i][j];\n  let edits = [];\n  while (i > 0 || j > 0) {\n    if (i == 0) {\n      edits.push(EDIT_ADD);\n      j--;\n      continue;\n    }\n    if (j == 0) {\n      edits.push(EDIT_DELETE);\n      i--;\n      continue;\n    }\n    let northWest = distances[i - 1][j - 1];\n    let west = distances[i - 1][j];\n    let north = distances[i][j - 1];\n\n    let min;\n    if (west < north) {\n      min = west < northWest ? west : northWest;\n    } else {\n      min = north < northWest ? north : northWest;\n    }\n\n    if (min == northWest) {\n      if (northWest == current) {\n        edits.push(EDIT_LEAVE);\n      } else {\n        edits.push(EDIT_UPDATE);\n        current = northWest;\n      }\n      i--;\n      j--;\n    } else if (min == west) {\n      edits.push(EDIT_DELETE);\n      i--;\n      current = west;\n    } else {\n      edits.push(EDIT_ADD);\n      j--;\n      current = north;\n    }\n  }\n\n  edits.reverse();\n  return edits;\n}\n\n/**\n * Splice Projection functions:\n *\n * A splice map is a representation of how a previous array of items\n * was transformed into a new array of items. Conceptually it is a list of\n * tuples of\n *\n *   <index, removed, addedCount>\n *\n * which are kept in ascending index order of. The tuple represents that at\n * the |index|, |removed| sequence of items were removed, and counting forward\n * from |index|, |addedCount| items were added.\n */\n\n/**\n * Lacking individual splice mutation information, the minimal set of\n * splices can be synthesized given the previous state and final state of an\n * array. The basic approach is to calculate the edit distance matrix and\n * choose the shortest path through it.\n *\n * Complexity: O(l * p)\n *   l: The length of the current array\n *   p: The length of the old array\n */\nfunction calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd) {\n  let prefixCount = 0;\n  let suffixCount = 0;\n  let splice;\n\n  let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n  if (currentStart == 0 && oldStart == 0) {\n    prefixCount = sharedPrefix(current, old, minLength);\n  }\n\n  if (currentEnd == current.length && oldEnd == old.length) {\n    suffixCount = sharedSuffix(current, old, minLength - prefixCount);\n  }\n\n  currentStart += prefixCount;\n  oldStart += prefixCount;\n  currentEnd -= suffixCount;\n  oldEnd -= suffixCount;\n\n  if (currentEnd - currentStart == 0 && oldEnd - oldStart == 0) {\n    return [];\n  }\n\n  if (currentStart == currentEnd) {\n    splice = newSplice(currentStart, [], 0);\n    while (oldStart < oldEnd) {\n      splice.removed.push(old[oldStart++]);\n    }\n\n    return [splice];\n  } else if (oldStart == oldEnd) {\n    return [newSplice(currentStart, [], currentEnd - currentStart)];\n  }\n\n  let ops = spliceOperationsFromEditDistances(\n    calcEditDistances(current, currentStart, currentEnd, old, oldStart, oldEnd)\n  );\n\n  splice = undefined;\n  let splices = [];\n  let index = currentStart;\n  let oldIndex = oldStart;\n  for (let i = 0; i < ops.length; i++) {\n    switch (ops[i]) {\n      case EDIT_LEAVE:\n        if (splice) {\n          splices.push(splice);\n          splice = undefined;\n        }\n\n        index++;\n        oldIndex++;\n        break;\n      case EDIT_UPDATE:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.addedCount++;\n        index++;\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n      case EDIT_ADD:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.addedCount++;\n        index++;\n        break;\n      case EDIT_DELETE:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n    }\n  }\n\n  if (splice) {\n    splices.push(splice);\n  }\n  return splices;\n}\n\nfunction sharedPrefix(current, old, searchLength) {\n  for (let i = 0; i < searchLength; i++) {\n    if (!equals(current[i], old[i])) {\n      return i;\n    }\n  }\n  return searchLength;\n}\n\nfunction sharedSuffix(current, old, searchLength) {\n  let index1 = current.length;\n  let index2 = old.length;\n  let count = 0;\n  while (count < searchLength && equals(current[--index1], old[--index2])) {\n    count++;\n  }\n\n  return count;\n}\n\nfunction equals(currentValue, previousValue) {\n  return currentValue === previousValue;\n}\n\nexport function calculateSplices(current, previous) {\n  return calcSplices(current, 0, current.length, previous, 0, previous.length);\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {addEventListener, removeEventListener, dispatchEvent} from '../patch-events.js';\n\nexport const EventTargetPatches = utils.getOwnPropertyDescriptors({\n  dispatchEvent,\n\n  addEventListener,\n\n  removeEventListener,\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\nlet scopingShim = null;\n\nexport function getScopingShim() {\n  if (!scopingShim) {\n    scopingShim = window['ShadyCSS'] && window['ShadyCSS']['ScopingShim'];\n  }\n  return scopingShim || null;\n}\n\n/**\n * @param {!Node} node\n * @param {string} attr\n * @param {string} value\n */\nexport function scopeClassAttribute(node, attr, value) {\n  const scopingShim = getScopingShim();\n  if (scopingShim && attr === 'class') {\n    scopingShim['setElementClass'](node, value);\n    return true;\n  }\n  return false;\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n */\nexport function addShadyScoping(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['scopeNode'](node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} currentScopeName\n */\nexport function removeShadyScoping(node, currentScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['unscopeNode'](node, currentScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @param {string} oldScopeName\n */\nexport function replaceShadyScoping(node, newScopeName, oldScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  if (oldScopeName) {\n    removeShadyScoping(node, oldScopeName);\n  }\n  addShadyScoping(node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @return {boolean}\n */\nexport function currentScopeIsCorrect(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return true;\n  }\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // NOTE: as an optimization, only check that all the top-level children\n    // have the correct scope.\n    let correctScope = true;\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      correctScope = correctScope && currentScopeIsCorrect(n, newScopeName);\n    }\n    return correctScope;\n  }\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return true;\n  }\n  const currentScope = scopingShim['currentScopeForNode'](node);\n  return currentScope === newScopeName;\n}\n\n/**\n * @param {!Node} node\n * @return {string}\n */\nexport function currentScopeForNode(node) {\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return '';\n  }\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return '';\n  }\n  return scopingShim['currentScopeForNode'](node);\n}\n\n/**\n * Walk over a node's tree and apply visitorFn to each element node\n *\n * @param {Node} node\n * @param {function(!Node):void} visitorFn\n */\nexport function treeVisitor(node, visitorFn) {\n  if (!node) {\n    return;\n  }\n  // this check is necessary if `node` is a Document Fragment\n  if (node.nodeType === Node.ELEMENT_NODE) {\n    visitorFn(node);\n  }\n  for (\n    let n = node[utils.SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[utils.SHADY_PREFIX + 'nextSibling']\n  ) {\n    if (n.nodeType === Node.ELEMENT_NODE) {\n      treeVisitor(n, visitorFn);\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {getScopingShim, removeShadyScoping, replaceShadyScoping, treeVisitor, currentScopeForNode, currentScopeIsCorrect} from '../style-scoping.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from '../shady-data.js';\nimport {recordInsertBefore, recordRemoveChild} from '../link-nodes.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nconst doc = window.document;\n\nconst preferPerformance = utils.settings.preferPerformance;\n\nconst nativeIsConnectedAccessors = /** @type {ObjectPropertyDescriptor} */ (Object.getOwnPropertyDescriptor(\n  Node.prototype,\n  'isConnected'\n));\n\nconst nativeIsConnected =\n  nativeIsConnectedAccessors && nativeIsConnectedAccessors.get;\n\nexport function clearNode(node) {\n  let firstChild;\n  while ((firstChild = node[utils.SHADY_PREFIX + 'firstChild'])) {\n    node[utils.SHADY_PREFIX + 'removeChild'](firstChild);\n  }\n}\n\nfunction removeOwnerShadyRoot(node) {\n  // optimization: only reset the tree if node is actually in a root\n  if (hasCachedOwnerRoot(node)) {\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      removeOwnerShadyRoot(n);\n    }\n  }\n  const nodeData = shadyDataForNode(node);\n  if (nodeData) {\n    nodeData.ownerShadyRoot = undefined;\n  }\n}\n\nfunction hasCachedOwnerRoot(node) {\n  const nodeData = shadyDataForNode(node);\n  return Boolean(nodeData && nodeData.ownerShadyRoot !== undefined);\n}\n\n/**\n * Finds the first flattened node that is composed in the node's parent.\n * If the given node is a slot, then the first flattened node is returned\n * if it exists, otherwise advance to the node's nextSibling.\n * @param {Node} node within which to find first composed node\n * @returns {Node} first composed node\n */\nfunction firstComposedNode(node) {\n  let composed = node;\n  if (node && node.localName === 'slot') {\n    const nodeData = shadyDataForNode(node);\n    const flattened = nodeData && nodeData.flattenedNodes;\n    // Note, if `flattened` is falsey, it means that the containing shadowRoot\n    // has not rendered and therefore the `<slot>` is still in the composed\n    // DOM. If that's the case the `<slot>` is the first composed node.\n    if (flattened) {\n      composed = flattened.length\n        ? flattened[0]\n        : firstComposedNode(node[utils.SHADY_PREFIX + 'nextSibling']);\n    }\n  }\n  return composed;\n}\n\n/**\n * @param {Node} node\n * @param {Node=} addedNode\n * @param {Node=} removedNode\n */\nfunction scheduleObserver(node, addedNode, removedNode) {\n  const nodeData = shadyDataForNode(node);\n  const observer = nodeData && nodeData.observer;\n  if (observer) {\n    if (addedNode) {\n      if (addedNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        for (let i = 0, l = addedNode.childNodes.length; i < l; i++) {\n          observer.addedNodes.push(addedNode.childNodes[i]);\n        }\n      } else {\n        observer.addedNodes.push(addedNode);\n      }\n    }\n    if (removedNode) {\n      observer.removedNodes.push(removedNode);\n    }\n    observer.schedule();\n  }\n}\n\nexport const NodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get parentNode() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.parentNode;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.firstChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.lastChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.nextSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.previousSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get childNodes() {\n    let childNodes;\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const nodeData = shadyDataForNode(this);\n      if (!nodeData.childNodes) {\n        nodeData.childNodes = [];\n        for (\n          let n = this[utils.SHADY_PREFIX + 'firstChild'];\n          n;\n          n = n[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          nodeData.childNodes.push(n);\n        }\n      }\n      childNodes = nodeData.childNodes;\n    } else {\n      childNodes = this[utils.NATIVE_PREFIX + 'childNodes'];\n    }\n    childNodes.item = function (index) {\n      return childNodes[index];\n    };\n    return childNodes;\n  },\n\n  /** @this {Node} */\n  get parentElement() {\n    const nodeData = shadyDataForNode(this);\n    let l = nodeData && nodeData.parentNode;\n    if (l && l.nodeType !== Node.ELEMENT_NODE) {\n      l = null;\n    }\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get isConnected() {\n    if (nativeIsConnected && nativeIsConnected.call(this)) {\n      return true;\n    }\n    if (this.nodeType == Node.DOCUMENT_FRAGMENT_NODE) {\n      return false;\n    }\n    // Fast path for distributed nodes.\n    const ownerDocument = this.ownerDocument;\n    if (ownerDocument === null || utils.documentContains(ownerDocument, this)) {\n      return true;\n    }\n    // Slow path for non-distributed nodes.\n    let node = this;\n    while (node && !(node instanceof Document)) {\n      node =\n        node[utils.SHADY_PREFIX + 'parentNode'] ||\n        (utils.isShadyRoot(node)\n          ? /** @type {ShadowRoot} */ (node).host\n          : undefined);\n    }\n    return !!(node && node instanceof Document);\n  },\n\n  /** @this {Node} */\n  get textContent() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      let tc = [];\n      for (\n        let n = this[utils.SHADY_PREFIX + 'firstChild'];\n        n;\n        n = n[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        if (n.nodeType !== Node.COMMENT_NODE) {\n          tc.push(n[utils.SHADY_PREFIX + 'textContent']);\n        }\n      }\n      return tc.join('');\n    } else {\n      return this[utils.NATIVE_PREFIX + 'textContent'];\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {string} value\n   */\n  set textContent(value) {\n    if (typeof value === 'undefined' || value === null) {\n      value = '';\n    }\n    switch (this.nodeType) {\n      case Node.ELEMENT_NODE:\n      case Node.DOCUMENT_FRAGMENT_NODE:\n        if (\n          !utils.isTrackingLogicalChildNodes(this) &&\n          utils.settings.hasDescriptors\n        ) {\n          // may be removing a nested slot but fast path if we know we are not.\n          const firstChild = this[utils.SHADY_PREFIX + 'firstChild'];\n          if (\n            firstChild != this[utils.SHADY_PREFIX + 'lastChild'] ||\n            (firstChild && firstChild.nodeType != Node.TEXT_NODE)\n          ) {\n            clearNode(this);\n          }\n          this[utils.NATIVE_PREFIX + 'textContent'] = value;\n        } else {\n          clearNode(this);\n          // Document fragments must have no childNodes if setting a blank string\n          if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n            this[utils.SHADY_PREFIX + 'insertBefore'](\n              document.createTextNode(value)\n            );\n          }\n        }\n        break;\n      default:\n        // Note, be wary of patching `nodeValue`.\n        this.nodeValue = value;\n        break;\n    }\n  },\n\n  // Patched `insertBefore`. Note that all mutations that add nodes are routed\n  // here. When a <slot> is added or a node is added to a host with a shadowRoot\n  // with a slot, a standard dom `insert` call is aborted and `_asyncRender`\n  // is called on the relevant shadowRoot. In all other cases, a standard dom\n  // `insert` can be made, but the location and ref_node may need to be changed.\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  insertBefore(node, ref_node) {\n    // optimization: assume native insertBefore is ok if the nodes are not in the document.\n    if (this.ownerDocument !== doc && node.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      return node;\n    }\n    if (node === this) {\n      throw Error(\n        `Failed to execute 'appendChild' on 'Node': The new child element contains the parent.`\n      );\n    }\n    if (ref_node) {\n      const refData = shadyDataForNode(ref_node);\n      const p = refData && refData.parentNode;\n      if (\n        (p !== undefined && p !== this) ||\n        (p === undefined &&\n          ref_node[utils.NATIVE_PREFIX + 'parentNode'] !== this)\n      ) {\n        throw Error(\n          `Failed to execute 'insertBefore' on 'Node': The node ` +\n            `before which the new node is to be inserted is not a child of this node.`\n        );\n      }\n    }\n    if (ref_node === node) {\n      return node;\n    }\n    scheduleObserver(this, node);\n    /** @type {!Array<!HTMLSlotElement>} */\n    const slotsAdded = [];\n    const ownerRoot = ownerShadyRootForNode(this);\n    /** @type {string} */\n    const newScopeName = ownerRoot\n      ? ownerRoot.host.localName\n      : currentScopeForNode(this);\n    /** @type {string} */\n    let oldScopeName;\n    // remove from existing location\n    const parentNode = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode) {\n      oldScopeName = currentScopeForNode(node);\n      const skipUnscoping =\n        // Don't remove scoping if we're inserting into another shadowRoot;\n        // this would be unnecessary since it will be re-scoped below\n        Boolean(ownerRoot) ||\n        // Don't remove scoping if we're being moved between non-shadowRoot\n        // locations (the likely case is when moving pre-scoped nodes in a template)\n        !ownerShadyRootForNode(node) ||\n        // Under preferPerformance, don't remove scoping when moving back into\n        // a document fragment that was previously scoped; the assumption is\n        // that the user should only move correctly-scoped DOM back into it\n        (preferPerformance && this['__noInsertionPoint'] !== undefined);\n      parentNode[utils.SHADY_PREFIX + 'removeChild'](node, skipUnscoping);\n    }\n    // add to new parent\n    let allowNativeInsert = true;\n    const needsScoping =\n      (!preferPerformance ||\n        // Under preferPerformance, only re-scope if we're not coming from a\n        // pre-scoped doc fragment or back into a pre-scoped doc fragment\n        (node['__noInsertionPoint'] === undefined &&\n          this['__noInsertionPoint'] === undefined)) &&\n      !currentScopeIsCorrect(node, newScopeName);\n    const needsSlotFinding =\n      ownerRoot &&\n      !node['__noInsertionPoint'] &&\n      (!preferPerformance || node.nodeType === Node.DOCUMENT_FRAGMENT_NODE);\n    if (needsSlotFinding || needsScoping) {\n      // NOTE: avoid node.removeChild as this *can* trigger another patched\n      // method (e.g. custom elements) and we want only the shady method to run.\n      // The following table describes what style scoping actions should happen as a result of this insertion.\n      // document -> shadowRoot: replace\n      // shadowRoot -> shadowRoot: replace\n      // shadowRoot -> shadowRoot of same type: do nothing\n      // shadowRoot -> document: allow unscoping\n      // document -> document: do nothing\n      // The \"same type of shadowRoot\" and \"document to document cases rely on `currentScopeIsCorrect` returning true\n      if (needsScoping) {\n        // in a document or disconnected tree, replace scoping if necessary\n        oldScopeName = oldScopeName || currentScopeForNode(node);\n      }\n      treeVisitor(node, (node) => {\n        if (needsSlotFinding && node.localName === 'slot') {\n          slotsAdded.push(/** @type {!HTMLSlotElement} */ (node));\n        }\n        if (needsScoping) {\n          replaceShadyScoping(node, newScopeName, oldScopeName);\n        }\n      });\n    }\n    // if a slot is added, must render containing root.\n    if (slotsAdded.length) {\n      ownerRoot._addSlots(slotsAdded);\n      ownerRoot._asyncRender();\n    }\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordInsertBefore(node, this, ref_node);\n      const parentData = shadyDataForNode(this);\n      // if the node being inserted into has a shadowRoot, do not perform\n      // a native insertion\n      if (parentData.root) {\n        allowNativeInsert = false;\n        // when inserting into a host with a shadowRoot with slot, use\n        // `shadowRoot._asyncRender()` via `attach-shadow` module\n        // when inserting into a host with shadowRoot with NO slot, do nothing\n        // as the node should not be added to composed DOM anywhere.\n        if (utils.hasShadowRootWithSlot(this)) {\n          parentData.root._asyncRender();\n        }\n      }\n      // when inserting into a slot inside a shadowRoot, render the\n      // containing shadowRoot to update fallback content.\n      else if (ownerRoot && this.localName === 'slot') {\n        allowNativeInsert = false;\n        ownerRoot._asyncRender();\n      }\n    }\n    if (allowNativeInsert) {\n      // if adding to a shadyRoot, add to host instead\n      let container = utils.isShadyRoot(this)\n        ? /** @type {ShadowRoot} */ (this).host\n        : this;\n      // if ref_node, get the ref_node that's actually in composed dom.\n      if (ref_node) {\n        ref_node = firstComposedNode(ref_node);\n        container[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      } else {\n        container[utils.NATIVE_PREFIX + 'appendChild'](node);\n      }\n    }\n    // Since ownerDocument is not patched, it can be incorrect after this call\n    // if the node is physically appended via distribution. This can result\n    // in the custom elements polyfill not upgrading the node if it's in an inert doc.\n    // We correct this by calling `adoptNode`.\n    else if (node.ownerDocument !== this.ownerDocument) {\n      this.ownerDocument.adoptNode(node);\n    }\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   */\n  appendChild(node) {\n    // if this is a shadowRoot and the shadowRoot is passed as `node`\n    // then an optimized append has already been performed, so do nothing.\n    if (!(this == node && utils.isShadyRoot(node))) {\n      return this[utils.SHADY_PREFIX + 'insertBefore'](node);\n    }\n  },\n\n  /**\n   * Patched `removeChild`. Note that all dom \"removals\" are routed here.\n   * Removes the given `node` from the element's `children`.\n   * This method also performs dom composition.\n   * @this {Node}\n   * @param {Node} node\n   * @param {boolean=} skipUnscoping\n   */\n  removeChild(node, skipUnscoping = false) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'removeChild'](node);\n    }\n    if (node[utils.SHADY_PREFIX + 'parentNode'] !== this) {\n      throw Error(\n        'The node to be removed is not a child of this node: ' + node\n      );\n    }\n    scheduleObserver(this, null, node);\n    let preventNativeRemove;\n    let ownerRoot = ownerShadyRootForNode(node);\n    const removingInsertionPoint =\n      ownerRoot && ownerRoot._removeContainedSlots(node);\n    const parentData = shadyDataForNode(this);\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordRemoveChild(node, this);\n      if (utils.hasShadowRootWithSlot(this)) {\n        parentData.root._asyncRender();\n        preventNativeRemove = true;\n      }\n    }\n    // unscope a node leaving a ShadowRoot if ShadyCSS is present, and this node\n    // is not going to be rescoped in `insertBefore`\n    if (\n      getScopingShim() &&\n      !skipUnscoping &&\n      ownerRoot &&\n      node.nodeType !== Node.TEXT_NODE\n    ) {\n      const oldScopeName = currentScopeForNode(node);\n      treeVisitor(node, (node) => {\n        removeShadyScoping(node, oldScopeName);\n      });\n    }\n    removeOwnerShadyRoot(node);\n    // if removing slot, must render containing root\n    if (ownerRoot) {\n      let changeSlotContent = this.localName === 'slot';\n      if (changeSlotContent) {\n        preventNativeRemove = true;\n      }\n      if (removingInsertionPoint || changeSlotContent) {\n        ownerRoot._asyncRender();\n      }\n    }\n    if (!preventNativeRemove) {\n      // if removing from a shadyRoot, remove from host instead\n      let container = utils.isShadyRoot(this)\n        ? /** @type {ShadowRoot} */ (this).host\n        : this;\n      // not guaranteed to physically be in container; e.g.\n      // (1) if parent has a shadyRoot, element may or may not at distributed\n      // location (could be undistributed)\n      // (2) if parent is a slot, element may not ben in composed dom\n      if (\n        !(parentData.root || node.localName === 'slot') ||\n        container === node[utils.NATIVE_PREFIX + 'parentNode']\n      ) {\n        container[utils.NATIVE_PREFIX + 'removeChild'](node);\n      }\n    }\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  replaceChild(node, ref_node) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n    this[utils.SHADY_PREFIX + 'removeChild'](ref_node);\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {boolean=} deep\n   */\n  cloneNode(deep) {\n    if (this.localName == 'template') {\n      return this[utils.NATIVE_PREFIX + 'cloneNode'](deep);\n    } else {\n      const n = this[utils.NATIVE_PREFIX + 'cloneNode'](false);\n      // Attribute nodes historically had childNodes, but they have later\n      // been removed from the spec.\n      // Make sure we do not do a deep clone on them for old browsers (IE11)\n      if (deep && n.nodeType !== Node.ATTRIBUTE_NODE) {\n        for (\n          let c = this[utils.SHADY_PREFIX + 'firstChild'], nc;\n          c;\n          c = c[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          nc = c[utils.SHADY_PREFIX + 'cloneNode'](true);\n          n[utils.SHADY_PREFIX + 'appendChild'](nc);\n        }\n      }\n      return n;\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {Object=} options\n   */\n  // TODO(sorvell): implement `options` e.g. `{ composed: boolean }`\n  getRootNode(options) {\n    if (!this || !this.nodeType) {\n      return;\n    }\n    const nodeData = ensureShadyDataForNode(this);\n    let root = nodeData.ownerShadyRoot;\n    if (root === undefined) {\n      if (utils.isShadyRoot(this)) {\n        root = this;\n        nodeData.ownerShadyRoot = root;\n      } else {\n        let parent = this[utils.SHADY_PREFIX + 'parentNode'];\n        root = parent\n          ? parent[utils.SHADY_PREFIX + 'getRootNode'](options)\n          : this;\n        // memo-ize result for performance but only memo-ize\n        // result if node is in the document. This avoids a problem where a root\n        // can be cached while an element is inside a fragment.\n        // If this happens and we cache the result, the value can become stale\n        // because for perf we avoid processing the subtree of added fragments.\n        if (document.documentElement[utils.NATIVE_PREFIX + 'contains'](this)) {\n          nodeData.ownerShadyRoot = root;\n        }\n      }\n    }\n    return root;\n  },\n\n  /** @this {Node} */\n  contains(node) {\n    return utils.contains(this, node);\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport {calculateSplices} from './array-splice.js';\nimport * as utils from './utils.js';\nimport {enqueue} from './flush.js';\nimport {ensureShadyDataForNode, shadyDataForNode} from './shady-data.js';\nimport {recordChildNodes} from './link-nodes.js';\nimport {patchShadyRoot} from './patch-shadyRoot.js';\n\n// Do not export this object. It must be passed as the first argument to the\n// ShadyRoot constructor in `attachShadow` to prevent the constructor from\n// throwing. This prevents the user from being able to manually construct a\n// ShadyRoot (i.e. `new ShadowRoot()`).\nconst ShadyRootConstructionToken = {};\n\nconst CATCHALL_NAME = '__catchall';\n\nconst MODE_CLOSED = 'closed';\n\nlet isRendering =\n  utils.settings['deferConnectionCallbacks'] &&\n  document.readyState === 'loading';\nlet rootRendered;\n\nfunction ancestorList(node) {\n  let ancestors = [];\n  do {\n    ancestors.unshift(node);\n  } while ((node = node[utils.SHADY_PREFIX + 'parentNode']));\n  return ancestors;\n}\n\n/**\n * @extends {ShadowRoot}\n */\nclass ShadyRoot {\n  constructor(token, host, options) {\n    if (token !== ShadyRootConstructionToken) {\n      throw new TypeError('Illegal constructor');\n    }\n    /** @type {boolean} */\n    this._renderPending;\n    /** @type {boolean} */\n    this._hasRendered;\n    /** @type {?Array<HTMLSlotElement>} */\n    this._slotList = null;\n    /** @type {?Object<string, Array<HTMLSlotElement>>} */\n    this._slotMap;\n    /** @type {?Array<HTMLSlotElement>} */\n    this._pendingSlots;\n    this._init(host, options);\n  }\n\n  _init(host, options) {\n    // root <=> host\n    this.host = host;\n    /** @type {!string|undefined} */\n    this.mode = options && options.mode;\n    recordChildNodes(this.host);\n    const hostData = ensureShadyDataForNode(this.host);\n    /** @type {!ShadyRoot} */\n    hostData.root = this;\n    hostData.publicRoot = this.mode !== MODE_CLOSED ? this : null;\n    // setup root\n    const rootData = ensureShadyDataForNode(this);\n    rootData.firstChild = rootData.lastChild = rootData.parentNode = rootData.nextSibling = rootData.previousSibling = null;\n    // NOTE: optimization flag, only require an asynchronous render\n    // to record parsed children if flag is not set.\n    if (utils.settings['preferPerformance']) {\n      let n;\n      while ((n = this.host[utils.NATIVE_PREFIX + 'firstChild'])) {\n        this.host[utils.NATIVE_PREFIX + 'removeChild'](n);\n      }\n    } else {\n      this._asyncRender();\n    }\n  }\n\n  _asyncRender() {\n    if (!this._renderPending) {\n      this._renderPending = true;\n      enqueue(() => this._render());\n    }\n  }\n\n  // returns the oldest renderPending ancestor root.\n  _getPendingDistributionRoot() {\n    let renderRoot;\n    let root = this;\n    while (root) {\n      if (root._renderPending) {\n        renderRoot = root;\n      }\n      root = root._getDistributionParent();\n    }\n    return renderRoot;\n  }\n\n  // Returns the shadyRoot `this.host` if `this.host`\n  // has children that require distribution.\n  _getDistributionParent() {\n    let root = this.host[utils.SHADY_PREFIX + 'getRootNode']();\n    if (!utils.isShadyRoot(root)) {\n      return;\n    }\n    const nodeData = shadyDataForNode(this.host);\n    if (nodeData && nodeData.__childSlotCount > 0) {\n      return root;\n    }\n  }\n\n  // Renders the top most render pending shadowRoot in the distribution tree.\n  // This is safe because when a distribution parent renders, all children render.\n  _render() {\n    // If this root is not pending, it needs no rendering work. Any pending\n    // parent that needs to render wll cause this root to render.\n    const root = this._renderPending && this._getPendingDistributionRoot();\n    if (root) {\n      root._renderSelf();\n    }\n  }\n\n  _flushInitial() {\n    if (!this._hasRendered && this._renderPending) {\n      this._render();\n    }\n  }\n\n  /** @override */\n  _renderSelf() {\n    // track rendering state.\n    const wasRendering = isRendering;\n    isRendering = true;\n    this._renderPending = false;\n    if (this._slotList) {\n      this._distribute();\n      this._compose();\n    }\n    // NOTE: optimization flag, only process parsed children\n    // if optimization flag is not set.\n    // on initial render remove any undistributed children.\n    if (!utils.settings['preferPerformance'] && !this._hasRendered) {\n      for (\n        let n = this.host[utils.SHADY_PREFIX + 'firstChild'];\n        n;\n        n = n[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        const data = shadyDataForNode(n);\n        if (\n          n[utils.NATIVE_PREFIX + 'parentNode'] === this.host &&\n          (n.localName === 'slot' || !data.assignedSlot)\n        ) {\n          this.host[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n      }\n    }\n    this._hasRendered = true;\n    isRendering = wasRendering;\n    if (rootRendered) {\n      rootRendered();\n    }\n  }\n\n  _distribute() {\n    this._validateSlots();\n    // capture # of previously assigned nodes to help determine if dirty.\n    for (let i = 0, slot; i < this._slotList.length; i++) {\n      slot = this._slotList[i];\n      this._clearSlotAssignedNodes(slot);\n    }\n    // distribute host children.\n    for (\n      let n = this.host[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      this._distributeNodeToSlot(n);\n    }\n    // fallback content, slotchange, and dirty roots\n    for (let i = 0; i < this._slotList.length; i++) {\n      const slot = this._slotList[i];\n      const slotData = shadyDataForNode(slot);\n      // distribute fallback content\n      if (!slotData.assignedNodes.length) {\n        for (\n          let n = slot[utils.SHADY_PREFIX + 'firstChild'];\n          n;\n          n = n[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          this._distributeNodeToSlot(n, slot);\n        }\n      }\n      const slotParentData = shadyDataForNode(\n        slot[utils.SHADY_PREFIX + 'parentNode']\n      );\n      const slotParentRoot = slotParentData && slotParentData.root;\n      if (\n        slotParentRoot &&\n        (slotParentRoot._hasInsertionPoint() || slotParentRoot._renderPending)\n      ) {\n        slotParentRoot._renderSelf();\n      }\n      this._addAssignedToFlattenedNodes(\n        slotData.flattenedNodes,\n        slotData.assignedNodes\n      );\n      let prevAssignedNodes = slotData._previouslyAssignedNodes;\n      if (prevAssignedNodes) {\n        for (let i = 0; i < prevAssignedNodes.length; i++) {\n          shadyDataForNode(prevAssignedNodes[i])._prevAssignedSlot = null;\n        }\n        slotData._previouslyAssignedNodes = null;\n        // dirty if previously less assigned nodes than previously assigned.\n        if (prevAssignedNodes.length > slotData.assignedNodes.length) {\n          slotData.dirty = true;\n        }\n      }\n      /* Note: A slot is marked dirty whenever a node is newly assigned to it\n      or a node is assigned to a different slot (done in `_distributeNodeToSlot`)\n      or if the number of nodes assigned to the slot has decreased (done above);\n      */\n      if (slotData.dirty) {\n        slotData.dirty = false;\n        this._fireSlotChange(slot);\n      }\n    }\n  }\n\n  /**\n   * Distributes given `node` to the appropriate slot based on its `slot`\n   * attribute. If `forcedSlot` is given, then the node is distributed to the\n   * `forcedSlot`.\n   * Note: slot to which the node is assigned will be marked dirty for firing\n   * `slotchange`.\n   * @param {Node} node\n   * @param {Node=} forcedSlot\n   *\n   */\n  _distributeNodeToSlot(node, forcedSlot) {\n    const nodeData = ensureShadyDataForNode(node);\n    let oldSlot = nodeData._prevAssignedSlot;\n    nodeData._prevAssignedSlot = null;\n    let slot = forcedSlot;\n    if (!slot) {\n      let name = node[utils.SHADY_PREFIX + 'slot'] || CATCHALL_NAME;\n      const list = this._slotMap[name];\n      slot = list && list[0];\n    }\n    if (slot) {\n      const slotData = ensureShadyDataForNode(slot);\n      slotData.assignedNodes.push(node);\n      nodeData.assignedSlot = slot;\n    } else {\n      nodeData.assignedSlot = undefined;\n    }\n    if (oldSlot !== nodeData.assignedSlot) {\n      if (nodeData.assignedSlot) {\n        ensureShadyDataForNode(nodeData.assignedSlot).dirty = true;\n      }\n    }\n  }\n\n  /**\n   * Clears the assignedNodes tracking data for a given `slot`. Note, the current\n   * assigned node data is tracked (via _previouslyAssignedNodes and\n   * _prevAssignedSlot) to see if `slotchange` should fire. This data may be out\n   *  of date at this time because the assigned nodes may have already been\n   * distributed to another root. This is ok since this data is only used to\n   * track changes.\n   * @param {HTMLSlotElement} slot\n   */\n  _clearSlotAssignedNodes(slot) {\n    const slotData = shadyDataForNode(slot);\n    let n$ = slotData.assignedNodes;\n    slotData.assignedNodes = [];\n    slotData.flattenedNodes = [];\n    slotData._previouslyAssignedNodes = n$;\n    if (n$) {\n      for (let i = 0; i < n$.length; i++) {\n        let n = shadyDataForNode(n$[i]);\n        n._prevAssignedSlot = n.assignedSlot;\n        // only clear if it was previously set to this slot;\n        // this helps ensure that if the node has otherwise been distributed\n        // ignore it.\n        if (n.assignedSlot === slot) {\n          n.assignedSlot = null;\n        }\n      }\n    }\n  }\n\n  _addAssignedToFlattenedNodes(flattened, assigned) {\n    for (let i = 0, n; i < assigned.length && (n = assigned[i]); i++) {\n      if (n.localName == 'slot') {\n        const nestedAssigned = shadyDataForNode(n).assignedNodes;\n        if (nestedAssigned && nestedAssigned.length) {\n          this._addAssignedToFlattenedNodes(flattened, nestedAssigned);\n        }\n      } else {\n        flattened.push(assigned[i]);\n      }\n    }\n  }\n\n  _fireSlotChange(slot) {\n    // NOTE: cannot bubble correctly here so not setting bubbles: true\n    // Safari tech preview does not bubble but chrome does\n    // Spec says it bubbles (https://dom.spec.whatwg.org/#mutation-observers)\n    slot[utils.NATIVE_PREFIX + 'dispatchEvent'](new Event('slotchange'));\n    const slotData = shadyDataForNode(slot);\n    if (slotData.assignedSlot) {\n      this._fireSlotChange(slotData.assignedSlot);\n    }\n  }\n\n  // Reify dom such that it is at its correct rendering position\n  // based on logical distribution.\n  // NOTE: here we only compose parents of <slot> elements and not the\n  // shadowRoot into the host. The latter is performend via a fast path\n  // in the `logical-mutation`.insertBefore.\n  _compose() {\n    const slots = this._slotList;\n    let composeList = [];\n    for (let i = 0; i < slots.length; i++) {\n      const parent = slots[i][utils.SHADY_PREFIX + 'parentNode'];\n      /* compose node only if:\n        (1) parent does not have a shadowRoot since shadowRoot has already\n        composed into the host\n        (2) we're not already composing it\n        [consider (n^2) but rare better than Set]\n      */\n      const parentData = shadyDataForNode(parent);\n      if (!(parentData && parentData.root) && composeList.indexOf(parent) < 0) {\n        composeList.push(parent);\n      }\n    }\n    for (let i = 0; i < composeList.length; i++) {\n      const node = composeList[i];\n      const targetNode = node === this ? this.host : node;\n      this._updateChildNodes(targetNode, this._composeNode(node));\n    }\n  }\n\n  // Returns the list of nodes which should be rendered inside `node`.\n  _composeNode(node) {\n    let children = [];\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      // Note: if we see a slot here, the nodes are guaranteed to need to be\n      // composed here. This is because if there is redistribution, it has\n      // already been handled by this point.\n      if (this._isInsertionPoint(n)) {\n        let flattenedNodes = shadyDataForNode(n).flattenedNodes;\n        for (let j = 0; j < flattenedNodes.length; j++) {\n          let distributedNode = flattenedNodes[j];\n          children.push(distributedNode);\n        }\n      } else {\n        children.push(n);\n      }\n    }\n    return children;\n  }\n\n  _isInsertionPoint(node) {\n    return node.localName == 'slot';\n  }\n\n  // Ensures that the rendered node list inside `container` is `children`.\n  _updateChildNodes(container, children) {\n    let composed = utils.nativeChildNodesArray(container);\n    let splices = calculateSplices(children, composed);\n    // process removals\n    for (let i = 0, d = 0, s; i < splices.length && (s = splices[i]); i++) {\n      for (let j = 0, n; j < s.removed.length && (n = s.removed[j]); j++) {\n        // check if the node is still where we expect it is before trying\n        // to remove it; this can happen if we move a node and\n        // then schedule its previous host for distribution resulting in\n        // the node being removed here.\n        if (n[utils.NATIVE_PREFIX + 'parentNode'] === container) {\n          container[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n        // TODO(sorvell): avoid the need for splicing here.\n        composed.splice(s.index + d, 1);\n      }\n      d -= s.addedCount;\n    }\n    // process adds\n    for (let i = 0, s, next; i < splices.length && (s = splices[i]); i++) {\n      // eslint-disable-line no-redeclare\n      next = composed[s.index];\n      for (let j = s.index, n; j < s.index + s.addedCount; j++) {\n        n = children[j];\n        container[utils.NATIVE_PREFIX + 'insertBefore'](n, next);\n        composed.splice(j, 0, n);\n      }\n    }\n  }\n\n  _ensureSlotData() {\n    this._pendingSlots = this._pendingSlots || [];\n    this._slotList = this._slotList || [];\n    this._slotMap = this._slotMap || {};\n  }\n\n  _addSlots(slots) {\n    this._ensureSlotData();\n    this._pendingSlots.push(...slots);\n  }\n\n  _validateSlots() {\n    if (this._pendingSlots && this._pendingSlots.length) {\n      this._mapSlots(this._pendingSlots);\n      this._pendingSlots = [];\n    }\n  }\n\n  /**\n   * Adds the given slots. Slots are maintained in an dom-ordered list.\n   * In addition a map of name to slot is updated.\n   */\n  _mapSlots(slots) {\n    let slotNamesToSort;\n    for (let i = 0; i < slots.length; i++) {\n      const slot = slots[i];\n      // ensure insertionPoints's and their parents have logical dom info.\n      // save logical tree info\n      // a. for shadyRoot\n      // b. for insertion points (fallback)\n      // c. for parents of insertion points\n      recordChildNodes(slot);\n      const slotParent = slot[utils.SHADY_PREFIX + 'parentNode'];\n      recordChildNodes(slotParent);\n      const slotParentData = shadyDataForNode(slotParent);\n      slotParentData.__childSlotCount =\n        (slotParentData.__childSlotCount || 0) + 1;\n      let name = this._nameForSlot(slot);\n      if (this._slotMap[name]) {\n        slotNamesToSort = slotNamesToSort || {};\n        slotNamesToSort[name] = true;\n        this._slotMap[name].push(slot);\n      } else {\n        this._slotMap[name] = [slot];\n      }\n      this._slotList.push(slot);\n    }\n    if (slotNamesToSort) {\n      for (let n in slotNamesToSort) {\n        this._slotMap[n] = this._sortSlots(this._slotMap[n]);\n      }\n    }\n  }\n\n  _nameForSlot(slot) {\n    const name = slot['name'] || slot.getAttribute('name') || CATCHALL_NAME;\n    slot.__slotName = name;\n    return name;\n  }\n\n  /**\n   * Slots are kept in an ordered list. Slots with the same name\n   * are sorted here by tree order.\n   */\n  _sortSlots(slots) {\n    // NOTE: Cannot use `compareDocumentPosition` because it's not polyfilled,\n    // but the code here could be used to polyfill the preceeding/following info\n    // in `compareDocumentPosition`.\n    return slots.sort((a, b) => {\n      let listA = ancestorList(a);\n      let listB = ancestorList(b);\n      for (var i = 0; i < listA.length; i++) {\n        let nA = listA[i];\n        let nB = listB[i];\n        if (nA !== nB) {\n          let c$ = utils.childNodesArray(nA[utils.SHADY_PREFIX + 'parentNode']);\n          return c$.indexOf(nA) - c$.indexOf(nB);\n        }\n      }\n    });\n  }\n\n  /**\n   * Removes from tracked slot data any slots contained within `container` and\n   * then updates the tracked data (_slotList and _slotMap).\n   * Any removed slots also have their `assignedNodes` removed from comopsed dom.\n   */\n  _removeContainedSlots(container) {\n    if (!this._slotList) {\n      return;\n    }\n    this._validateSlots();\n    let didRemove;\n    const map = this._slotMap;\n    for (let n in map) {\n      const slots = map[n];\n      for (let i = 0; i < slots.length; i++) {\n        const slot = slots[i];\n        if (utils.contains(container, slot)) {\n          slots.splice(i, 1);\n          const x = this._slotList.indexOf(slot);\n          if (x >= 0) {\n            this._slotList.splice(x, 1);\n            const slotParentData = shadyDataForNode(\n              slot[utils.SHADY_PREFIX + 'parentNode']\n            );\n            if (slotParentData && slotParentData.__childSlotCount) {\n              slotParentData.__childSlotCount--;\n            }\n          }\n          i--;\n          this._removeFlattenedNodes(slot);\n          didRemove = true;\n        }\n      }\n    }\n    return didRemove;\n  }\n\n  _updateSlotName(slot) {\n    if (!this._slotList) {\n      return;\n    }\n    // make sure slotMap is initialized with this slot\n    this._validateSlots();\n    const oldName = slot.__slotName;\n    const name = this._nameForSlot(slot);\n    if (name === oldName) {\n      return;\n    }\n    // remove from existing tracking\n    let slots = this._slotMap[oldName];\n    const i = slots.indexOf(slot);\n    if (i >= 0) {\n      slots.splice(i, 1);\n    }\n    // add to new location and sort if nedessary\n    let list = this._slotMap[name] || (this._slotMap[name] = []);\n    list.push(slot);\n    if (list.length > 1) {\n      this._slotMap[name] = this._sortSlots(list);\n    }\n  }\n\n  _removeFlattenedNodes(slot) {\n    const data = shadyDataForNode(slot);\n    let n$ = data.flattenedNodes;\n    if (n$) {\n      for (let i = 0; i < n$.length; i++) {\n        let node = n$[i];\n        let parent = node[utils.NATIVE_PREFIX + 'parentNode'];\n        if (parent) {\n          parent[utils.NATIVE_PREFIX + 'removeChild'](node);\n        }\n      }\n    }\n    data.flattenedNodes = [];\n    data.assignedNodes = [];\n  }\n\n  _hasInsertionPoint() {\n    this._validateSlots();\n    return Boolean(this._slotList && this._slotList.length);\n  }\n}\n\npatchShadyRoot(ShadyRoot.prototype);\nexport {ShadyRoot};\n\n/**\n  Implements a pared down version of ShadowDOM's scoping, which is easy to\n  polyfill across browsers.\n*/\nexport const attachShadow = (host, options) => {\n  if (!host) {\n    throw new Error('Must provide a host.');\n  }\n  if (!options) {\n    throw new Error('Not enough arguments.');\n  }\n  let root;\n  // Optimization for booting up a shadowRoot from a fragment rather than\n  // creating one.\n  if (options['shadyUpgradeFragment'] && utils.canUpgrade()) {\n    root = options['shadyUpgradeFragment'];\n    root.__proto__ = ShadowRoot.prototype;\n    root._init(host, options);\n    recordChildNodes(root, root);\n    // Note: qsa is native when used with noPatch.\n    /** @type {?NodeList<Element>} */\n    const slotsAdded = root['__noInsertionPoint']\n      ? null\n      : root.querySelectorAll('slot');\n    // Reset scoping information so normal scoing rules apply after this.\n    root['__noInsertionPoint'] = undefined;\n    // if a slot is added, must render containing root.\n    if (slotsAdded && slotsAdded.length) {\n      root._addSlots(slotsAdded);\n      root._asyncRender();\n    }\n    /** @type {ShadowRoot} */ (root).host[utils.NATIVE_PREFIX + 'appendChild'](\n      root\n    );\n  } else {\n    root = new ShadyRoot(ShadyRootConstructionToken, host, options);\n  }\n  return root;\n};\n\n// Mitigate connect/disconnect spam by wrapping custom element classes. This\n// should happen if custom elements are available in any capacity, polyfilled or\n// not.\nif (\n  utils.hasCustomElements() &&\n  utils.settings.inUse &&\n  !utils.settings['preferPerformance']\n) {\n  // process connect/disconnect after roots have rendered to avoid\n  // issues with reaction stack.\n  let connectMap = new Map();\n  rootRendered = function () {\n    // allow elements to connect\n    // save map state (without needing polyfills on IE11)\n    const r = [];\n    connectMap.forEach((v, k) => {\n      r.push([k, v]);\n    });\n    connectMap.clear();\n    for (let i = 0; i < r.length; i++) {\n      const e = r[i][0],\n        value = r[i][1];\n      if (value) {\n        e['__shadydom_connectedCallback']();\n      } else {\n        e['__shadydom_disconnectedCallback']();\n      }\n    }\n  };\n\n  // Document is in loading state and flag is set (deferConnectionCallbacks)\n  // so process connection stack when `readystatechange` fires.\n  if (isRendering) {\n    document.addEventListener(\n      'readystatechange',\n      () => {\n        isRendering = false;\n        rootRendered();\n      },\n      {once: true}\n    );\n  }\n\n  /*\n   * (1) elements can only be connected/disconnected if they are in the expected\n   * state.\n   * (2) never run connect/disconnect during rendering to avoid reaction stack issues.\n   */\n  const ManageConnect = (base, connected, disconnected) => {\n    let counter = 0;\n    const connectFlag = `__isConnected${counter++}`;\n    if (connected || disconnected) {\n      /** @this {!HTMLElement} */\n      base.prototype.connectedCallback = base.prototype[\n        '__shadydom_connectedCallback'\n      ] = function () {\n        // if rendering defer connected\n        // otherwise connect only if we haven't already\n        if (isRendering) {\n          connectMap.set(this, true);\n        } else if (!this[connectFlag]) {\n          this[connectFlag] = true;\n          if (connected) {\n            connected.call(this);\n          }\n        }\n      };\n\n      /** @this {!HTMLElement} */\n      base.prototype.disconnectedCallback = base.prototype[\n        '__shadydom_disconnectedCallback'\n      ] = function () {\n        // if rendering, cancel a pending connection and queue disconnect,\n        // otherwise disconnect only if a connection has been allowed\n        if (isRendering) {\n          // This is necessary only because calling removeChild\n          // on a node that requires distribution leaves it in the DOM tree\n          // until distribution.\n          // NOTE: remember this is checking the patched isConnected to determine\n          // if the node is in the logical tree.\n          if (!this.isConnected) {\n            connectMap.set(this, false);\n          }\n        } else if (this[connectFlag]) {\n          this[connectFlag] = false;\n          if (disconnected) {\n            disconnected.call(this);\n          }\n        }\n      };\n    }\n\n    return base;\n  };\n\n  const originalDefine = window['customElements']['define'];\n  const define = function (name, constructor) {\n    const connected = constructor.prototype.connectedCallback;\n    const disconnected = constructor.prototype.disconnectedCallback;\n    originalDefine.call(\n      window['customElements'],\n      name,\n      ManageConnect(constructor, connected, disconnected)\n    );\n    // unpatch connected/disconnected on class; custom elements tears this off\n    // so the patch is maintained, but if the user calls these methods for\n    // e.g. testing, they will be as expected.\n    constructor.prototype.connectedCallback = connected;\n    constructor.prototype.disconnectedCallback = disconnected;\n  };\n  // Note, it would be better to only patch the CustomElementRegistry.prototype,\n  // but ShadyCSS patches define directly.\n  window.customElements.define = define;\n  // Still patch the registry directly since Safari 10 loses the patch\n  // unless this is done.\n  Object.defineProperty(window['CustomElementRegistry'].prototype, 'define', {\n    value: define,\n    configurable: true,\n  });\n}\n\n/** @return {!ShadyRoot|undefined} */\nexport const ownerShadyRootForNode = (node) => {\n  let root = node[utils.SHADY_PREFIX + 'getRootNode']();\n  if (utils.isShadyRoot(root)) {\n    return root;\n  }\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const SlotablePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get assignedSlot() {\n    // Force any parent's shadowRoot to flush so that distribution occurs\n    // and this node has an assignedSlot.\n    const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n    const ownerRoot = parent && parent[utils.SHADY_PREFIX + 'shadowRoot'];\n    if (ownerRoot) {\n      ownerRoot._render();\n    }\n    const nodeData = shadyDataForNode(this);\n    return (nodeData && nodeData.assignedSlot) || null;\n  },\n});\n","/**\n * @license\n * Copyright (c) 2022 The Polymer Project Authors\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * A map describing parentheses-like grouping characters and their behavior. The\n * keys are the group's start character and the value's `end` property contains\n * the end character. The `matchNestedParens` property indicates whether or not\n * other grouping characters nested in the group retain their grouping behavior\n * within that group - i.e. if nested grouping characters need to be matched.\n *\n * @type {!Map<string, {end: string, matchNestedParens: boolean}>}\n */\nconst PARENS = new Map();\n// IE 11 doesn't support `Map`'s constructor parameter.\n[\n  ['(', {end: ')', matchNestedParens: true}],\n  ['[', {end: ']', matchNestedParens: true}],\n  ['\"', {end: '\"', matchNestedParens: false}],\n  [\"'\", {end: \"'\", matchNestedParens: false}],\n].forEach(([k, v]) => {\n  PARENS.set(k, v);\n});\n\n/**\n * Finds the first character of `queryChars` within `str` from index `start`\n * onwards that is _not_ nested within any parentheses, brackets, or\n * single/double-quoted strings or part of an escape sequence.\n *\n * If the end of the string is reached without finding a character in\n * `queryChars`, the length of the string is returned.\n *\n * @param {string} str\n * @param {number} start\n * @param {!Array<string>} queryChars\n * @param {boolean} matchNestedParens\n * @return {number}\n */\nconst findNext = (str, start, queryChars, matchNestedParens = true) => {\n  for (let i = start; i < str.length; i++) {\n    if (str[i] === '\\\\' && i < str.length - 1 && str[i + 1] !== '\\n') {\n      // Skip escape sequences.\n      i++;\n    } else if (queryChars.indexOf(str[i]) !== -1) {\n      // One of `queryChars` was found.\n      return i;\n    } else if (matchNestedParens && PARENS.has(str[i])) {\n      // Handle any grouping characters by skipping over the group.\n      const parenInfo = PARENS.get(str[i]);\n      i = findNext(str, i + 1, [parenInfo.end], parenInfo.matchNestedParens);\n      continue;\n    }\n\n    // Do nothing, let `i++` happen.\n  }\n\n  // Reached the end of the string without finding a final char.\n  return str.length;\n};\n\n/**\n * Arrays of compound selectors and combinators that form a complex selector\n * when interleaved.\n *\n * @typedef {{\n *   compoundSelectors: !Array<string>,\n *   combinators: !Array<string>,\n * }}\n */\nexport let ComplexSelectorParts;\n\n/**\n * Splits a selector list into individual complex selectors and creates a\n * `ComplexSelectorParts` for each.\n *\n * @param {string} str\n * @return {!Array<!ComplexSelectorParts>}\n */\nexport const parseSelectorList = (str) => {\n  /**\n   * @type {!Array<!ComplexSelectorParts>}\n   */\n  const results = [];\n\n  /**\n   * Compound selectors and combinators parsed from the current complex\n   * selector.\n   *\n   * @type {!Array<string>}\n   */\n  const chunks = [];\n\n  /**\n   * Creates a new `ComplexSelectorParts` from the current `chunks`, pushes it\n   * into `results` and resets `chunks`.\n   */\n  const endComplexSelector = () => {\n    if (chunks.length > 0) {\n      while (chunks[chunks.length - 1] === ' ') {\n        chunks.pop();\n      }\n      results.push({\n        compoundSelectors: chunks.filter((x, i) => i % 2 === 0),\n        combinators: chunks.filter((x, i) => i % 2 === 1),\n      });\n      chunks.length = 0;\n    }\n  };\n\n  for (let i = 0; i < str.length; ) {\n    const prevChunk = chunks[chunks.length - 1];\n    // `nextIndex` is the next complex selector boundary, combinator, or\n    // whitespace that isn't inside other grouping characters.\n    const nextIndex = findNext(str, i, [',', ' ', '>', '+', '~']);\n    // If `nextIndex` is `i`, then the chunk we're considering is only the next\n    // single character.\n    const nextChunk = nextIndex === i ? str[i] : str.substring(i, nextIndex);\n\n    if (nextChunk === ',') {\n      endComplexSelector();\n    } else if (\n      [undefined, ' ', '>', '+', '~'].indexOf(prevChunk) !== -1 &&\n      nextChunk === ' '\n    ) {\n      // Ignore leading whitespace and whitespace directly after combinators.\n    } else if (prevChunk === ' ' && ['>', '+', '~'].indexOf(nextChunk) !== -1) {\n      // If the last chunk was whitespace and this chunk is a non-whitespace\n      // combinator, replace the whitespace with this combinator.\n      chunks[chunks.length - 1] = nextChunk;\n    } else {\n      chunks.push(nextChunk);\n    }\n\n    i = nextIndex + (nextIndex === i ? 1 : 0);\n  }\n\n  endComplexSelector();\n\n  return results;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {ComplexSelectorParts, parseSelectorList} from '../selector-parser.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/**\n * @param {Node} node\n * @param {Function} matcher\n * @param {Function=} halter\n */\nexport function query(node, matcher, halter) {\n  let list = [];\n  queryChildNodes(node, matcher, halter, list);\n  return list;\n}\n\nfunction queryChildNodes(parent, matcher, halter, list) {\n  for (\n    let n = parent[utils.SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[utils.SHADY_PREFIX + 'nextSibling']\n  ) {\n    if (\n      n.nodeType === Node.ELEMENT_NODE &&\n      queryElement(n, matcher, halter, list)\n    ) {\n      return true;\n    }\n  }\n}\n\nfunction queryElement(node, matcher, halter, list) {\n  let result = matcher(node);\n  if (result) {\n    list.push(node);\n  }\n  if (halter && halter(result)) {\n    return result;\n  }\n  queryChildNodes(node, matcher, halter, list);\n}\n\n// Needed on Element, DocumentFragment, Document\nexport const ParentNodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get firstElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.firstChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'firstChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'firstElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get lastElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.lastChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'lastChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'lastElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get children() {\n    if (!utils.isTrackingLogicalChildNodes(this)) {\n      return this[utils.NATIVE_PREFIX + 'children'];\n    }\n    return utils.createPolyfilledHTMLCollection(\n      Array.prototype.filter.call(utils.childNodesArray(this), (n) => {\n        return n.nodeType === Node.ELEMENT_NODE;\n      })\n    );\n  },\n\n  /** @this {Element} */\n  get childElementCount() {\n    let children = this[utils.SHADY_PREFIX + 'children'];\n    if (children) {\n      return children.length;\n    }\n    return 0;\n  },\n\n  /** @this {Element} */\n  append(...args) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      null\n    );\n  },\n\n  /** @this {Element} */\n  prepend(...args) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      this[utils.SHADY_PREFIX + 'firstChild']\n    );\n  },\n\n  /** @this {Element} */\n  ['replaceChildren'](...args) {\n    let child;\n    while ((child = this[utils.SHADY_PREFIX + 'firstChild']) !== null) {\n      this[utils.SHADY_PREFIX + 'removeChild'](child);\n    }\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      null\n    );\n  },\n});\n\n/**\n * Performs the equivalent of `querySelectorAll` within Shady DOM's logical\n * model of the tree for a selector list.\n *\n * See <./logicalQuerySelectorAll.md> for implementation details.\n *\n * @param {!ParentNode} contextNode\n * @param {string} selectorList\n * @return {!Array<!Element>}\n */\nconst logicalQuerySelectorAll = (contextNode, selectorList) => {\n  /**\n   * @type {!Array<!ComplexSelectorParts>}\n   */\n  const complexSelectors = parseSelectorList(selectorList);\n\n  if (complexSelectors.length < 1) {\n    return [];\n  }\n\n  /**\n   * Determines if a single compound selector matches an element. If the\n   * selector contains `:scope` (as a substring), then the selector only is only\n   * considered matching if `element` is `contextNode`.\n   *\n   * @param {!Element} element\n   * @param {string} compoundSelector\n   * @return {boolean}\n   */\n  const matchesCompoundSelector = (element, compoundSelector) => {\n    return (\n      (element === contextNode || compoundSelector.indexOf(':scope') === -1) &&\n      utils.matchesSelector(element, compoundSelector)\n    );\n  };\n\n  /**\n   * An object used to track the current position of a potential selector match.\n   *\n   * - `target` is the element that would be considered matching if the cursor\n   * eventually results in a complete match.\n   *\n   * - `complexSelectorParts` is the parsed representation of the complex\n   * selector that this cursor is attempting to match.\n   *\n   * - `index` is the index into `.complexSelectorParts.compoundSelectors` of\n   * the last successfully matched compound selector.\n   *\n   * - `matchedElement` is the element that successfully matched the compound\n   * selector in `.complexSelectorParts.compoundSelectors` at `index`.\n   *\n   * @typedef {{\n   *   target: !Element,\n   *   complexSelectorParts: !ComplexSelectorParts,\n   *   matchedElement: !Element,\n   *   index: number,\n   * }}\n   */\n  let SelectorMatchingCursor; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n  /**\n   * The list of `SelectorMatchingCursor`s, initialized with cursors pointing at\n   * all descendants of `contextNode` that match the last compound selector in\n   * any complex selector in `selectorList`.\n   *\n   * @type {!Array<!SelectorMatchingCursor>}\n   */\n  let cursors = utils.flat(\n    query(contextNode, (_element) => true).map((element) => {\n      return utils.flat(\n        complexSelectors.map((complexSelectorParts) => {\n          const {compoundSelectors} = complexSelectorParts;\n          // Selectors are matched by iterating their compound selectors in\n          // reverse order for efficiency. In particular, when finding\n          // candidates for the descendant combinator, iterating forwards would\n          // imply needing to walk all descendants of the last matched element\n          // for possible candidates, but iterating backwards only requires\n          // walking up the ancestor chain.\n          const index = compoundSelectors.length - 1;\n          if (matchesCompoundSelector(element, compoundSelectors[index])) {\n            return {\n              target: element,\n              complexSelectorParts,\n              matchedElement: element,\n              index,\n            };\n          } else {\n            return [];\n          }\n        })\n      );\n    })\n  );\n\n  // At each step, any remaining cursors that have not finished matching (i.e.\n  // with `cursor.index > 0`) should be replaced with new cursors for any valid\n  // candidates that match the next compound selector.\n  while (cursors.some((cursor) => cursor.index > 0)) {\n    cursors = utils.flat(\n      cursors.map((cursor) => {\n        // Cursors with `index` of 0 have already matched and should not be\n        // replaced or removed.\n        if (cursor.index <= 0) {\n          return cursor;\n        }\n\n        const {\n          target,\n          matchedElement,\n          complexSelectorParts,\n          index: lastIndex,\n        } = cursor;\n        const index = lastIndex - 1;\n        const combinator = complexSelectorParts.combinators[index];\n        const compoundSelector = complexSelectorParts.compoundSelectors[index];\n\n        if (combinator === ' ') {\n          const results = [];\n\n          // For `a b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are all ancestors of each\n          // cursor's `matchedElement`.\n          for (\n            let ancestor = matchedElement[utils.SHADY_PREFIX + 'parentElement'];\n            ancestor;\n            ancestor = ancestor[utils.SHADY_PREFIX + 'parentElement']\n          ) {\n            if (matchesCompoundSelector(ancestor, compoundSelector)) {\n              results.push({\n                target,\n                complexSelectorParts,\n                matchedElement: ancestor,\n                index,\n              });\n            }\n          }\n\n          return results;\n        } else if (combinator === '>') {\n          const parent = matchedElement[utils.SHADY_PREFIX + 'parentElement'];\n\n          // For `a > b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are the parents of each\n          // cursor's `matchedElement`.\n          if (matchesCompoundSelector(parent, compoundSelector)) {\n            return {\n              target,\n              complexSelectorParts,\n              matchedElement: parent,\n              index,\n            };\n          }\n\n          return [];\n        } else if (combinator === '+') {\n          const sibling =\n            matchedElement[utils.SHADY_PREFIX + 'previousElementSibling'];\n\n          // For `a + b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are the immediately\n          // preceding siblings of each cursor's `matchedElement`.\n          if (sibling && matchesCompoundSelector(sibling, compoundSelector)) {\n            return {\n              target,\n              complexSelectorParts,\n              matchedElement: sibling,\n              index,\n            };\n          }\n\n          return [];\n        } else if (combinator === '~') {\n          const results = [];\n\n          // For `a ~ b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are all preceding siblings\n          // of each cursor's `matchedElement`.\n          for (\n            let sibling =\n              matchedElement[utils.SHADY_PREFIX + 'previousElementSibling'];\n            sibling;\n            sibling = sibling[utils.SHADY_PREFIX + 'previousElementSibling']\n          ) {\n            if (matchesCompoundSelector(sibling, compoundSelector)) {\n              results.push({\n                target,\n                complexSelectorParts,\n                matchedElement: sibling,\n                index,\n              });\n            }\n          }\n\n          return results;\n        } else {\n          // As of writing, there are no other combinators:\n          // <https://drafts.csswg.org/selectors/#combinators>\n          throw new Error(`Unrecognized combinator: '${combinator}'.`);\n        }\n      })\n    );\n  }\n\n  // Map remaining cursors to their `target` and deduplicate.\n  return utils.deduplicate(cursors.map(({target}) => target));\n};\n\nconst querySelectorImplementation =\n  utils.settings['querySelectorImplementation'];\n\nexport const QueryPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {!ParentNode}\n   * @param {string} selector\n   */\n  querySelector(selector) {\n    if (querySelectorImplementation === 'native') {\n      // Polyfilled `ShadowRoot`s don't have a native `querySelectorAll`.\n      const target =\n        this instanceof ShadowRoot\n          ? /** @type {!ShadowRoot} */ (this).host\n          : this;\n      const candidates = Array.prototype.slice.call(\n        target[utils.NATIVE_PREFIX + 'querySelectorAll'](selector)\n      );\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      // This could use `find`, but Closure doesn't polyfill it.\n      for (const candidate of candidates) {\n        if (candidate[utils.SHADY_PREFIX + 'getRootNode']() == root) {\n          return candidate;\n        }\n      }\n      return null;\n    } else if (querySelectorImplementation === 'selectorEngine') {\n      return logicalQuerySelectorAll(this, selector)[0] || null;\n    } else if (querySelectorImplementation === undefined) {\n      // match selector and halt on first result.\n      let result = query(\n        this,\n        function (n) {\n          return utils.matchesSelector(n, selector);\n        },\n        function (n) {\n          return Boolean(n);\n        }\n      )[0];\n      return result || null;\n    } else {\n      throw new Error(\n        'Unrecognized value of ShadyDOM.querySelectorImplementation: ' +\n          `'${querySelectorImplementation}'`\n      );\n    }\n  },\n\n  /**\n   * @this {!ParentNode}\n   * @param {string} selector\n   * @param {boolean} useNative\n   */\n  querySelectorAll(selector, useNative) {\n    if (useNative || querySelectorImplementation === 'native') {\n      // Polyfilled `ShadowRoot`s don't have a native `querySelectorAll`.\n      const target =\n        this instanceof ShadowRoot\n          ? /** @type {!ShadowRoot} */ (this).host\n          : this;\n      const candidates = Array.prototype.slice.call(\n        target[utils.NATIVE_PREFIX + 'querySelectorAll'](selector)\n      );\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      return utils.createPolyfilledHTMLCollection(\n        candidates.filter(\n          (e) => e[utils.SHADY_PREFIX + 'getRootNode']() == root\n        )\n      );\n    } else if (querySelectorImplementation === 'selectorEngine') {\n      return utils.createPolyfilledHTMLCollection(\n        logicalQuerySelectorAll(this, selector)\n      );\n    } else if (querySelectorImplementation === undefined) {\n      return utils.createPolyfilledHTMLCollection(\n        query(this, function (n) {\n          return utils.matchesSelector(n, selector);\n        })\n      );\n    } else {\n      throw new Error(\n        'Unrecognized value of ShadyDOM.querySelectorImplementation: ' +\n          `'${querySelectorImplementation}'`\n      );\n    }\n  },\n});\n\n// In preferPerformance mode, create a custom `ParentNodeDocumentOrFragment`\n// that optionally does not mixin querySelector/All; this is a performance\n// optimization. In noPatch, we need to keep the query patches here in order to\n// ensure the query API is available on the wrapper\nexport const ParentNodeDocumentOrFragmentPatches =\n  utils.settings.preferPerformance && !utils.settings.noPatch\n    ? utils.assign({}, ParentNodePatches)\n    : ParentNodePatches;\n\nutils.assign(ParentNodePatches, QueryPatches);\n","/**\n@license\nCopyright (c) 2020 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ChildNodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  after(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    const nextSibling = this[utils.SHADY_PREFIX + 'nextSibling'];\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      nextSibling\n    );\n  },\n\n  /** @this {Element} */\n  before(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      this\n    );\n  },\n\n  /** @this {Element} */\n  remove() {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    parentNode[utils.SHADY_PREFIX + 'removeChild'](this);\n  },\n\n  /** @this {Element} */\n  replaceWith(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    const nextSibling = this[utils.SHADY_PREFIX + 'nextSibling'];\n    parentNode[utils.SHADY_PREFIX + 'removeChild'](this);\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      nextSibling\n    );\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {scopeClassAttribute} from '../style-scoping.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {attachShadow, ownerShadyRootForNode} from '../attach-shadow.js';\n// prettier-ignore\nimport {eventPropertyNamesForElement, wrappedDescriptorForEventProperty} from '../patch-events.js';\n\nconst doc = window.document;\n\n/**\n * Should be called whenever an attribute changes. If the `slot` attribute\n * changes, provokes rendering if necessary. If a `<slot>` element's `name`\n * attribute changes, updates the root's slot map and renders.\n * @param {Node} node\n * @param {string} name\n */\nfunction distributeAttributeChange(node, name) {\n  if (name === 'slot') {\n    const parent = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (utils.hasShadowRootWithSlot(parent)) {\n      shadyDataForNode(parent).root._asyncRender();\n    }\n  } else if (node.localName === 'slot' && name === 'name') {\n    let root = ownerShadyRootForNode(node);\n    if (root) {\n      root._updateSlotName(node);\n      root._asyncRender();\n    }\n  }\n}\n\nexport const ElementPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get previousElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.previousSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'previousSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'previousElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get nextElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.nextSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'nextSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'nextElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get slot() {\n    return this.getAttribute('slot');\n  },\n\n  /** @this {Element} */\n  set slot(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('slot', value);\n  },\n\n  /** @this {Element} */\n  get className() {\n    return this.getAttribute('class') || '';\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('class', value);\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {string} value\n   */\n  setAttribute(attr, value) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n    } else if (!scopeClassAttribute(this, attr, value)) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n      distributeAttributeChange(this, attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   */\n  removeAttribute(attr) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    } else if (!scopeClassAttribute(this, attr, '')) {\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n      distributeAttributeChange(this, attr);\n    } else if (this.getAttribute(attr) === '') {\n      // When attr='class', scopeClassAttribute() will handle the change as a\n      // side-effect and return `true`, allowing us to get to this branch,\n      // which cleans up the 'class' attribute if it's empty and we were\n      // supposed to have removed it.\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {boolean | undefined} force\n   */\n  toggleAttribute(attr, force) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n    } else if (!scopeClassAttribute(this, attr, '')) {\n      const result = this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n      distributeAttributeChange(this, attr);\n      return result;\n    } else if (this.getAttribute(attr) === '' && !force) {\n      // When attr='class', scopeClassAttribute() will handle the change as a\n      // side-effect and return `true`, allowing us to get to this branch,\n      // which cleans up the 'class' attribute if it's empty and we were\n      // supposed to have removed it.\n      // We check for `force` being falsey because we only want to clean up on\n      // removal of the attribute.\n      return this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n    }\n  },\n});\n\nif (!utils.settings.preferPerformance) {\n  eventPropertyNamesForElement.forEach((property) => {\n    ElementPatches[property] = wrappedDescriptorForEventProperty(property);\n  });\n}\n\nexport const ElementShadowPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {Element}\n   * @param {!{mode: string}} options\n   */\n  attachShadow(options) {\n    const root = attachShadow(this, options);\n    // TODO(sorvell): Workaround for CE not seeing shadowRoot in `on-demand`\n    // noPatch mode. CE's attachShadow patch is overwritten by this patch\n    // and cannot set its own special tracking for shadowRoot. It does this\n    // to be able to see closed shadowRoots.\n    // This is necessary so that the CE polyfill can traverse into nodes\n    // with shadowRoot that will under `on-demand` have their childNodes patched.\n    this['__CE_shadowRoot'] = root;\n    return root;\n  },\n\n  // Note: Can be patched on element prototype on all browsers.\n  // Must be patched on instance on browsers that support native Shadow DOM\n  // but do not have builtin accessors (old Chrome).\n  /** @this {Element} */\n  get shadowRoot() {\n    const nodeData = shadyDataForNode(this);\n    return (nodeData && nodeData.publicRoot) || null;\n  },\n});\n\nutils.assign(ElementPatches, ElementShadowPatches);\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {getInnerHTML} from '../innerHTML.js';\nimport {clearNode} from './Node.js';\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nexport const ElementOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get innerHTML() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const content =\n        this.localName === 'template'\n          ? /** @type {HTMLTemplateElement} */ (this).content\n          : this;\n      return getInnerHTML(content, utils.childNodesArray);\n    } else {\n      return this[utils.NATIVE_PREFIX + 'innerHTML'];\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set innerHTML(value) {\n    if (this.localName === 'template') {\n      this[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n    } else {\n      clearNode(this);\n      const containerName = this.localName || 'div';\n      let htmlContainer;\n      if (!this.namespaceURI || this.namespaceURI === inertDoc.namespaceURI) {\n        htmlContainer = inertDoc.createElement(containerName);\n      } else {\n        htmlContainer = inertDoc.createElementNS(\n          this.namespaceURI,\n          containerName\n        );\n      }\n      if (utils.settings.hasDescriptors) {\n        htmlContainer[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n      } else {\n        htmlContainer.innerHTML = value;\n      }\n      let firstChild;\n      while ((firstChild = htmlContainer[utils.SHADY_PREFIX + 'firstChild'])) {\n        this[utils.SHADY_PREFIX + 'insertBefore'](firstChild);\n      }\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {eventPropertyNamesForHTMLElement, wrappedDescriptorForEventProperty} from '../patch-events.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const HTMLElementPatches = utils.getOwnPropertyDescriptors({\n  /** @this {HTMLElement} */\n  blur() {\n    const nodeData = shadyDataForNode(this);\n    let root = nodeData && nodeData.root;\n    let shadowActive = root && root.activeElement;\n    if (shadowActive) {\n      shadowActive[utils.SHADY_PREFIX + 'blur']();\n    } else {\n      this[utils.NATIVE_PREFIX + 'blur']();\n    }\n  },\n});\n\nif (!utils.settings.preferPerformance) {\n  eventPropertyNamesForHTMLElement.forEach((property) => {\n    HTMLElementPatches[property] = wrappedDescriptorForEventProperty(property);\n  });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {addEventListener, removeEventListener} from '../patch-events.js';\n\nexport const SlotPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {HTMLSlotElement}\n   * @param {Object=} options\n   */\n  assignedNodes(options) {\n    if (this.localName === 'slot') {\n      // Force any containing shadowRoot to flush so that distribution occurs\n      // and this node has assignedNodes.\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      if (root && utils.isShadyRoot(root)) {\n        root._render();\n      }\n      const nodeData = shadyDataForNode(this);\n      return nodeData\n        ? (options && options.flatten\n            ? nodeData.flattenedNodes\n            : nodeData.assignedNodes) || []\n        : [];\n    }\n  },\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    // NOTE, check if this is a `slot` because these patches are installed on\n    // Element where browsers don't have `<slot>`\n    if (this.localName !== 'slot' || type === 'slotchange') {\n      addEventListener.call(this, type, fn, optionsOrCapture);\n    } else {\n      if (typeof optionsOrCapture !== 'object') {\n        optionsOrCapture = {\n          capture: Boolean(optionsOrCapture),\n        };\n      }\n      const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n      if (!parent) {\n        throw new Error(\n          'ShadyDOM cannot attach event to slot unless it has a `parentNode`'\n        );\n      }\n      optionsOrCapture.__shadyTarget = this;\n      parent[utils.SHADY_PREFIX + 'addEventListener'](\n        type,\n        fn,\n        optionsOrCapture\n      );\n    }\n  },\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    // NOTE, check if this is a `slot` because these patches are installed on\n    // Element where browsers don't have `<slot>`\n    if (this.localName !== 'slot' || type === 'slotchange') {\n      removeEventListener.call(this, type, fn, optionsOrCapture);\n    } else {\n      if (typeof optionsOrCapture !== 'object') {\n        optionsOrCapture = {\n          capture: Boolean(optionsOrCapture),\n        };\n      }\n      const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n      if (!parent) {\n        throw new Error(\n          'ShadyDOM cannot attach event to slot unless it has a `parentNode`'\n        );\n      }\n      optionsOrCapture.__shadyTarget = this;\n      parent[utils.SHADY_PREFIX + 'removeEventListener'](\n        type,\n        fn,\n        optionsOrCapture\n      );\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\nimport {query} from './ParentNode.js';\n\nexport const DocumentOrFragmentPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {Element}\n   * @param {string} id\n   */\n  getElementById(id) {\n    if (id === '') {\n      return null;\n    }\n    let result = query(\n      this,\n      function (n) {\n        return n.id == id;\n      },\n      function (n) {\n        return Boolean(n);\n      }\n    )[0];\n    return result || null;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nfunction getDocumentActiveElement() {\n  if (utils.settings.hasDescriptors) {\n    return document[utils.NATIVE_PREFIX + 'activeElement'];\n  } else {\n    return document.activeElement;\n  }\n}\n\n// Get the element within the given set of roots.\nfunction getElInRoot(roots, el) {\n  let elRoot;\n  while (\n    el &&\n    !roots.has((elRoot = el[utils.SHADY_PREFIX + 'getRootNode']()))\n  ) {\n    el = elRoot.host;\n  }\n  return el;\n}\n\nfunction getAncestorRoots(docOrRoot) {\n  const roots = new Set();\n  roots.add(docOrRoot);\n  while (utils.isShadyRoot(docOrRoot) && docOrRoot.host) {\n    docOrRoot = docOrRoot.host[utils.SHADY_PREFIX + 'getRootNode']();\n    roots.add(docOrRoot);\n  }\n  return roots;\n}\n\nconst USE_NATIVE_DOCUMENT_EFP = 'useNativeDocumentEFP';\n\nconst elementsFromPointProperty =\n  utils.NATIVE_PREFIX +\n  utils.getPropertyName(Document.prototype, 'elementsFromPoint');\n\nexport const DocumentOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Document|ShadowRoot} */\n  get activeElement() {\n    let active = getDocumentActiveElement();\n    // In IE11, activeElement might be an empty object if the document is\n    // contained in an iframe.\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10998788/\n    if (!active || !active.nodeType) {\n      return null;\n    }\n    let isShadyRoot = !!utils.isShadyRoot(this);\n    if (this !== document) {\n      // If this node isn't a document or shady root, then it doesn't have\n      // an active element.\n      if (!isShadyRoot) {\n        return null;\n      }\n      // If this shady root's host is the active element or the active\n      // element is not a descendant of the host (in the composed tree),\n      // then it doesn't have an active element.\n      if (\n        this.host === active ||\n        !this.host[utils.NATIVE_PREFIX + 'contains'](active)\n      ) {\n        return null;\n      }\n    }\n    // This node is either the document or a shady root of which the active\n    // element is a (composed) descendant of its host; iterate upwards to\n    // find the active element's most shallow host within it.\n    let activeRoot = ownerShadyRootForNode(active);\n    while (activeRoot && activeRoot !== this) {\n      active = activeRoot.host;\n      activeRoot = ownerShadyRootForNode(active);\n    }\n    if (this === document) {\n      // This node is the document, so activeRoot should be null.\n      return activeRoot ? null : active;\n    } else {\n      // This node is a non-document shady root, and it should be\n      // activeRoot.\n      return activeRoot === this ? active : null;\n    }\n  },\n\n  /** @this {Document|ShadowRoot} */\n  elementsFromPoint(x, y) {\n    const nativeResult = document[elementsFromPointProperty](x, y);\n    // support optionally opt-ing out for document\n    if (this === document && utils.settings[USE_NATIVE_DOCUMENT_EFP]) {\n      return nativeResult;\n    }\n    const nativeArray = utils.arrayFrom(nativeResult);\n    // Filter native result to return the element in this root\n    // OR an above root.\n    // Set containing this root and its ancestor roots.\n    const ancestorRoots = getAncestorRoots(this);\n    // Use a Set since the elements can repeat.\n    const rootedResult = new Set();\n    for (let i = 0; i < nativeArray.length; i++) {\n      rootedResult.add(getElInRoot(ancestorRoots, nativeArray[i]));\n    }\n    // Note, for IE compat avoid Array.from(set).\n    const r = [];\n    rootedResult.forEach((x) => r.push(x));\n    return r;\n  },\n\n  /** @this {Document|ShadowRoot} */\n  elementFromPoint(x, y) {\n    // support optionally opt-ing out for document\n    return this === document && utils.settings[USE_NATIVE_DOCUMENT_EFP]\n      ? this[utils.NATIVE_PREFIX + 'elementFromPoint'](x, y)\n      : this[utils.SHADY_PREFIX + 'elementsFromPoint'](x, y)[0] || null;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nconst doc = window.document;\n\nexport const DocumentPatches = utils.getOwnPropertyDescriptors({\n  // note: Though not technically correct, we fast path `importNode`\n  // when called on a node not owned by the main document.\n  // This allows, for example, elements that cannot\n  // contain custom elements and are therefore not likely to contain shadowRoots\n  // to cloned natively. This is a fairly significant performance win.\n  /**\n   * @this {Document}\n   * @param {Node} node\n   * @param {boolean} deep\n   */\n  importNode(node, deep) {\n    // A template element normally has no children with shadowRoots, so make\n    // sure we always make a deep copy to correctly construct the template.content\n    if (node.ownerDocument !== doc || node.localName === 'template') {\n      return this[utils.NATIVE_PREFIX + 'importNode'](node, deep);\n    }\n    let n = this[utils.NATIVE_PREFIX + 'importNode'](node, false);\n    if (deep) {\n      for (\n        let c = node[utils.SHADY_PREFIX + 'firstChild'], nc;\n        c;\n        c = c[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        nc = this[utils.SHADY_PREFIX + 'importNode'](c, true);\n        n[utils.SHADY_PREFIX + 'appendChild'](nc);\n      }\n    }\n    return n;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {addEventListener, removeEventListener, dispatchEvent} from '../patch-events.js';\n\nexport const WindowPatches = utils.getOwnPropertyDescriptors({\n  // Ensure that `dispatchEvent` is patched directly on Window since on\n  // IE11, Window does not descend from EventTarget.\n  dispatchEvent,\n\n  // NOTE: ensure these methods are bound to `window` so that `this` is correct\n  // when called directly from global context without a receiver; e.g.\n  // `addEventListener(...)`.\n  addEventListener: addEventListener.bind(window),\n\n  removeEventListener: removeEventListener.bind(window),\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {EventTargetPatches} from './patches/EventTarget.js';\nimport {NodePatches} from './patches/Node.js';\nimport {SlotablePatches} from './patches/Slotable.js';\n// prettier-ignore\nimport {ParentNodePatches, ParentNodeDocumentOrFragmentPatches} from './patches/ParentNode.js';\nimport {ChildNodePatches} from './patches/ChildNode.js';\nimport {ElementPatches, ElementShadowPatches} from './patches/Element.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {HTMLElementPatches} from './patches/HTMLElement.js';\nimport {SlotPatches} from './patches/Slot.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {DocumentPatches} from './patches/Document.js';\nimport {WindowPatches} from './patches/Window.js';\n\n// Some browsers (IE/Edge) have non-standard HTMLElement accessors.\nconst NonStandardHTMLElement = {};\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'parentElement')) {\n  NonStandardHTMLElement.parentElement = NodePatches.parentElement;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'contains')) {\n  NonStandardHTMLElement.contains = NodePatches.contains;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'children')) {\n  NonStandardHTMLElement.children = ParentNodePatches.children;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'innerHTML')) {\n  NonStandardHTMLElement.innerHTML = ElementOrShadowRootPatches.innerHTML;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'className')) {\n  NonStandardHTMLElement.className = ElementPatches.className;\n}\n\n// Avoid patching `innerHTML` if it does not exist on Element (IE)\n// and we can patch accessors (hasDescriptors).\nconst ElementShouldHaveInnerHTML =\n  !utils.settings.hasDescriptors || 'innerHTML' in Element.prototype;\n\n// setup patching\nconst patchMap = {\n  EventTarget: [EventTargetPatches],\n  Node: [NodePatches, !window.EventTarget ? EventTargetPatches : null],\n  Text: [SlotablePatches],\n  Comment: [SlotablePatches],\n  CDATASection: [SlotablePatches],\n  ProcessingInstruction: [SlotablePatches],\n  Element: [\n    ElementPatches,\n    ParentNodePatches,\n    ChildNodePatches,\n    SlotablePatches,\n    ElementShouldHaveInnerHTML ? ElementOrShadowRootPatches : null,\n    !window.HTMLSlotElement ? SlotPatches : null,\n  ],\n  HTMLElement: [HTMLElementPatches, NonStandardHTMLElement],\n  HTMLSlotElement: [SlotPatches],\n  DocumentFragment: [\n    ParentNodeDocumentOrFragmentPatches,\n    DocumentOrFragmentPatches,\n  ],\n  Document: [\n    DocumentPatches,\n    ParentNodeDocumentOrFragmentPatches,\n    DocumentOrFragmentPatches,\n    DocumentOrShadowRootPatches,\n  ],\n  Window: [WindowPatches],\n  CharacterData: [ChildNodePatches],\n  XMLHttpRequest: [!window.EventTarget ? EventTargetPatches : null],\n};\n\nconst getPatchPrototype = (name) => window[name] && window[name].prototype;\n\n// Note, must avoid patching accessors on prototypes when descriptors are not correct\n// because the CustomElements polyfill checks if these exist before patching instances.\n// CustomElements polyfill *only* cares about these accessors.\nconst disallowedNativePatches = utils.settings.hasDescriptors\n  ? null\n  : ['innerHTML', 'textContent'];\n\n/**\n * Patch a group of accessors on an object.\n * @param {!Object} proto\n * @param {!Array<Object>} list\n * @param {string=} prefix\n * @param {Array=} disallowed\n */\nfunction applyPatchList(proto, list, prefix, disallowed) {\n  list.forEach(\n    (patch) =>\n      proto && patch && utils.patchProperties(proto, patch, prefix, disallowed)\n  );\n}\n\n/** @param {string=} prefix */\nexport const applyPatches = (prefix) => {\n  const disallowed = prefix ? null : disallowedNativePatches;\n  for (let p in patchMap) {\n    const proto = getPatchPrototype(p);\n    applyPatchList(proto, patchMap[p], prefix, disallowed);\n  }\n};\n\nconst PROTO_IS_PATCHED = utils.SHADY_PREFIX + 'protoIsPatched';\n\n// This property is stored directly on these objects, rather than in a local\n// Map, because IE11 has a bug around `defineProperty`/`hasOwnProperty` which\n// breaks Closure Compiler's WeakMap polyfill when using both certain native\n// prototypes (e.g. of CDATASection) and their instances as keys - even if\n// they're isolated to different WeakMaps. Closure's WeakMap polyfill is used\n// transitively by its own Map and Set polyfills, so this bug applies to any\n// situation where either of Map or Set are polyfilled also.\nconst PATCHED_PROTO = utils.SHADY_PREFIX + 'patchedProto';\n\n// Patch non-element prototypes up front so that we don't have to check\n// the type of Node when patching an can always assume we're patching an element.\n['Text', 'Comment', 'CDATASection', 'ProcessingInstruction'].forEach((name) => {\n  const ctor = window[name];\n  const patchedProto = Object.create(ctor.prototype);\n  patchedProto[PROTO_IS_PATCHED] = true;\n  applyPatchList(patchedProto, patchMap.EventTarget);\n  applyPatchList(patchedProto, patchMap.Node);\n  if (patchMap[name]) {\n    applyPatchList(patchedProto, patchMap[name]);\n  }\n  ctor.prototype[PATCHED_PROTO] = patchedProto;\n});\n\nexport const patchElementProto = (proto) => {\n  proto[PROTO_IS_PATCHED] = true;\n  applyPatchList(proto, patchMap.EventTarget);\n  applyPatchList(proto, patchMap.Node);\n  applyPatchList(proto, patchMap.Element);\n  applyPatchList(proto, patchMap.HTMLElement);\n  applyPatchList(proto, patchMap.HTMLSlotElement);\n  return proto;\n};\n\nexport const patchNodeProto = (node) => {\n  if (node[PROTO_IS_PATCHED] || utils.isShadyRoot(node)) {\n    return;\n  }\n  const nativeProto = Object.getPrototypeOf(node);\n  // Note, this hasOwnProperty check is critical to avoid seeing a patched\n  // prototype lower in the prototype chain, e.g. if an <s> element has been\n  // patched, without this check, an <input> element would get the wrong patch.\n  let proto =\n    nativeProto.hasOwnProperty(PATCHED_PROTO) && nativeProto[PATCHED_PROTO];\n  if (!proto) {\n    proto = Object.create(nativeProto);\n    patchElementProto(proto);\n    nativeProto[PATCHED_PROTO] = proto;\n  }\n  Object.setPrototypeOf(node, proto);\n};\n\nexport const patchShadowOnElement = () => {\n  utils.patchProperties(Element.prototype, ElementShadowPatches);\n};\n\nexport const addShadyPrefixedProperties = () => {\n  // perform shady patches\n  applyPatches(utils.SHADY_PREFIX);\n\n  // install `_activeElement` because some browsers (older Chrome/Safari) do not have\n  // a 'configurable' `activeElement` accesssor.\n  const descriptor = DocumentOrShadowRootPatches.activeElement;\n  Object.defineProperty(document, '_activeElement', descriptor);\n\n  // On Window, we're patching `addEventListener` which is a weird auto-bound\n  // property that is not directly on the Window prototype.\n  utils.patchProperties(Window.prototype, WindowPatches, utils.SHADY_PREFIX);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\n// prettier-ignore\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchNodeProto} from './patch-prototypes.js';\n\nconst OutsideAccessors = 1;\nconst InsideAcccessors = 2;\n\nconst patchOnDemand = utils.settings.patchOnDemand;\nconst hasDescriptors = utils.settings.hasDescriptors;\n\nfunction patchNode(node, type) {\n  if (patchOnDemand) {\n    patchNodeProto(node);\n  }\n  if (!hasDescriptors) {\n    if (type === OutsideAccessors) {\n      patchOutsideElementAccessors(node);\n    } else if (type === InsideAcccessors) {\n      patchInsideElementAccessors(node);\n    }\n  }\n}\n\nfunction linkNode(node, container, containerData, ref_node) {\n  patchNode(node, OutsideAccessors);\n  ref_node = ref_node || null;\n  const nodeData = ensureShadyDataForNode(node);\n  const ref_nodeData = ref_node ? ensureShadyDataForNode(ref_node) : null;\n  // update ref_node.previousSibling <-> node\n  nodeData.previousSibling = ref_node\n    ? ref_nodeData.previousSibling\n    : container[utils.SHADY_PREFIX + 'lastChild'];\n  let psd = shadyDataForNode(nodeData.previousSibling);\n  if (psd) {\n    psd.nextSibling = node;\n  }\n  // update node <-> ref_node\n  let nsd = shadyDataForNode((nodeData.nextSibling = ref_node));\n  if (nsd) {\n    nsd.previousSibling = node;\n  }\n  // update node <-> container\n  nodeData.parentNode = container;\n  if (ref_node) {\n    if (ref_node === containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  } else {\n    containerData.lastChild = node;\n    if (!containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  }\n  // remove caching of childNodes\n  containerData.childNodes = null;\n}\n\nexport const recordInsertBefore = (node, container, ref_node) => {\n  patchNode(container, InsideAcccessors);\n  const containerData = ensureShadyDataForNode(container);\n  if (containerData.firstChild !== undefined) {\n    containerData.childNodes = null;\n  }\n  // handle document fragments\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // Note, documentFragments should not have logical DOM so there's\n    // no need update that. It is possible to append a ShadowRoot, but we're\n    // choosing not to support that.\n    const first = node[utils.NATIVE_PREFIX + 'firstChild'];\n    for (let n = first; n; n = n[utils.NATIVE_PREFIX + 'nextSibling']) {\n      linkNode(n, container, containerData, ref_node);\n    }\n  } else {\n    linkNode(node, container, containerData, ref_node);\n  }\n};\n\nexport const recordRemoveChild = (node, container) => {\n  const nodeData = ensureShadyDataForNode(node);\n  const containerData = ensureShadyDataForNode(container);\n  if (node === containerData.firstChild) {\n    containerData.firstChild = nodeData.nextSibling;\n  }\n  if (node === containerData.lastChild) {\n    containerData.lastChild = nodeData.previousSibling;\n  }\n  let p = nodeData.previousSibling;\n  let n = nodeData.nextSibling;\n  if (p) {\n    ensureShadyDataForNode(p).nextSibling = n;\n  }\n  if (n) {\n    ensureShadyDataForNode(n).previousSibling = p;\n  }\n  // When an element is removed, logical data is no longer tracked.\n  // Explicitly set `undefined` here to indicate this. This is disginguished\n  // from `null` which is set if info is null.\n  nodeData.parentNode = nodeData.previousSibling = nodeData.nextSibling = undefined;\n  if (containerData.childNodes !== undefined) {\n    // remove caching of childNodes\n    containerData.childNodes = null;\n  }\n};\n\n/**\n * @param  {!Node|DocumentFragment} node\n * @param  {!Node|DocumentFragment=} adoptedParent\n */\nexport const recordChildNodes = (node, adoptedParent) => {\n  const nodeData = ensureShadyDataForNode(node);\n  if (!adoptedParent && nodeData.firstChild !== undefined) {\n    return;\n  }\n  // remove caching of childNodes\n  nodeData.childNodes = null;\n  const first = (nodeData.firstChild =\n    node[utils.NATIVE_PREFIX + 'firstChild']);\n  nodeData.lastChild = node[utils.NATIVE_PREFIX + 'lastChild'];\n  patchNode(node, InsideAcccessors);\n  for (let n = first, previous; n; n = n[utils.NATIVE_PREFIX + 'nextSibling']) {\n    const sd = ensureShadyDataForNode(n);\n    sd.parentNode = adoptedParent || node;\n    sd.nextSibling = n[utils.NATIVE_PREFIX + 'nextSibling'];\n    sd.previousSibling = previous || null;\n    previous = n;\n    patchNode(n, OutsideAccessors);\n  }\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture),\n      };\n    }\n    // Note, `__shadyTarget` may already be set if an event was added on a <slot> child\n    optionsOrCapture.__shadyTarget = optionsOrCapture.__shadyTarget || this;\n    this.host[utils.SHADY_PREFIX + 'addEventListener'](\n      type,\n      fn,\n      optionsOrCapture\n    );\n  },\n\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture),\n      };\n    }\n    // Note, `__shadyTarget` may already be set if an event was added on a <slot> child\n    optionsOrCapture.__shadyTarget = optionsOrCapture.__shadyTarget || this;\n    this.host[utils.SHADY_PREFIX + 'removeEventListener'](\n      type,\n      fn,\n      optionsOrCapture\n    );\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {NodePatches} from './patches/Node.js';\n// prettier-ignore\nimport {OutsideDescriptors, InsideDescriptors, TextContentInnerHTMLDescriptors} from './patch-instances.js';\nimport {ParentNodePatches} from './patches/ParentNode.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {ShadowRootPatches} from './patches/ShadowRoot.js';\n\n/**\n * @param {!Object} proto\n * @param {string=} prefix\n */\nconst patchShadyAccessors = (proto, prefix) => {\n  utils.patchProperties(proto, ShadowRootPatches, prefix);\n  utils.patchProperties(proto, DocumentOrShadowRootPatches, prefix);\n  utils.patchProperties(proto, ElementOrShadowRootPatches, prefix);\n  // We ensure ParentNode accessors since these do not exist in Edge/IE on DocumentFragments.\n  utils.patchProperties(proto, ParentNodePatches, prefix);\n  // Ensure `shadowRoot` has basic descriptors when we cannot rely\n  // on them coming from DocumentFragment.\n  //\n  // Case 1, noPatching: Because we want noPatch ShadyRoots to have native property\n  // names so that they do not have to be wrapped...\n  // When we do *not* patch Node/DocumentFragment.prototype\n  // we must manually install those properties on ShadyRoot's prototype.\n  // Note, it's important to only install these in this mode so as not to stomp\n  // over CustomElements polyfill's patches on Node/DocumentFragment methods.\n  if (utils.settings.noPatch && !prefix) {\n    utils.patchProperties(proto, NodePatches, prefix);\n    utils.patchProperties(proto, DocumentOrFragmentPatches, prefix);\n  }\n  // Case 2, bad descriptors: Ensure accessors are on ShadowRoot.\n  // These descriptors are normally used for instance patching but because\n  // ShadyRoot can always be patched, just do it to the prototype.\n  else if (!utils.settings.hasDescriptors) {\n    utils.patchProperties(proto, OutsideDescriptors);\n    utils.patchProperties(proto, InsideDescriptors);\n    utils.patchProperties(proto, TextContentInnerHTMLDescriptors);\n  }\n};\n\nexport const patchShadyRoot = (proto) => {\n  proto.__proto__ = DocumentFragment.prototype;\n\n  // patch both prefixed and not, even when noPatch == true.\n  patchShadyAccessors(proto, utils.SHADY_PREFIX);\n  patchShadyAccessors(proto);\n\n  // Ensure native properties are all safely wrapped since ShadowRoot is not an\n  // actual DocumentFragment instance.\n  Object.defineProperties(proto, {\n    nodeType: {\n      value: Node.DOCUMENT_FRAGMENT_NODE,\n      configurable: true,\n    },\n    nodeName: {\n      value: '#document-fragment',\n      configurable: true,\n    },\n    nodeValue: {\n      value: null,\n      configurable: true,\n    },\n  });\n\n  // make undefined\n  ['localName', 'namespaceURI', 'prefix'].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      value: undefined,\n      configurable: true,\n    });\n  });\n\n  // defer properties to host\n  ['ownerDocument', 'baseURI', 'isConnected'].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      /** @this {ShadowRoot} */\n      get() {\n        return this.host[prop];\n      },\n      configurable: true,\n    });\n  });\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n// prettier-ignore\nimport {eventPropertyNamesForElement, eventPropertyNamesForHTMLElement} from './patch-events.js';\n\n/** @implements {IWrapper} */\nclass Wrapper {\n  /** @param {!Node} node */\n  constructor(node) {\n    this.node = node;\n  }\n\n  // node\n  addEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'addEventListener'](\n      name,\n      fn,\n      options\n    );\n  }\n\n  removeEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'removeEventListener'](\n      name,\n      fn,\n      options\n    );\n  }\n\n  appendChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'appendChild'](node);\n  }\n\n  insertBefore(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n  }\n\n  removeChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'removeChild'](node);\n  }\n\n  replaceChild(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChild'](node, ref_node);\n  }\n\n  cloneNode(deep) {\n    return this.node[utils.SHADY_PREFIX + 'cloneNode'](deep);\n  }\n\n  getRootNode(options) {\n    return this.node[utils.SHADY_PREFIX + 'getRootNode'](options);\n  }\n\n  contains(node) {\n    return this.node[utils.SHADY_PREFIX + 'contains'](node);\n  }\n\n  dispatchEvent(event) {\n    return this.node[utils.SHADY_PREFIX + 'dispatchEvent'](event);\n  }\n\n  // element\n  setAttribute(name, value) {\n    this.node[utils.SHADY_PREFIX + 'setAttribute'](name, value);\n  }\n\n  // NOTE: not needed, just here for balance\n  getAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'getAttribute'](name);\n  }\n\n  // NOTE: not needed, just here for balance\n  hasAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'hasAttribute'](name);\n  }\n\n  removeAttribute(name) {\n    this.node[utils.SHADY_PREFIX + 'removeAttribute'](name);\n  }\n\n  toggleAttribute(name, force) {\n    return this.node[utils.SHADY_PREFIX + 'toggleAttribute'](name, force);\n  }\n\n  attachShadow(options) {\n    return this.node[utils.SHADY_PREFIX + 'attachShadow'](options);\n  }\n\n  /** @return {!Node|undefined} */\n  get activeElement() {\n    if (\n      utils.isShadyRoot(this.node) ||\n      this.node.nodeType === Node.DOCUMENT_NODE\n    ) {\n      const e = this.node[utils.SHADY_PREFIX + 'activeElement'];\n      return e;\n    }\n    return undefined;\n  }\n\n  /**\n   * Installed for compatibility with browsers (older Chrome/Safari) that do\n   * not have a configurable `activeElement` accessor. Enables noPatch and\n   * patch mode both to consistently use ShadyDOM.wrap(document)._activeElement.\n   * @override\n   * @return {!Node|undefined}\n   */\n  get _activeElement() {\n    return this.activeElement;\n  }\n\n  // NOTE: not needed, just here for balance\n  /** @override */\n  focus() {\n    this.node[utils.NATIVE_PREFIX + 'focus']();\n  }\n\n  blur() {\n    this.node[utils.SHADY_PREFIX + 'blur']();\n  }\n\n  // document\n  importNode(node, deep) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'importNode'](node, deep);\n    }\n  }\n\n  getElementById(id) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'getElementById'](id);\n    }\n  }\n\n  elementsFromPoint(x, y) {\n    return this.node[utils.SHADY_PREFIX + 'elementsFromPoint'](x, y);\n  }\n\n  elementFromPoint(x, y) {\n    return this.node[utils.SHADY_PREFIX + 'elementFromPoint'](x, y);\n  }\n\n  // query\n  querySelector(selector) {\n    return this.node[utils.SHADY_PREFIX + 'querySelector'](selector);\n  }\n\n  querySelectorAll(selector, useNative) {\n    return this.node[utils.SHADY_PREFIX + 'querySelectorAll'](\n      selector,\n      useNative\n    );\n  }\n\n  // slot\n  assignedNodes(options) {\n    if (this.node.localName === 'slot') {\n      return this.node[utils.SHADY_PREFIX + 'assignedNodes'](options);\n    }\n  }\n\n  get host() {\n    if (utils.isShadyRoot(this.node)) {\n      return /** @type {!ShadowRoot} */ (this.node).host;\n    }\n    return undefined;\n  }\n\n  get parentNode() {\n    return this.node[utils.SHADY_PREFIX + 'parentNode'];\n  }\n\n  get firstChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstChild'];\n  }\n\n  get lastChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastChild'];\n  }\n\n  get nextSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextSibling'];\n  }\n\n  get previousSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousSibling'];\n  }\n\n  get childNodes() {\n    return this.node[utils.SHADY_PREFIX + 'childNodes'];\n  }\n\n  get parentElement() {\n    return this.node[utils.SHADY_PREFIX + 'parentElement'];\n  }\n\n  get firstElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstElementChild'];\n  }\n\n  get lastElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastElementChild'];\n  }\n\n  get nextElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextElementSibling'];\n  }\n\n  get previousElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousElementSibling'];\n  }\n\n  get children() {\n    return this.node[utils.SHADY_PREFIX + 'children'];\n  }\n\n  get childElementCount() {\n    return this.node[utils.SHADY_PREFIX + 'childElementCount'];\n  }\n\n  get shadowRoot() {\n    return this.node[utils.SHADY_PREFIX + 'shadowRoot'];\n  }\n\n  get assignedSlot() {\n    return this.node[utils.SHADY_PREFIX + 'assignedSlot'];\n  }\n\n  get isConnected() {\n    return this.node[utils.SHADY_PREFIX + 'isConnected'];\n  }\n\n  get innerHTML() {\n    return this.node[utils.SHADY_PREFIX + 'innerHTML'];\n  }\n\n  set innerHTML(value) {\n    this.node[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  }\n\n  get textContent() {\n    return this.node[utils.SHADY_PREFIX + 'textContent'];\n  }\n\n  set textContent(value) {\n    this.node[utils.SHADY_PREFIX + 'textContent'] = value;\n  }\n\n  get slot() {\n    return this.node[utils.SHADY_PREFIX + 'slot'];\n  }\n\n  set slot(value) {\n    this.node[utils.SHADY_PREFIX + 'slot'] = value;\n  }\n\n  get className() {\n    return this.node[utils.SHADY_PREFIX + 'className'];\n  }\n\n  set className(value) {\n    this.node[utils.SHADY_PREFIX + 'className'] = value;\n  }\n\n  append(...args) {\n    return this.node[utils.SHADY_PREFIX + 'append'](...args);\n  }\n\n  prepend(...args) {\n    return this.node[utils.SHADY_PREFIX + 'prepend'](...args);\n  }\n\n  replaceChildren(...args) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChildren'](...args);\n  }\n\n  after(...args) {\n    return this.node[utils.SHADY_PREFIX + 'after'](...args);\n  }\n\n  before(...args) {\n    return this.node[utils.SHADY_PREFIX + 'before'](...args);\n  }\n\n  remove() {\n    return this.node[utils.SHADY_PREFIX + 'remove']();\n  }\n\n  replaceWith(...args) {\n    return this.node[utils.SHADY_PREFIX + 'replaceWith'](...args);\n  }\n}\n\nconst addEventPropertyWrapper = (name) => {\n  Object.defineProperty(Wrapper.prototype, name, {\n    /** @this {Wrapper} */\n    get() {\n      return this.node[utils.SHADY_PREFIX + name];\n    },\n    /** @this {Wrapper} */\n    set(value) {\n      this.node[utils.SHADY_PREFIX + name] = value;\n    },\n    configurable: true,\n  });\n};\n\neventPropertyNamesForElement.forEach((name) => addEventPropertyWrapper(name));\neventPropertyNamesForHTMLElement.forEach((name) =>\n  addEventPropertyWrapper(name)\n);\n\nexport {Wrapper};\n\nconst wrapperMap = new WeakMap();\n\nexport function wrap(obj) {\n  if (utils.isShadyRoot(obj) || obj instanceof Wrapper) {\n    return obj;\n  }\n  let wrapper = wrapperMap.get(obj);\n  if (!wrapper) {\n    wrapper = new Wrapper(obj);\n    wrapperMap.set(obj, wrapper);\n  }\n  return wrapper;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nimport * as utils from './utils.js';\nimport {flush, enqueue} from './flush.js';\n// prettier-ignore\nimport {observeChildren, unobserveChildren, filterMutations} from './observe-changes.js';\n// prettier-ignore\nimport {addNativePrefixedProperties, nativeMethods, nativeTree} from './patch-native.js';\n// prettier-ignore\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchEvents, patchClick, composedPath} from './patch-events.js';\nimport {ShadyRoot} from './attach-shadow.js';\nimport {wrap, Wrapper} from './wrapper.js';\n// prettier-ignore\nimport {addShadyPrefixedProperties, applyPatches, patchShadowOnElement, patchElementProto} from './patch-prototypes.js';\n\nif (utils.settings.inUse) {\n  const patch = utils.settings.hasDescriptors\n    ? (n) => n\n    : (node) => {\n        patchInsideElementAccessors(node);\n        patchOutsideElementAccessors(node);\n        return node;\n      };\n\n  let ShadyDOM = {\n    // TODO(sorvell): remove when Polymer does not depend on this.\n    'inUse': utils.settings.inUse,\n    // NOTE: old browsers without prototype accessors (very old Chrome\n    // and Safari) need manually patched accessors to properly set\n    // `innerHTML` and `textContent` when an element is:\n    // (1) inside a shadowRoot\n    // (2) does not have special (slot) children itself\n    // (3) and setting the property needs to provoke distribution (because\n    // a nested slot is added/removed)\n    'patch': patch,\n    'isShadyRoot': utils.isShadyRoot,\n    'enqueue': enqueue,\n    'flush': flush,\n    'flushInitial': (root) => {\n      root._flushInitial();\n    },\n    'settings': utils.settings,\n    'filterMutations': filterMutations,\n    'observeChildren': observeChildren,\n    'unobserveChildren': unobserveChildren,\n    // Set to true to defer native custom elements connection until the\n    // document has fully parsed. This enables custom elements that create\n    // shadowRoots to be defined while the document is loading. Elements\n    // customized as they are created by the parser will successfully\n    // render with this flag on.\n    'deferConnectionCallbacks': utils.settings['deferConnectionCallbacks'],\n    // Set to true to speed up the polyfill slightly at the cost of correctness\n    // * does not patch querySelector/All on Document or DocumentFragment\n    // * does not wrap connected/disconnected callbacks to de-dup these\n    // when using native customElements\n    // * does not wait to process children of elements with shadowRoots\n    // meaning shadowRoots should not be created while an element is parsing\n    // (e.g. if a custom element that creates a shadowRoot is defined before\n    // a candidate element in the document below it.\n    'preferPerformance': utils.settings['preferPerformance'],\n    // Integration point with ShadyCSS to disable styling MutationObserver,\n    // as ShadyDOM will now handle dynamic scoping.\n    'handlesDynamicScoping': true,\n    // Ensure the node is wrapped. This should be used when `noPatch` is set\n    // to ensure Shadow DOM compatible DOM operation.\n    // Note, wrap falls back to patch so that it ensures API \"always just works\"\n    'wrap': utils.settings.noPatch ? wrap : patch,\n    // When code should be compatible with `noPatch` `true` and `on-demand`\n    // settings, `wrapIfNeeded` can be used for optimal performance (v. `wrap`)\n    // for all DOM operations except the following: `appendChild` and\n    // `insertBefore` (when the node is being moved from a location where it\n    // was logically positioned in the DOM); when setting `className`/`class`;\n    // when calling `querySelector|All`; when setting `textContent` or\n    // `innerHTML`; `addEventListener`, `removeEventListener` and\n    // `dispatchEvent`; and all scope specific API's like `getRootNode`,\n    // `isConnected`, `slot`, `assignedSlot`, `assignedNodes`. Note,\n    // `wrapIfNeeded` falls back to a pass through to preserve optimal\n    // performance.\n    'wrapIfNeeded': utils.settings.noPatch === true ? wrap : (n) => n,\n    'Wrapper': Wrapper,\n    'composedPath': composedPath,\n    // Set to true to avoid patching regular platform property names. When set,\n    // Shadow DOM compatible behavior is only available when accessing DOM\n    // API using `ShadyDOM.wrap`, e.g. `ShadyDOM.wrap(element).shadowRoot`.\n    // This setting provides a small performance boost, but requires all DOM API\n    // access that requires Shadow DOM behavior to be proxied via `ShadyDOM.wrap`.\n    //\n    // WARNING: When `noPatch` is set and the Custom Elements polyfill is\n    // needed, the Custom Elements polyfill must be loaded before this\n    // polyfill; however, when `noPatch` is not used, this polyfill should be\n    // loaded before the Custom Elements polyfill. This is because\n    // ShadyDOM captures DOM mutation methods and when `noPatch` is used,\n    // ShadyDOM must call the mutation methods patched by the Custom Elements\n    // polyfill or custom elements will not function as expected. When `noPatch`\n    // is not used, the Custom Elements polyfill patches call through to the\n    // ShadyDOM patches so ShadyDOM should be loaded first.\n    'noPatch': utils.settings.noPatch,\n    'patchOnDemand': utils.settings.patchOnDemand,\n    'nativeMethods': nativeMethods,\n    'nativeTree': nativeTree,\n    'patchElementProto': patchElementProto,\n    // Use this setting to choose the implementation of `querySelector` and\n    // `querySelectorAll`. The options provide different tradeoffs between\n    // accuracy and performance, as explained below. More specifically, the\n    // logical tree exposed by Shady DOM through the DOM APIs it wraps doesn't\n    // match the structure of the tree seen by the browser (the 'real tree'), so\n    // the degree to which the browser itself is used to match selectors affects\n    // this tradeoff.\n    //\n    // - `undefined` (default): Shady DOM will walk the logical descendants of\n    // the context element and call `matches` with the given selector to find\n    // matching elements.\n    //\n    //   This option is a balance between accuracy and performance. This option\n    //   will be able to match all logical descendants of the context element\n    //   (i.e. including descendants of unassigned nodes) but selectors are\n    //   matched against the real tree, so complex selectors may fail to match\n    //   since their combinators will attempt to match against the structure of\n    //   the real tree. Generally, you should only pass compound selectors when\n    //   using the default implementation. This implementation also breaks the\n    //   semantics of `:scope` because the wrapped `querySelector` call is\n    //   translated into many `matches` calls on different elements.\n    //\n    // - `'native'`: Shady DOM's wrapper for (e.g.) `querySelector` will call\n    // into the native `querySelector` function and then filter out results that\n    // are not in the same shadow root in the logical tree.\n    //\n    //   This is the fastest option. This option will not match elements that\n    //   are logical descendants of unassigned nodes because they will not be in\n    //   the real tree, against which the browser matches the selector. Like the\n    //   default option, this option may not correctly match complex selectors\n    //   (i.e. those with combinators) due to the structural differences between\n    //   the real tree and the logical tree. This option preserves the semantics\n    //   of `:scope` because the context element of the call to the wrapper is\n    //   also the context element of the call to the native function.\n    //\n    // - `'selectorEngine'`: Shady DOM's wrapper for (e.g.) `querySelector` will\n    // partially parse the given selector list and perform the tree-traversal\n    // steps of a selector engine against the logical tree.\n    //\n    //   This is the slowest and most accurate option. This option is able to\n    //   find all logical descendants of the context element by manually walking\n    //   the tree. This option is also able to correctly match complex selectors\n    //   because it does not rely on the browser to handle combinators. Despite\n    //   using `matches` to match compound selectors during selector evaluation,\n    //   this option preserves the semantics of `:scope` by only considering\n    //   compound selectors containing `:scope` to be matching if the context\n    //   element of the `matches` call is also the context element of the\n    //   wrapper call.\n    //\n    //   However, the parser used for this option is not strictly correct.\n    //   Notable caveats include:\n    //\n    //     - The parser assumes the selector list it's given is syntactically\n    //     correct. When given a selector that would not parse under a full\n    //     implementation, this implementation may fail silently.\n    //\n    //     - Nested selectors are _not_ taken into consideration while walking\n    //     the tree. Each outer-most compound selector is tested against\n    //     candidate elements as a whole, without modification. This means that\n    //     selectors nested in arguments of functional pseudo-classes, such as\n    //     `a > b` in `:is(a > b)`, are still matched by the browser against the\n    //     real tree, not Shady DOM's logical tree.\n    //\n    //     - `:scope` is only supported at the top-level. Particularly, if the\n    //     text `:scope` appears anywhere within a compound selector, then the\n    //     selector engine will only allow that compound selector to match the\n    //     context element. Having the text `:scope` inside a string\n    //     (`x[y=\":scope\"]`) or an argument to a functional pseudo-selector\n    //     (`:not(:scope > x)`) will likely break your selector.\n    //\n    //     - The `:host` and `:host-context` pseudo-classes are not supported.\n    //\n    //     - Comments are not supported. (e.g. `a /* b */ c`)\n    //\n    //     - The (draft) column combinator is not supported. (e.g. `a || b`)\n    'querySelectorImplementation':\n      utils.settings['querySelectorImplementation'],\n  };\n\n  window['ShadyDOM'] = ShadyDOM;\n\n  // Modifies native prototypes for Node, Element, etc. to\n  // make native platform behavior available at prefixed names, e.g.\n  // `utils.NATIVE_PREFIX + 'firstChild'` or `__shady_native_firstChild`.\n  // This allows the standard names to be safely patched while retaining the\n  // ability for native behavior to be used. This polyfill manipulates DOM\n  // by using this saved native behavior.\n  // Note, some browsers do not have proper element descriptors for\n  // accessors; in this case, native behavior for these accessors is simulated\n  // via a TreeWalker.\n  addNativePrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to make ShadowDOM\n  // behavior available at prefixed names, e.g.\n  // `utils.SHADY_PREFIX + 'firstChild` or `__shady_firstChild`. This is done\n  // so this polyfill can perform Shadow DOM style DOM manipulation.\n  // Because patching normal platform property names is optional, these prefixed\n  // names are used internally.\n  addShadyPrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to patch\n  // regular platform property names to have Shadow DOM compatible API behavior.\n  // This applies the utils.SHADY_PREFIX behavior to normal names. For example,\n  // if `noPatch` is not set, then `el.__shady_firstChild` is equivalent to\n  // `el.firstChild`.\n  // NOTE, on older browsers (old Chrome/Safari) native accessors cannot be\n  // patched on prototypes (e.g. Node.prototype.firstChild cannot be modified).\n  // On these browsers, instance level patching is performed where needed; this\n  // instance patching is only done when `noPatch` is *not* set.\n  if (!utils.settings.noPatch) {\n    applyPatches();\n    // Patch click event behavior only if we're patching\n    patchClick();\n  } else if (utils.settings.patchOnDemand) {\n    // In `on-demand` patching, do patch `attachShadow` and `shadowRoot`.\n    // These are the only patched properties in `on-demand` mode and these\n    // patches kick off patching \"on-demand\" for other nodes.\n    patchShadowOnElement();\n  }\n\n  // For simplicity, patch events unconditionally.\n  // Patches the event system to have Shadow DOM compatible behavior (e.g.\n  // event retargeting). When `noPatch` is set, retargeting is only available\n  // when adding event listeners and dispatching events via `ShadyDOM.wrap`\n  // (e.g. `ShadyDOM.wrap(element).addEventListener(...)`).\n  patchEvents();\n\n  window.ShadowRoot = /** @type {function(new:ShadowRoot)} */ (ShadyRoot);\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}