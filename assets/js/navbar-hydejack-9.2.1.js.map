{"version":3,"sources":["webpack:///./_js/src/navbar.js"],"names":["_asyncToGenerator","stylesheetReady","navbarEl","document","getElementById","height","clientHeight","offset","tv","hasCSSOM","CSSTransformValue","CSSTranslate","CSS","px","checkNavbarInactive","_document$activeEleme","activeElement","classList","contains","hashchange$","fromEvent","window","pipe","map","e","URL","newURL","hash","filter","share","notScrollIntoView$","switchMap","debounceTime","mapTo","startWith","jump$","merge","capture","passive","filterWhen","getScrollTop","x","pairwise","_ref2","prev","curr","mergeWith","tap","Math","max","min","y","value","attributeStyleMap","set","style","transform","concat","subscribe"],"mappings":"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","file":"navbar-hydejack-9.2.1.js","sourcesContent":["// Copyright (c) 2018 Florian Klampfer <https://qwtel.com/>\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nimport { fromEvent, timer, merge } from 'rxjs';\nimport {\n  map,\n  filter,\n  pairwise,\n  mergeWith,\n  mapTo,\n  tap,\n  switchMap,\n  startWith,\n  share,\n  debounceTime,\n} from 'rxjs/operators';\n\nimport { hasCSSOM, getScrollTop, stylesheetReady, filterWhen } from './common';\n\n(async () => {\n  await stylesheetReady;\n\n  const navbarEl = document.getElementById('_navbar');\n  if (!navbarEl) return;\n\n  // FIXME: update when size changes\n  const height = navbarEl.clientHeight;\n\n  let offset = 0;\n\n  const tv = hasCSSOM ? new CSSTransformValue([new CSSTranslate(CSS.px(0), CSS.px(0))]) : null;\n\n  const checkNavbarInactive = () => !document.activeElement?.classList.contains('nav-btn');\n\n  const hashchange$ = fromEvent(window, 'hashchange').pipe(\n    map((e) => new URL(e.newURL).hash),\n    filter((hash) => hash !== '' && hash !== '#_search-input'),\n    share(),\n  );\n\n  // To disable the navbar while the \"scroll into view\" animation is active.\n  // Wait for 50ms after scrolling has stopped before unlocking the navbar.\n  const notScrollIntoView$ = hashchange$.pipe(\n    switchMap(() => fromEvent(document, 'scroll').pipe(debounceTime(50), mapTo(true), startWith(false))),\n    startWith(true),\n  );\n\n  // Certain events should make the navbar \"jump\" to a new position.\n  const jump$ = merge(\n    // Focusing any navbar element should show the navbar to enable keyboard-only interaction.\n    fromEvent(navbarEl, 'focus', { capture: true }).pipe(mapTo(2 * height)),\n    // Scrolling to a certain headline should hide the navbar to prevent hiding it.\n    hashchange$.pipe(mapTo(-2 * height)),\n  );\n\n  fromEvent(document, 'scroll', { passive: true })\n    .pipe(\n      filterWhen(notScrollIntoView$),\n      map(getScrollTop),\n      filter((x) => x >= 0),\n      pairwise(),\n      map(([prev, curr]) => prev - curr),\n      filter(checkNavbarInactive),\n      mergeWith(jump$),\n      tap((x) => {\n        offset += x;\n        offset = Math.max(-height, Math.min(0, offset));\n        if (hasCSSOM) {\n          tv[0].y.value = offset;\n          navbarEl.attributeStyleMap.set('transform', tv);\n        } else {\n          navbarEl.style.transform = `translateY(${offset}px)`;\n        }\n      }),\n    )\n    .subscribe();\n})();\n"],"sourceRoot":""}