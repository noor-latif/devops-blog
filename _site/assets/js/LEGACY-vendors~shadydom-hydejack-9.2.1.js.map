{"version":3,"sources":["webpack:///./node_modules/@webcomponents/shadycss/entrypoints/scoping-shim.js","webpack:///./node_modules/@webcomponents/shadycss/src/apply-shim-utils.js","webpack:///./node_modules/@webcomponents/shadycss/src/common-regex.js","webpack:///./node_modules/@webcomponents/shadycss/src/common-utils.js","webpack:///./node_modules/@webcomponents/shadycss/src/css-parse.js","webpack:///./node_modules/@webcomponents/shadycss/src/custom-style-interface.js","webpack:///./node_modules/@webcomponents/shadycss/src/document-wait.js","webpack:///./node_modules/@webcomponents/shadycss/src/document-watcher.js","webpack:///./node_modules/@webcomponents/shadycss/src/scoping-shim.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-cache.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-info.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-placeholder.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-properties.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-settings.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-transformer.js","webpack:///./node_modules/@webcomponents/shadycss/src/style-util.js","webpack:///./node_modules/@webcomponents/shadycss/src/template-map.js","webpack:///./node_modules/@webcomponents/shadycss/src/unscoped-style-handler.js","webpack:///src/shady-data.js","webpack:/// [synthetic:es6/util/arrayiterator] ","webpack:/// [synthetic:es6/util/makeiterator] ","webpack:/// [synthetic:es6/util/arrayfromiterable] ","webpack:/// [synthetic:es6/util/arrayfromiterator] ","webpack:/// [synthetic:util/global] ","webpack:///src/utils.js","webpack:///src/patch-native.js","webpack:///src/flush.js","webpack:///src/observe-changes.js","webpack:///src/innerHTML.js","webpack:///src/patch-instances.js","webpack:///src/patch-events.js","webpack:///src/array-splice.js","webpack:///src/patches/EventTarget.js","webpack:///src/style-scoping.js","webpack:///src/patches/Node.js","webpack:///src/attach-shadow.js","webpack:///src/patches/Slotable.js","webpack:///src/selector-parser.js","webpack:///src/patches/ParentNode.js","webpack:///src/patches/ChildNode.js","webpack:///src/patches/Element.js","webpack:///src/patches/ElementOrShadowRoot.js","webpack:///src/patches/HTMLElement.js","webpack:///src/patches/Slot.js","webpack:///src/patches/DocumentOrFragment.js","webpack:///src/patches/DocumentOrShadowRoot.js","webpack:///src/patches/Document.js","webpack:///src/patches/Window.js","webpack:///src/patch-prototypes.js","webpack:///src/link-nodes.js","webpack:///src/patches/ShadowRoot.js","webpack:///src/patch-shadyRoot.js","webpack:///src/wrapper.js","webpack:///src/shadydom.js","webpack:///(webpack)/buildin/global.js"],"names":["scopingShim","ScopingShim","ApplyShim","CustomStyleInterface","window","ShadyCSS","prepareTemplate","template","elementName","elementExtends","flushCustomStyles","prepareTemplateDom","prepareTemplateStyles","styleSubtree","element","properties","styleElement","styleDocument","getComputedStyleValue","property","nativeCss","nativeCssVariables","nativeShadow","cssBuild","disableRuntime","CURRENT_VERSION","NEXT_VERSION","VALIDATING_VERSION","promise","Promise","resolve","invalidate","templateMap","invalidateTemplate","isValid","templateIsValid","isValidating","templateIsValidating","startValidating","startValidatingTemplate","_validating","then","elementsAreInvalid","VAR_ASSIGN","MIXIN_MATCH","VAR_CONSUMED","ANIMATION_MATCH","MEDIA_MATCH","IS_VAR","BRACKETED","HOST_PREFIX","HOST_SUFFIX","updateNativeProperties","p","style","removeProperty","setProperty","value","getComputedStyle","getPropertyValue","trim","detectMixin","cssText","has","test","lastIndex","_typeof","o","Symbol","iterator","constructor","prototype","_defineProperties","e","r","t","length","enumerable","configurable","writable","Object","defineProperty","_toPropertyKey","key","_createClass","i","_toPrimitive","toPrimitive","call","TypeError","String","Number","_classCallCheck","a","n","StyleNode","parse","text","clean","parseCss","lex","replace","RX","comments","port","root","l","OPEN_BRACE","previous","push","CLOSE_BRACE","node","substring","ss","_expandUnicodeEscapes","multipleSpaces","lastIndexOf","s","indexOf","AT_START","MEDIA_START","types","MEDIA_RULE","match","keyframesRule","KEYFRAMES_RULE","split","pop","VAR_START","MIXIN_RULE","STYLE_RULE","r$","code","arguments","repeat","stringify","preserveProperties","undefined","_hasMixinRules","removeCustomProps","rules","Boolean","removeCustomPropAssignment","removeCustomPropApply","customProp","mixinProp","mixinApply","varApply","CustomStyleProvider","SEEN_MARKER","CACHED_STYLE","transformFn","validateFn","documentWait","enqueueDocumentValidation","addCustomStyle","getStyleForCustomStyle","customStyle","processStyles","cs","styleToTransform","defineProperties","get","set","fn","needsEnqueue","CustomStyleInterfaceInterface","readyPromise","whenReady","resolveFn","callback","requestAnimationFrame","document","readyState","addEventListener","flush","getClasses","classList","getAttribute","scopeRegExp","RegExp","concat","StyleTransformer","SCOPE_NAME","getCurrentScope","getOwnerScope","ownerRoot","wrap","getRootNode","ownerDocument","host","getIsExtends","is","ensureCorrectScope","currentScope","domRemoveScope","ShadowRoot","ownerScope","domReplaceScope","ensureCorrectSubtreeScoping","unscopedNodes","j","unscopedNode","scopeForPreviouslyUnscopedNode","isElementWithBuiltCss","el","localName","elementHasBuiltCss","handler","mxns","x","mxn","target","documentElement","head","addedNodes","nodeType","Node","ELEMENT_NODE","newScope","observer","MutationObserver","start","observe","childList","subtree","nativeCustomElements","delayedStart","body","listener","removeEventListener","takeRecords","adoptedCssTextMap","styleCache","StyleCache","_scopeCounter","_documentOwner","ast","_documentOwnerStyleInfo","StyleInfo","_elementsHaveApplied","_applyShim","_customStyleInterface","watcherFlush","_generateScopeSelector","name","id","getStyleAst","StyleUtil","styleAstToString","_gatherStyles","content","typeExtension","_prepared","ensureStylePlaceholder","extends","optimalBuild","info","_ensure","hasMixins","ownPropertyNames","StyleProperties","decorateStyles","placeholder","getStylePlaceholder","_generateStaticStyle","_style","_ownPropertyNames","prepareAdoptedCssText","cssTextArray","join","_domPrepared","domAddScope","shadowroot","elementStyles","_prepareHost","_StyleUtil$getIsExten","ownStylePropertyNames","styleInfo","_ensureApplyShim","ApplyShimUtils","_ensureCustomStyleInterface","_this","transformCustomStyleForDocument","needsApplyShimUpdate","customStyles","_reorderCustomStylesRules","_updateProperties","_applyCustomStyles","_revalidateCustomStyleApplyShim","_this2","styles","map","c","filter","sort","b","position","compareDocumentPosition","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_PRECEDING","styleRules","overrideProps","_mixOverrideStyleProps","styleElementNativeVariables","_isRootOwner","styleElementShimVariables","overrideStyleProperties","assign","_applyStyleProperties","_StyleUtil$getIsExten2","textContent","shadowRoot","querySelector","_styleOwnerForNode","cacheEntry","fetch","styleProperties","cachedScopeSelector","scopeSelector","cachedStyle","oldScopeSelector","applyElementStyle","applyElementScopeSelector","store","owner","ownerStyleInfo","ownerProperties","props","create","hostAndRootProps","hostAndRootPropertiesForScope","propertyData","propertyDataFromStyles","propertiesMatchingHost","hostProps","rootProps","_mixinOverrideStyles","reify","overrides","v","wrappedHost","isRootOwner","descendantRoot","descendantHosts","Array","from","querySelectorAll","_revalidateApplyShim","applyCustomStyle","_this3","rule","normalizeRootSelector","documentRule","setElementClass","classString","classes","definitelyString","scopeName","classAttr","k$","XSCOPE_NAME","_styleInfoForNode","scopeNode","scope","unscopeNode","scopeForNode","currentScopeForNode","typeMax","cache","_validate","idx","pn","tagname","list","shift","entry","infoKey","_getStyleRules","placeholderMap","applyStylePlaceHolder","ce","origDefine","wrappedDefine","clazz","options","matchesSelector","selector","method","matches","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","rootSelector","checkRoot","hostScope","IS_IE","navigator","userAgent","self","keyframes","ruleIndex","decorateRule","index","collectPropertiesInCssText","propertyInfo","onKeyframesRule","_keyframes","names","hasProperties","collectProperties","collectCssText","m","rx","any","exec","collectConsumingCssText","getOwnPropertyNames","valueForProperty","valueForProperties","prefix","fallback","suffix","propertyValue","parts","colon","pp","slice","applyProperties","output","applyKeyframeTransforms","keyframeTransforms","input","hasAnimations","transform","keyframeNamesToTransform","keyframe","selectorToMatch","transformedSelector","addToBitMask","whenHostOrRootRule","_calcHostScope","parsedSelector","isRoot","isHost","_transformRuleCss","_transformComplexSelector","_calcElementScope","_element","transformStyles","hostSelector","rxHostSelector","hostRx","_StyleInfo$get","_elementKeyframeTransforms","_scopeSelector","keyframesRules","_scopeKeyframes","_keyframesRuleTransformer","keyframesNameRx","transformedKeyframesName","scopeId","old","parentNode","removeChild","css","bits","parseInt","nativeCssVariables_","calcCssVariables","settings","shimcssproperties","CSS","supports","dom","shouldRemoveScope","_transformDom","startNode","transformer","c$","_content","childNodes","children","remove","add","CLASS","newValue","oldScope","_this4","ext","isScoped","CSS_CLASS_PREFIX","_transformRule","p$","part","COMPLEX_SELECTOR_SEP","_twiddleNthPlus","NTH","type","inside","_preserveMatchesPseudo","MATCHES","end","Error","MATCHES_REPLACEMENT","_replaceMatchesPseudo","reduce","acc","cur","_this5","stop","isNth","inner","isMatches","_this$_preserveMatche","SLOTTED_START","HOST","SIMPLE_SELECTOR_SEP","_transformCompoundSelector","combinator","DIR_PAREN","before","dir","after","slottedIndex","SLOTTED","_transformHostSelector","_transformSimpleSelector","slotted","SLOTTED_PAREN","paren","attributes","PSEUDO_PREFIX","HOST_PAREN","SIMPLE_SELECTOR_PREFIX","typeSelector","SELECTOR_NO_MATCH","_transformDocumentSelector","ROOT","SCOPE_DOC_SELECTOR","toCssText","forEachRule","rulesForStyle","isKeyframesSelector","styleRuleCallback","keyframesRuleCallback","onlyActiveRules","skipRules","matchMedia","applyCss","moniker","contextNode","createScopeStyle","applyStyle","createElement","setAttribute","lastHeadApplyNode","placeHolder","createComment","insertBefore","firstChild","nextSibling","isTargetedBuild","buildType","findMatchingParen","level","processVariableAndFallback","str","comma","setElementClassRaw","gatherStyleText","styleTextParts","isUnscopedStyle","processUnscopedStyle","splitSelectorList","CSS_BUILD_ATTR","getCssBuild","__cssBuild","attrValue","buildComment","getBuildComment","removeBuildComment","Comment","commentParts","isOptimalCssBuild","styleTextSet","Set","scopingAttribute","newStyle","appendChild","hasAttribute","aa","done","next","q","ba","globalThis","global","Math","ca","da","ShadyData","toJSON","ensureShadyDataForNode","__shady","u","shadyDataForNode","ShadyDOM","Element","attachShadow","ea","getOwnPropertyDescriptor","N","force","noPatch","C","preferPerformance","O","fa","ha","querySelectorImplementation","ga","V","ia","Document","msElementsFromPoint","w","ja","ka","y","la","ma","createTextNode","na","oa","characterData","pa","qa","contains","__shady_native_contains","ra","__shady_parentNode","z","d","isNaN","item","namedItem","f","g","sa","__shady_native_firstChild","__shady_native_nextSibling","ta","__shady_firstChild","__shady_nextSibling","ua","A","va","B","forEach","wa","xa","D","createDocumentFragment","ya","isArray","apply","za","E","Aa","Ba","enqueue","F","Ca","AsyncObserver","removedNodes","H","Da","Ea","Z","Fa","delete","size","Ga","filterMutations","Ha","Ia","Ja","escapeReplace","Ka","makeSet","La","Ma","Na","getInnerHTML","h","k","S","TEXT_NODE","data","COMMENT_NODE","console","error","G","Oa","__shady_native_querySelector","__shady_native_querySelectorAll","Pa","Qa","I","J","createTreeWalker","NodeFilter","SHOW_ALL","K","SHOW_ELEMENT","Ra","implementation","createHTMLDocument","Sa","__shady_native_removeChild","Ta","Ua","Va","EventTarget","__shady_native_addEventListener","Window","XMLHttpRequest","currentNode","lastChild","previousSibling","parentElement","DOCUMENT_FRAGMENT_NODE","SHOW_TEXT","nextNode","nodeValue","__shady_native_insertBefore","HTMLElement","firstElementChild","lastElementChild","childElementCount","previousElementSibling","nextElementSibling","innerHTML","namespaceURI","createElementNS","className","HTMLTemplateElement","DocumentFragment","Wa","__shady_childNodes","__shady_lastChild","__shady_childElementCount","__shady_children","__shady_firstElementChild","__shady_lastElementChild","__shady_shadowRoot","Xa","__shady_textContent","__shady_innerHTML","Ya","__shady_parentElement","__shady_previousSibling","__shady_nextElementSibling","__shady_previousElementSibling","__shady_className","Za","$a","ab","X","bb","W","customElements","polyfillWrapFlushCallback","L","Date","now","cb","Event","db","capture","eb","once","U","T","fb","blur","focus","focusin","focusout","click","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","wheel","beforeinput","keydown","keyup","compositionstart","compositionupdate","compositionend","touchstart","touchend","touchmove","touchcancel","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture","dragstart","drag","dragenter","dragleave","dragover","drop","dragend","DOMActivate","DOMFocusIn","DOMFocusOut","keypress","gb","DOMAttrModified","DOMAttributeNameChanged","DOMCharacterDataModified","DOMElementNameChanged","DOMNodeInserted","DOMNodeInsertedIntoDocument","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMSubtreeModified","hb","getRootNodeWithFallback","__shady_getRootNode","M","pathComposer","__shady_assignedSlot","ib","__composedPath","jb","retarget","kb","composed","__composed","isTrusted","composedPath","__target","currentTarget","__previousCurrentTarget","relatedTarget","__relatedTarget","__relatedTargetComposedPath","stopPropagation","stopImmediatePropagation","__immediatePropagationStopped","lb","AT_TARGET","__shady_native_eventPhase","mb","mixinComposedFlag","__proto__","nb","ob","hasRetargeted","pb","fireHandlers","__handlers","qb","hasOwnProperty","rb","shadyDispatchEvent","bubbles","CAPTURING_PHASE","BUBBLING_PHASE","eventPhase","sb","findListener","tb","dispatchEvent","ub","__shady_native_dispatchEvent","vb","handleEvent","__shady_removeEventListener","bubble","wb","__shady_native_removeEventListener","splice","xb","activateFocusEventOverrides","yb","patchEvent","getPrototypeOf","__shady_sourceProto","__shady_patchedProto","zb","Ab","CustomEvent","Bb","MouseEvent","Cb","patchClick","cancelable","__shady_dispatchEvent","Db","Eb","Fb","__shady_addEventListener","newSplice","Gb","calcSplices","min","Hb","reverse","equals","Ib","Jb","getScopingShim","Kb","scopeClassAttribute","Lb","removeShadyScoping","Mb","currentScopeIsCorrect","Nb","Ob","treeVisitor","Pb","Qb","Rb","Sb","Tb","clearNode","__shady_removeChild","Ub","removeOwnerShadyRoot","Vb","firstComposedNode","Wb","scheduleObserver","ac","__shady_native_parentNode","__shady_native_lastChild","__shady_native_previousSibling","__shady_native_childNodes","__shady_native_parentElement","isConnected","__shady_native_textContent","__shady_insertBefore","P","__noInsertionPoint","Xb","Q","Yb","__shady_native_appendChild","adoptNode","Zb","$b","replaceChild","cloneNode","__shady_native_cloneNode","ATTRIBUTE_NODE","__shady_cloneNode","__shady_appendChild","R","assignedSlot","bc","cc","Map","dc","ec","fc","query","gc","queryChildNodes","hc","__shady_native_firstElementChild","__shady_native_lastElementChild","__shady_native_children","append","prepend","replaceChildren","ic","some","jc","kc","lc","replaceWith","mc","nc","distributeAttributeChange","oc","Y","pc","qc","rc","__shady_native_previousElementSibling","__shady_native_nextElementSibling","slot","__shady_setAttribute","__shady_native_setAttribute","removeAttribute","__shady_native_removeAttribute","toggleAttribute","__shady_native_toggleAttribute","wc","shadyUpgradeFragment","sc","tc","uc","vc","__CE_shadowRoot","xc","yc","__shady_native_innerHTML","zc","activeElement","__shady_blur","__shady_native_blur","Ac","assignedNodes","flatten","Bc","getElementById","Cc","getElInRoot","Dc","getAncestorRoots","Ec","Fc","__shady_native_activeElement","elementsFromPoint","useNativeDocumentEFP","elementFromPoint","__shady_native_elementFromPoint","__shady_elementsFromPoint","Gc","Hc","importNode","__shady_native_importNode","__shady_importNode","Ic","bind","Text","CDATASection","ProcessingInstruction","HTMLSlotElement","CharacterData","Jc","applyPatchList","Kc","__shady_protoIsPatched","Lc","Mc","Nc","Oc","patchNode","setPrototypeOf","Pc","linkNode","Qc","Rc","deferConnectionCallbacks","Sc","Tc","ancestorList","unshift","ShadyRoot","mode","_renderSelf","Uc","Vc","Wc","__shady_slot","nodeName","define","Xc","rootRendered","clear","__shadydom_connectedCallback","__shadydom_disconnectedCallback","Yc","connectedCallback","disconnectedCallback","Zc","$c","CustomElementRegistry","Wrapper","__shady_replaceChild","__shady_contains","__shady_native_getAttribute","__shady_removeAttribute","__shady_toggleAttribute","__shady_attachShadow","__shady_native_focus","DOCUMENT_NODE","__shady_getElementById","__shady_elementFromPoint","__shady_querySelector","__shady_querySelectorAll","__shady_assignedNodes","__shady_append","__shady_prepend","__shady_after","__shady_before","__shady_remove","__shady_replaceWith","__shady_activeElement","_activeElement","__shady_isConnected","ad","bd","WeakMap","cd","dd","inUse","patch","isShadyRoot","flushInitial","observeChildren","unobserveChildren","handlesDynamicScoping","wrapIfNeeded","patchOnDemand","nativeMethods","nativeTree","patchElementProto","Function","module","exports"],"mappings":"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","file":"LEGACY-vendors~shadydom-hydejack-9.2.1.js","sourcesContent":["/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport ScopingShim from '../src/scoping-shim.js';\n// prettier-ignore\nimport {nativeCssVariables, nativeShadow, cssBuild, disableRuntime} from '../src/style-settings.js';\n\n/** @const {ScopingShim} */\nconst scopingShim = new ScopingShim();\n\nlet ApplyShim, CustomStyleInterface;\n\nif (window['ShadyCSS']) {\n  ApplyShim = window['ShadyCSS']['ApplyShim'];\n  CustomStyleInterface = window['ShadyCSS']['CustomStyleInterface'];\n}\n\nwindow.ShadyCSS = {\n  ScopingShim: scopingShim,\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplate(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplate(template, elementName, elementExtends);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    scopingShim.prepareTemplateDom(template, elementName);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplateStyles(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplateStyles(template, elementName, elementExtends);\n  },\n  /**\n   * @param {!HTMLElement} element\n   * @param {Object=} properties\n   */\n  styleSubtree(element, properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleSubtree(element, properties);\n  },\n\n  /**\n   * @param {!HTMLElement} element\n   */\n  styleElement(element) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleElement(element);\n  },\n\n  /**\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleDocument(properties);\n  },\n\n  flushCustomStyles() {\n    scopingShim.flushCustomStyles();\n  },\n\n  /**\n   * @param {Element} element\n   * @param {string} property\n   * @return {string}\n   */\n  getComputedStyleValue(element, property) {\n    return scopingShim.getComputedStyleValue(element, property);\n  },\n\n  nativeCss: nativeCssVariables,\n\n  nativeShadow: nativeShadow,\n\n  cssBuild: cssBuild,\n\n  disableRuntime: disableRuntime,\n};\n\nif (ApplyShim) {\n  window.ShadyCSS.ApplyShim = ApplyShim;\n}\n\nif (CustomStyleInterface) {\n  window.ShadyCSS.CustomStyleInterface = CustomStyleInterface;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\nimport templateMap from './template-map.js';\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/*\n * Utilities for handling invalidating apply-shim mixins for a given template.\n *\n * The invalidation strategy involves keeping track of the \"current\" version of a template's mixins, and updating that count when a mixin is invalidated.\n * The template\n */\n\n/** @const {string} */\nconst CURRENT_VERSION = '_applyShimCurrentVersion';\n\n/** @const {string} */\nconst NEXT_VERSION = '_applyShimNextVersion';\n\n/** @const {string} */\nconst VALIDATING_VERSION = '_applyShimValidatingVersion';\n\n/**\n * @const {Promise<void>}\n */\nconst promise = Promise.resolve();\n\n/**\n * @param {string} elementName\n */\nexport function invalidate(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    invalidateTemplate(template);\n  }\n}\n\n/**\n * This function can be called multiple times to mark a template invalid\n * and signal that the style inside must be regenerated.\n *\n * Use `startValidatingTemplate` to begin an asynchronous validation cycle.\n * During that cycle, call `templateIsValidating` to see if the template must\n * be revalidated\n * @param {HTMLTemplateElement} template\n */\nexport function invalidateTemplate(template) {\n  // default the current version to 0\n  template[CURRENT_VERSION] = template[CURRENT_VERSION] || 0;\n  // ensure the \"validating for\" flag exists\n  template[VALIDATING_VERSION] = template[VALIDATING_VERSION] || 0;\n  // increment the next version\n  template[NEXT_VERSION] = (template[NEXT_VERSION] || 0) + 1;\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValid(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValid(template);\n  }\n  return true;\n}\n\n/**\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValid(template) {\n  return template[CURRENT_VERSION] === template[NEXT_VERSION];\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValidating(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValidating(template);\n  }\n  return false;\n}\n\n/**\n * Returns true if the template is currently invalid and `startValidating` has been called since the last invalidation.\n * If false, the template must be validated.\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValidating(template) {\n  return (\n    !templateIsValid(template) &&\n    template[VALIDATING_VERSION] === template[NEXT_VERSION]\n  );\n}\n\n/**\n * the template is marked as `validating` for one microtask so that all instances\n * found in the tree crawl of `applyStyle` will update themselves,\n * but the template will only be updated once.\n * @param {string} elementName\n */\nexport function startValidating(elementName) {\n  let template = templateMap[elementName];\n  startValidatingTemplate(template);\n}\n\n/**\n * Begin an asynchronous invalidation cycle.\n * This should be called after every validation of a template\n *\n * After one microtask, the template will be marked as valid until the next call to `invalidateTemplate`\n * @param {HTMLTemplateElement} template\n */\nexport function startValidatingTemplate(template) {\n  // remember that the current \"next version\" is the reason for this validation cycle\n  template[VALIDATING_VERSION] = template[NEXT_VERSION];\n  // however, there only needs to be one async task to clear the counters\n  if (!template._validating) {\n    template._validating = true;\n    promise.then(function () {\n      // sync the current version to let future invalidations cause a refresh cycle\n      template[CURRENT_VERSION] = template[NEXT_VERSION];\n      template._validating = false;\n    });\n  }\n}\n\n/**\n * @return {boolean}\n */\nexport function elementsAreInvalid() {\n  for (let elementName in templateMap) {\n    let template = templateMap[elementName];\n    if (!templateIsValid(template)) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport const VAR_ASSIGN = /(?:^|[;\\s{]\\s*)(--[\\w-]*?)\\s*:\\s*(?:((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^)]*?\\)|[^};{])+)|\\{([^}]*)\\}(?:(?=[;\\s}])|$))/gi;\nexport const MIXIN_MATCH = /(?:^|\\W+)@apply\\s*\\(?([^);\\n]*)\\)?/gi;\nexport const VAR_CONSUMED = /(--[\\w-]+)\\s*([:,;)]|$)/gi;\nexport const ANIMATION_MATCH = /(animation\\s*:)|(animation-name\\s*:)/;\nexport const MEDIA_MATCH = /@media\\s(.*)/;\nexport const IS_VAR = /^--/;\nexport const BRACKETED = /\\{[^}]*\\}/g;\nexport const HOST_PREFIX = '(?:^|[^.#[:])';\nexport const HOST_SUFFIX = '($|[.:[\\\\s>+~])';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {MIXIN_MATCH, VAR_ASSIGN} from './common-regex.js';\n\n/**\n * @param {Element} element\n * @param {Object=} properties\n */\nexport function updateNativeProperties(element, properties) {\n  // remove previous properties\n  for (let p in properties) {\n    // NOTE: for bc with shim, don't apply null values.\n    if (p === null) {\n      element.style.removeProperty(p);\n    } else {\n      element.style.setProperty(p, properties[p]);\n    }\n  }\n}\n\n/**\n * @param {Element} element\n * @param {string} property\n * @return {string}\n */\nexport function getComputedStyleValue(element, property) {\n  /**\n   * @const {string}\n   */\n  const value = window.getComputedStyle(element).getPropertyValue(property);\n  if (!value) {\n    return '';\n  } else {\n    return value.trim();\n  }\n}\n\n/**\n * return true if `cssText` contains a mixin definition or consumption\n * @param {string} cssText\n * @return {boolean}\n */\nexport function detectMixin(cssText) {\n  const has = MIXIN_MATCH.test(cssText) || VAR_ASSIGN.test(cssText);\n  // reset state of the regexes\n  MIXIN_MATCH.lastIndex = 0;\n  VAR_ASSIGN.lastIndex = 0;\n  return has;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/*\nExtremely simple css parser. Intended to be not more than what we need\nand definitely not necessarily correct =).\n*/\n\n'use strict';\n\n/** @unrestricted */\nclass StyleNode {\n  constructor() {\n    /** @type {number} */\n    this['start'] = 0;\n    /** @type {number} */\n    this['end'] = 0;\n    /** @type {StyleNode} */\n    this['previous'] = null;\n    /** @type {StyleNode} */\n    this['parent'] = null;\n    /** @type {Array<StyleNode>} */\n    this['rules'] = null;\n    /** @type {string} */\n    this['parsedCssText'] = '';\n    /** @type {string} */\n    this['cssText'] = '';\n    /** @type {boolean} */\n    this['atRule'] = false;\n    /** @type {number} */\n    this['type'] = 0;\n    /** @type {string} */\n    this['keyframesName'] = '';\n    /** @type {string} */\n    this['selector'] = '';\n    /** @type {string} */\n    this['parsedSelector'] = '';\n  }\n}\n\nexport {StyleNode};\n\n// given a string of css, return a simple rule tree\n/**\n * @param {string} text\n * @return {StyleNode}\n */\nexport function parse(text) {\n  text = clean(text);\n  return parseCss(lex(text), text);\n}\n\n// remove stuff we don't care about that may hinder parsing\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction clean(cssText) {\n  return cssText.replace(RX.comments, '').replace(RX.port, '');\n}\n\n// super simple {...} lexer that returns a node tree\n/**\n * @param {string} text\n * @return {!StyleNode}\n */\nfunction lex(text) {\n  let root = new StyleNode();\n  root['start'] = 0;\n  root['end'] = text.length;\n  let n = root;\n  for (let i = 0, l = text.length; i < l; i++) {\n    if (text[i] === OPEN_BRACE) {\n      if (!n['rules']) {\n        n['rules'] = [];\n      }\n      let p = n;\n      let previous = p['rules'][p['rules'].length - 1] || null;\n      n = new StyleNode();\n      n['start'] = i + 1;\n      n['parent'] = p;\n      n['previous'] = previous;\n      p['rules'].push(n);\n    } else if (text[i] === CLOSE_BRACE) {\n      n['end'] = i + 1;\n      n = n['parent'] || root;\n    }\n  }\n  return root;\n}\n\n// add selectors/cssText to node tree\n/**\n * @param {StyleNode} node\n * @param {string} text\n * @return {!StyleNode}\n */\nfunction parseCss(node, text) {\n  let t = text.substring(node['start'], node['end'] - 1);\n  node['parsedCssText'] = node['cssText'] = t.trim();\n  if (node['parent']) {\n    let ss = node['previous']\n      ? node['previous']['end']\n      : node['parent']['start'];\n    t = text.substring(ss, node['start'] - 1);\n    t = _expandUnicodeEscapes(t);\n    t = t.replace(RX.multipleSpaces, ' ');\n    // TODO(sorvell): ad hoc; make selector include only after last ;\n    // helps with mixin syntax\n    t = t.substring(t.lastIndexOf(';') + 1);\n    let s = (node['parsedSelector'] = node['selector'] = t.trim());\n    node['atRule'] = s.indexOf(AT_START) === 0;\n    // note, support a subset of rule types...\n    if (node['atRule']) {\n      if (s.indexOf(MEDIA_START) === 0) {\n        node['type'] = types.MEDIA_RULE;\n      } else if (s.match(RX.keyframesRule)) {\n        node['type'] = types.KEYFRAMES_RULE;\n        node['keyframesName'] = node['selector'].split(RX.multipleSpaces).pop();\n      }\n    } else {\n      if (s.indexOf(VAR_START) === 0) {\n        node['type'] = types.MIXIN_RULE;\n      } else {\n        node['type'] = types.STYLE_RULE;\n      }\n    }\n  }\n  let r$ = node['rules'];\n  if (r$) {\n    for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n      parseCss(r, text);\n    }\n  }\n  return node;\n}\n\n/**\n * conversion of sort unicode escapes with spaces like `\\33 ` (and longer) into\n * expanded form that doesn't require trailing space `\\000033`\n * @param {string} s\n * @return {string}\n */\nfunction _expandUnicodeEscapes(s) {\n  return s.replace(/\\\\([0-9a-f]{1,6})\\s/gi, function () {\n    let code = arguments[1],\n      repeat = 6 - code.length;\n    while (repeat--) {\n      code = '0' + code;\n    }\n    return '\\\\' + code;\n  });\n}\n\n/**\n * stringify parsed css.\n * @param {StyleNode} node\n * @param {boolean=} preserveProperties\n * @param {string=} text\n * @return {string}\n */\nexport function stringify(node, preserveProperties, text = '') {\n  // calc rule cssText\n  let cssText = '';\n  if (node['cssText'] || node['rules']) {\n    let r$ = node['rules'];\n    if (r$ && !_hasMixinRules(r$)) {\n      for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n        cssText = stringify(r, preserveProperties, cssText);\n      }\n    } else {\n      cssText = preserveProperties\n        ? node['cssText']\n        : removeCustomProps(node['cssText']);\n      cssText = cssText.trim();\n      if (cssText) {\n        cssText = '  ' + cssText + '\\n';\n      }\n    }\n  }\n  // emit rule if there is cssText\n  if (cssText) {\n    if (node['selector']) {\n      text += node['selector'] + ' ' + OPEN_BRACE + '\\n';\n    }\n    text += cssText;\n    if (node['selector']) {\n      text += CLOSE_BRACE + '\\n\\n';\n    }\n  }\n  return text;\n}\n\n/**\n * @param {Array<StyleNode>} rules\n * @return {boolean}\n */\nfunction _hasMixinRules(rules) {\n  let r = rules[0];\n  return (\n    Boolean(r) &&\n    Boolean(r['selector']) &&\n    r['selector'].indexOf(VAR_START) === 0\n  );\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomProps(cssText) {\n  cssText = removeCustomPropAssignment(cssText);\n  return removeCustomPropApply(cssText);\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nexport function removeCustomPropAssignment(cssText) {\n  return cssText.replace(RX.customProp, '').replace(RX.mixinProp, '');\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomPropApply(cssText) {\n  return cssText.replace(RX.mixinApply, '').replace(RX.varApply, '');\n}\n\n/** @enum {number} */\nexport const types = {\n  STYLE_RULE: 1,\n  KEYFRAMES_RULE: 7,\n  MEDIA_RULE: 4,\n  MIXIN_RULE: 1000,\n};\n\nconst OPEN_BRACE = '{';\nconst CLOSE_BRACE = '}';\n\n// helper regexp's\nconst RX = {\n  comments: /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//gim,\n  port: /@import[^;]*;/gim,\n  customProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\\n]|$)/gim,\n  mixinProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\\n]|$)?/gim,\n  mixinApply: /@apply\\s*\\(?[^);]*\\)?\\s*(?:[;\\n]|$)?/gim,\n  varApply: /[^;:]*?:[^;]*?var\\([^;]*\\)(?:[;\\n]|$)?/gim,\n  keyframesRule: /^@[^\\s]*keyframes/,\n  multipleSpaces: /\\s+/g,\n};\n\nconst VAR_START = '--';\nconst MEDIA_START = '@media';\nconst AT_START = '@';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport documentWait from './document-wait.js';\n\n/**\n * @typedef {HTMLStyleElement | {getStyle: function():HTMLStyleElement}}\n */\nexport let CustomStyleProvider;\n\nconst SEEN_MARKER = '__seenByShadyCSS';\nconst CACHED_STYLE = '__shadyCSSCachedStyle';\n\n/** @type {?function(!HTMLStyleElement)} */\nlet transformFn = null;\n\n/** @type {?function()} */\nlet validateFn = null;\n\n/**\nThis interface is provided to add document-level <style> elements to ShadyCSS for processing.\nThese styles must be processed by ShadyCSS to simulate ShadowRoot upper-bound encapsulation from outside styles\nIn addition, these styles may also need to be processed for @apply rules and CSS Custom Properties\n\nTo add document-level styles to ShadyCSS, one can call `ShadyCSS.addDocumentStyle(styleElement)` or `ShadyCSS.addDocumentStyle({getStyle: () => styleElement})`\n\nIn addition, if the process used to discover document-level styles can be synchronously flushed, one should set `ShadyCSS.documentStyleFlush`.\nThis function will be called when calculating styles.\n\nAn example usage of the document-level styling api can be found in `examples/document-style-lib.js`\n\n@unrestricted\n*/\nexport default class CustomStyleInterface {\n  constructor() {\n    /** @type {!Array<!CustomStyleProvider>} */\n    this['customStyles'] = [];\n    this['enqueued'] = false;\n    // NOTE(dfreedm): use quotes here to prevent closure inlining to `function(){}`;\n    documentWait(() => {\n      if (window['ShadyCSS']['flushCustomStyles']) {\n        window['ShadyCSS']['flushCustomStyles']();\n      }\n    });\n  }\n  /**\n   * Queue a validation for new custom styles to batch style recalculations\n   */\n  enqueueDocumentValidation() {\n    if (this['enqueued'] || !validateFn) {\n      return;\n    }\n    this['enqueued'] = true;\n    documentWait(validateFn);\n  }\n  /**\n   * @param {!HTMLStyleElement} style\n   */\n  addCustomStyle(style) {\n    if (!style[SEEN_MARKER]) {\n      style[SEEN_MARKER] = true;\n      this['customStyles'].push(style);\n      this.enqueueDocumentValidation();\n    }\n  }\n  /**\n   * @param {!CustomStyleProvider} customStyle\n   * @return {HTMLStyleElement}\n   */\n  getStyleForCustomStyle(customStyle) {\n    if (customStyle[CACHED_STYLE]) {\n      return customStyle[CACHED_STYLE];\n    }\n    let style;\n    if (customStyle['getStyle']) {\n      style = customStyle['getStyle']();\n    } else {\n      style = customStyle;\n    }\n    return style;\n  }\n  /**\n   * @return {!Array<!CustomStyleProvider>}\n   */\n  processStyles() {\n    const cs = this['customStyles'];\n    for (let i = 0; i < cs.length; i++) {\n      const customStyle = cs[i];\n      if (customStyle[CACHED_STYLE]) {\n        continue;\n      }\n      const style = this.getStyleForCustomStyle(customStyle);\n      if (style) {\n        // HTMLImports polyfill may have cloned the style into the main document,\n        // which is referenced with __appliedElement.\n        const styleToTransform = /** @type {!HTMLStyleElement} */ (style[\n          '__appliedElement'\n        ] || style);\n        if (transformFn) {\n          transformFn(styleToTransform);\n        }\n        customStyle[CACHED_STYLE] = styleToTransform;\n      }\n    }\n    return cs;\n  }\n}\n\n/* eslint-disable no-self-assign */\nCustomStyleInterface.prototype['addCustomStyle'] =\n  CustomStyleInterface.prototype.addCustomStyle;\nCustomStyleInterface.prototype['getStyleForCustomStyle'] =\n  CustomStyleInterface.prototype.getStyleForCustomStyle;\nCustomStyleInterface.prototype['processStyles'] =\n  CustomStyleInterface.prototype.processStyles;\n/* eslint-enable no-self-assign */\n\nObject.defineProperties(CustomStyleInterface.prototype, {\n  'transformCallback': {\n    /** @return {?function(!HTMLStyleElement)} */\n    get() {\n      return transformFn;\n    },\n    /** @param {?function(!HTMLStyleElement)} fn */\n    set(fn) {\n      transformFn = fn;\n    },\n  },\n  'validateCallback': {\n    /** @return {?function()} */\n    get() {\n      return validateFn;\n    },\n    /**\n     * @param {?function()} fn\n     * @this {CustomStyleInterface}\n     */\n    set(fn) {\n      let needsEnqueue = false;\n      if (!validateFn) {\n        needsEnqueue = true;\n      }\n      validateFn = fn;\n      if (needsEnqueue) {\n        this.enqueueDocumentValidation();\n      }\n    },\n  },\n});\n\n/** @typedef {{\n * customStyles: !Array<!CustomStyleProvider>,\n * addCustomStyle: function(!CustomStyleProvider),\n * getStyleForCustomStyle: function(!CustomStyleProvider): HTMLStyleElement,\n * findStyles: function(),\n * transformCallback: ?function(!HTMLStyleElement),\n * validateCallback: ?function()\n * }}\n */\nexport const CustomStyleInterfaceInterface = {};\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {Promise<void>} */\nlet readyPromise = null;\n\n/** @type {?function(?function())} */\nlet whenReady =\n  (window['HTMLImports'] && window['HTMLImports']['whenReady']) || null;\n\n/** @type {function()} */\nlet resolveFn;\n\n/**\n * @param {?function()} callback\n */\nexport default function documentWait(callback) {\n  requestAnimationFrame(function () {\n    if (whenReady) {\n      whenReady(callback);\n    } else {\n      if (!readyPromise) {\n        readyPromise = new Promise((resolve) => {\n          resolveFn = resolve;\n        });\n        if (document.readyState === 'complete') {\n          resolveFn();\n        } else {\n          document.addEventListener('readystatechange', () => {\n            if (document.readyState === 'complete') {\n              resolveFn();\n            }\n          });\n        }\n      }\n      readyPromise.then(function () {\n        callback && callback();\n      });\n    }\n  });\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport {getIsExtends, elementHasBuiltCss, wrap} from './style-util.js';\n\nexport let flush = function () {};\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nfunction getClasses(element) {\n  if (element.classList && element.classList.value) {\n    return element.classList.value;\n  } else {\n    // NOTE: className is patched to remove scoping classes in ShadyDOM\n    // use getAttribute('class') instead, which is unpatched\n    return element.getAttribute('class') || '';\n  }\n}\n\nconst scopeRegExp = new RegExp(`${StyleTransformer.SCOPE_NAME}\\\\s*([^\\\\s]*)`);\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nexport function getCurrentScope(element) {\n  const match = getClasses(element).match(scopeRegExp);\n  if (match) {\n    return match[1];\n  } else {\n    return '';\n  }\n}\n\n/**\n * @param {!Node} node\n */\nexport function getOwnerScope(node) {\n  const ownerRoot = wrap(node).getRootNode();\n  if (ownerRoot === node || ownerRoot === node.ownerDocument) {\n    return '';\n  }\n  const host = /** @type {!ShadowRoot} */ (ownerRoot).host;\n  if (!host) {\n    // this may actually be a document fragment\n    return '';\n  }\n  return getIsExtends(host).is;\n}\n\n/**\n * @param {!Element} element\n */\nexport function ensureCorrectScope(element) {\n  const currentScope = getCurrentScope(element);\n  const ownerRoot = wrap(element).getRootNode();\n  if (ownerRoot === element) {\n    return;\n  }\n  if (currentScope && ownerRoot === element.ownerDocument) {\n    // node was scoped, but now is in document\n    StyleTransformer.domRemoveScope(element, currentScope);\n  } else if (ownerRoot instanceof ShadowRoot) {\n    const ownerScope = getOwnerScope(element);\n    if (ownerScope !== currentScope) {\n      // node was scoped, but not by its current owner\n      StyleTransformer.domReplaceScope(element, currentScope, ownerScope);\n    }\n  }\n}\n\n/**\n * @param {!HTMLElement|!HTMLDocument} element\n */\nexport function ensureCorrectSubtreeScoping(element) {\n  // find unscoped subtree nodes\n  const unscopedNodes = window['ShadyDOM']['nativeMethods'][\n    'querySelectorAll'\n  ].call(element, `:not(.${StyleTransformer.SCOPE_NAME})`);\n\n  for (let j = 0; j < unscopedNodes.length; j++) {\n    // it's possible, during large batch inserts, that nodes that aren't\n    // scoped within the current scope were added.\n    // To make sure that any unscoped nodes that were inserted in the current batch are correctly styled,\n    // query all unscoped nodes and force their style-scope to be applied.\n    // This could happen if a sub-element appended an unscoped node in its shadowroot and this function\n    // runs on a parent element of the host of that unscoped node:\n    // parent-element -> element -> unscoped node\n    // Here unscoped node should have the style-scope element, not parent-element.\n    const unscopedNode = unscopedNodes[j];\n    const scopeForPreviouslyUnscopedNode = getOwnerScope(unscopedNode);\n    if (scopeForPreviouslyUnscopedNode) {\n      StyleTransformer.element(unscopedNode, scopeForPreviouslyUnscopedNode);\n    }\n  }\n}\n\n/**\n * @param {HTMLElement} el\n * @return {boolean}\n */\nfunction isElementWithBuiltCss(el) {\n  if (el.localName === 'style' || el.localName === 'template') {\n    return elementHasBuiltCss(el);\n  }\n  return false;\n}\n\n/**\n * @param {Array<MutationRecord|null>|null} mxns\n */\nfunction handler(mxns) {\n  for (let x = 0; x < mxns.length; x++) {\n    let mxn = mxns[x];\n    if (\n      mxn.target === document.documentElement ||\n      mxn.target === document.head\n    ) {\n      continue;\n    }\n    for (let i = 0; i < mxn.addedNodes.length; i++) {\n      let n = mxn.addedNodes[i];\n      if (n.nodeType !== Node.ELEMENT_NODE) {\n        continue;\n      }\n      n = /** @type {HTMLElement} */ (n); // eslint-disable-line no-self-assign\n      let root = n.getRootNode();\n      let currentScope = getCurrentScope(n);\n      // node was scoped, but now is in document\n      // If this element has built css, we must not remove scoping as this node\n      // will be used as a template or style without re - applying scoping as an optimization\n      if (\n        currentScope &&\n        root === n.ownerDocument &&\n        !isElementWithBuiltCss(n)\n      ) {\n        StyleTransformer.domRemoveScope(n, currentScope);\n      } else if (root instanceof ShadowRoot) {\n        const newScope = getOwnerScope(n);\n        // rescope current node and subtree if necessary\n        if (newScope !== currentScope) {\n          StyleTransformer.domReplaceScope(n, currentScope, newScope);\n        }\n        // make sure all the subtree elements are scoped correctly\n        ensureCorrectSubtreeScoping(n);\n      }\n    }\n  }\n}\n\n// if native Shadow DOM is being used, or ShadyDOM handles dynamic scoiping, do not activate the MutationObserver\nif (\n  !nativeShadow &&\n  !(window['ShadyDOM'] && window['ShadyDOM']['handlesDynamicScoping'])\n) {\n  let observer = new MutationObserver(handler);\n  let start = (node) => {\n    observer.observe(node, {childList: true, subtree: true});\n  };\n  let nativeCustomElements =\n    window['customElements'] &&\n    !window['customElements']['polyfillWrapFlushCallback'];\n  // need to start immediately with native custom elements\n  // TODO(dfreedm): with polyfilled HTMLImports and native custom elements\n  // excessive mutations may be observed; this can be optimized via cooperation\n  // with the HTMLImports polyfill.\n  if (nativeCustomElements) {\n    start(document);\n  } else {\n    let delayedStart = () => {\n      start(document.body);\n    };\n    // use polyfill timing if it's available\n    if (window['HTMLImports']) {\n      window['HTMLImports']['whenReady'](delayedStart);\n      // otherwise push beyond native imports being ready\n      // which requires RAF + readystate interactive.\n    } else {\n      requestAnimationFrame(function () {\n        if (document.readyState === 'loading') {\n          let listener = function () {\n            delayedStart();\n            document.removeEventListener('readystatechange', listener);\n          };\n          document.addEventListener('readystatechange', listener);\n        } else {\n          delayedStart();\n        }\n      });\n    }\n  }\n\n  flush = function () {\n    handler(observer.takeRecords());\n  };\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {parse, StyleNode} from './css-parse.js';\n// prettier-ignore\nimport {nativeShadow, nativeCssVariables, disableRuntime} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport StyleProperties from './style-properties.js';\n// prettier-ignore\nimport {ensureStylePlaceholder, getStylePlaceholder} from './style-placeholder.js';\nimport StyleInfo from './style-info.js';\nimport StyleCache from './style-cache.js';\n// prettier-ignore\nimport {flush as watcherFlush, getOwnerScope, getCurrentScope} from './document-watcher.js';\nimport templateMap from './template-map.js';\nimport * as ApplyShimUtils from './apply-shim-utils.js';\nimport {updateNativeProperties, detectMixin} from './common-utils.js';\n// prettier-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport {CustomStyleInterfaceInterface, CustomStyleProvider} from './custom-style-interface.js';\n\n/** @type {!Object<string, string>} */\nconst adoptedCssTextMap = {};\n\n/**\n * @const {StyleCache}\n */\nconst styleCache = new StyleCache();\n\nexport default class ScopingShim {\n  constructor() {\n    this._scopeCounter = {};\n    this._documentOwner = /** @type {!HTMLElement} */ (document.documentElement);\n    let ast = new StyleNode();\n    ast['rules'] = [];\n    this._documentOwnerStyleInfo = StyleInfo.set(\n      this._documentOwner,\n      new StyleInfo(ast)\n    );\n    this._elementsHaveApplied = false;\n    /** @type {?Object} */\n    this._applyShim = null;\n    /** @type {?CustomStyleInterfaceInterface} */\n    this._customStyleInterface = null;\n  }\n  flush() {\n    watcherFlush();\n  }\n  _generateScopeSelector(name) {\n    let id = (this._scopeCounter[name] = (this._scopeCounter[name] || 0) + 1);\n    return `${name}-${id}`;\n  }\n  getStyleAst(style) {\n    return StyleUtil.rulesForStyle(style);\n  }\n  styleAstToString(ast) {\n    return StyleUtil.toCssText(ast);\n  }\n  _gatherStyles(template) {\n    return StyleUtil.gatherStyleText(template.content);\n  }\n  /**\n   * Prepare the styling and template for the given element type\n   *\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplate(template, elementName, typeExtension) {\n    this.prepareTemplateDom(template, elementName);\n    this.prepareTemplateStyles(template, elementName, typeExtension);\n  }\n  /**\n   * Prepare styling for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplateStyles(template, elementName, typeExtension) {\n    if (template._prepared || disableRuntime) {\n      return;\n    }\n    // style placeholders are only used when ShadyDOM is active\n    if (!nativeShadow) {\n      ensureStylePlaceholder(elementName);\n    }\n    template._prepared = true;\n    template.name = elementName;\n    template.extends = typeExtension;\n    templateMap[elementName] = template;\n    let cssBuild = StyleUtil.getCssBuild(template);\n    const optimalBuild = StyleUtil.isOptimalCssBuild(cssBuild);\n    let info = {\n      is: elementName,\n      extends: typeExtension,\n    };\n    let cssText =\n      this._gatherStyles(template) + (adoptedCssTextMap[elementName] || '');\n    // check if the styling has mixin definitions or uses\n    this._ensure();\n    if (!optimalBuild) {\n      let hasMixins = !cssBuild && detectMixin(cssText);\n      let ast = parse(cssText);\n      // only run the applyshim transforms if there is a mixin involved\n      if (hasMixins && nativeCssVariables && this._applyShim) {\n        this._applyShim['transformRules'](ast, elementName);\n      }\n      template['_styleAst'] = ast;\n    }\n    let ownPropertyNames = [];\n    if (!nativeCssVariables) {\n      ownPropertyNames = StyleProperties.decorateStyles(template['_styleAst']);\n    }\n    if (!ownPropertyNames.length || nativeCssVariables) {\n      let root = nativeShadow ? template.content : null;\n      let placeholder = getStylePlaceholder(elementName);\n      let style = this._generateStaticStyle(\n        info,\n        template['_styleAst'],\n        root,\n        placeholder,\n        cssBuild,\n        optimalBuild ? cssText : ''\n      );\n      template._style = style;\n    }\n    template._ownPropertyNames = ownPropertyNames;\n  }\n\n  /**\n   * @param {!Array<string>} cssTextArray\n   * @param {string} elementName\n   */\n  prepareAdoptedCssText(cssTextArray, elementName) {\n    adoptedCssTextMap[elementName] = cssTextArray.join(' ');\n  }\n  /**\n   * Prepare template for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    if (disableRuntime) {\n      return;\n    }\n    const cssBuild = StyleUtil.getCssBuild(template);\n    if (!nativeShadow && cssBuild !== 'shady' && !template._domPrepared) {\n      template._domPrepared = true;\n      StyleTransformer.domAddScope(template.content, elementName);\n    }\n  }\n  /**\n   * @param {!{is: string, extends: (string|undefined)}} info\n   * @param {!StyleNode} rules\n   * @param {DocumentFragment} shadowroot\n   * @param {Node} placeholder\n   * @param {string} cssBuild\n   * @param {string=} cssText\n   * @return {?HTMLStyleElement}\n   */\n  _generateStaticStyle(\n    info,\n    rules,\n    shadowroot,\n    placeholder,\n    cssBuild,\n    cssText\n  ) {\n    cssText = StyleTransformer.elementStyles(\n      info,\n      rules,\n      null,\n      cssBuild,\n      cssText\n    );\n    if (cssText.length) {\n      return StyleUtil.applyCss(cssText, info.is, shadowroot, placeholder);\n    }\n    return null;\n  }\n  _prepareHost(host) {\n    const {is, typeExtension} = StyleUtil.getIsExtends(host);\n    const placeholder = getStylePlaceholder(is);\n    const template = templateMap[is];\n    if (!template) {\n      return;\n    }\n    const ast = template['_styleAst'];\n    const ownStylePropertyNames = template._ownPropertyNames;\n    const cssBuild = StyleUtil.getCssBuild(template);\n    const styleInfo = new StyleInfo(\n      ast,\n      placeholder,\n      ownStylePropertyNames,\n      is,\n      typeExtension,\n      cssBuild\n    );\n    StyleInfo.set(host, styleInfo);\n    return styleInfo;\n  }\n  /**\n   * Returns a boolean that indicates if styles need to be reprocessed because\n   * the apply shim is now available.\n   * @return {boolean}\n   */\n  _ensureApplyShim() {\n    if (!this._applyShim && window.ShadyCSS && window.ShadyCSS.ApplyShim) {\n      this._applyShim = /** @type {!Object} */ (window.ShadyCSS.ApplyShim);\n      this._applyShim['invalidCallback'] = ApplyShimUtils.invalidate;\n      return true;\n    }\n    return false;\n  }\n  _ensureCustomStyleInterface() {\n    if (this._customStyleInterface) {\n      return;\n    } else if (window.ShadyCSS && window.ShadyCSS.CustomStyleInterface) {\n      this._customStyleInterface = /** @type {!CustomStyleInterfaceInterface} */ (window\n        .ShadyCSS.CustomStyleInterface);\n      /** @type {function(!HTMLStyleElement)} */\n      this._customStyleInterface['transformCallback'] = (style) => {\n        this.transformCustomStyleForDocument(style);\n      };\n      this._customStyleInterface['validateCallback'] = () => {\n        requestAnimationFrame(() => {\n          if (\n            this._customStyleInterface['enqueued'] ||\n            this._elementsHaveApplied\n          ) {\n            this.flushCustomStyles();\n          }\n        });\n      };\n    }\n  }\n  /**\n   * Returns a boolean that indicates if styles need to be reprocessed because\n   * the apply shim is now available.\n   * @return {boolean}\n   */\n  _ensure() {\n    const needsApplyShimUpdate = this._ensureApplyShim();\n    this._ensureCustomStyleInterface();\n    return needsApplyShimUpdate;\n  }\n  /**\n   * Flush and apply custom styles to document\n   */\n  flushCustomStyles() {\n    if (disableRuntime) {\n      return;\n    }\n    const needsApplyShimUpdate = this._ensure();\n    if (!this._customStyleInterface) {\n      return;\n    }\n    let customStyles = this._customStyleInterface['processStyles']();\n    // early return if custom-styles don't need validation\n    if (!needsApplyShimUpdate && !this._customStyleInterface['enqueued']) {\n      return;\n    }\n    // bail if custom styles are built optimally\n    if (StyleUtil.isOptimalCssBuild(this._documentOwnerStyleInfo.cssBuild)) {\n      return;\n    }\n    if (!nativeCssVariables) {\n      this._reorderCustomStylesRules(customStyles);\n      this._updateProperties(this._documentOwner, this._documentOwnerStyleInfo);\n      this._applyCustomStyles(customStyles);\n      if (this._elementsHaveApplied) {\n        // if custom elements have upgraded and there are no native css variables, we must recalculate the whole tree\n        this.styleDocument();\n      }\n    } else if (!this._documentOwnerStyleInfo.cssBuild) {\n      this._revalidateCustomStyleApplyShim(customStyles);\n    }\n    this._customStyleInterface['enqueued'] = false;\n  }\n  /**\n   * Reorder of custom styles for Custom Property shim\n   * @param {!Array<!CustomStyleProvider>} customStyles\n   */\n  _reorderCustomStylesRules(customStyles) {\n    const styles = customStyles\n      .map((c) => this._customStyleInterface['getStyleForCustomStyle'](c))\n      .filter((s) => !!s);\n    // sort styles in document order\n    styles.sort((a, b) => {\n      // use `b.compare(a)` to be more straightforward\n      const position = b.compareDocumentPosition(a);\n      if (position & Node.DOCUMENT_POSITION_FOLLOWING) {\n        // A is after B, A should be higher sorted\n        return 1;\n      } else if (position & Node.DOCUMENT_POSITION_PRECEDING) {\n        // A is before B, A should be lower sorted\n        return -1;\n      } else {\n        return 0;\n      }\n    });\n    // sort ast ordering for document\n    this._documentOwnerStyleInfo.styleRules['rules'] = styles.map((s) =>\n      StyleUtil.rulesForStyle(s)\n    );\n  }\n  /**\n   * Apply styles for the given element\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} overrideProps\n   */\n  styleElement(host, overrideProps) {\n    if (disableRuntime) {\n      if (overrideProps) {\n        if (!StyleInfo.get(host)) {\n          StyleInfo.set(host, new StyleInfo(null));\n        }\n        const styleInfo = /** @type {!StyleInfo} */ (StyleInfo.get(host));\n        this._mixOverrideStyleProps(styleInfo, overrideProps);\n        this.styleElementNativeVariables(host, styleInfo);\n      }\n      return;\n    }\n    const styleInfo = StyleInfo.get(host) || this._prepareHost(host);\n    // if there is no style info at this point, bail\n    if (!styleInfo) {\n      return;\n    }\n    // Only trip the `elementsHaveApplied` flag if a node other that the root document has `applyStyle` called\n    if (!this._isRootOwner(host)) {\n      this._elementsHaveApplied = true;\n    }\n    if (overrideProps) {\n      this._mixOverrideStyleProps(styleInfo, overrideProps);\n    }\n    if (!nativeCssVariables) {\n      this.styleElementShimVariables(host, styleInfo);\n    } else {\n      this.styleElementNativeVariables(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!StyleInfo} styleInfo\n   * @param {Object} overrideProps\n   */\n  _mixOverrideStyleProps(styleInfo, overrideProps) {\n    styleInfo.overrideStyleProperties = styleInfo.overrideStyleProperties || {};\n    Object.assign(styleInfo.overrideStyleProperties, overrideProps);\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementShimVariables(host, styleInfo) {\n    this.flush();\n    this._updateProperties(host, styleInfo);\n    if (\n      styleInfo.ownStylePropertyNames &&\n      styleInfo.ownStylePropertyNames.length\n    ) {\n      this._applyStyleProperties(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementNativeVariables(host, styleInfo) {\n    const {is} = StyleUtil.getIsExtends(host);\n    if (styleInfo.overrideStyleProperties) {\n      updateNativeProperties(host, styleInfo.overrideStyleProperties);\n    }\n    const template = templateMap[is];\n    // bail early if there is no shadowroot for this element\n    if (!template && !this._isRootOwner(host)) {\n      return;\n    }\n    // bail early if the template was built with polymer-css-build\n    if (template && StyleUtil.elementHasBuiltCss(template)) {\n      return;\n    }\n    if (\n      template &&\n      template._style &&\n      !ApplyShimUtils.templateIsValid(template)\n    ) {\n      // update template\n      if (!ApplyShimUtils.templateIsValidating(template)) {\n        this._ensure();\n        this._applyShim &&\n          this._applyShim['transformRules'](template['_styleAst'], is);\n        template._style.textContent = StyleTransformer.elementStyles(\n          host,\n          styleInfo.styleRules\n        );\n        ApplyShimUtils.startValidatingTemplate(template);\n      }\n      // update instance if native shadowdom\n      if (nativeShadow) {\n        let root = host.shadowRoot;\n        if (root) {\n          let style = root.querySelector('style');\n          if (style) {\n            style.textContent = StyleTransformer.elementStyles(\n              host,\n              styleInfo.styleRules\n            );\n          }\n        }\n      }\n      styleInfo.styleRules = template['_styleAst'];\n    }\n  }\n  _styleOwnerForNode(node) {\n    let root = StyleUtil.wrap(node).getRootNode();\n    let host = root.host;\n    if (host) {\n      if (StyleInfo.get(host) || this._prepareHost(host)) {\n        return host;\n      } else {\n        return this._styleOwnerForNode(host);\n      }\n    }\n    return this._documentOwner;\n  }\n  _isRootOwner(node) {\n    return node === this._documentOwner;\n  }\n  _applyStyleProperties(host, styleInfo) {\n    let is = StyleUtil.getIsExtends(host).is;\n    let cacheEntry = styleCache.fetch(\n      is,\n      styleInfo.styleProperties,\n      styleInfo.ownStylePropertyNames\n    );\n    let cachedScopeSelector = cacheEntry && cacheEntry.scopeSelector;\n    let cachedStyle = cacheEntry ? cacheEntry.styleElement : null;\n    let oldScopeSelector = styleInfo.scopeSelector;\n    // only generate new scope if cached style is not found\n    styleInfo.scopeSelector =\n      cachedScopeSelector || this._generateScopeSelector(is);\n    let style = StyleProperties.applyElementStyle(\n      host,\n      styleInfo.styleProperties,\n      styleInfo.scopeSelector,\n      cachedStyle\n    );\n    if (!nativeShadow) {\n      StyleProperties.applyElementScopeSelector(\n        host,\n        styleInfo.scopeSelector,\n        oldScopeSelector\n      );\n    }\n    if (!cacheEntry) {\n      styleCache.store(\n        is,\n        styleInfo.styleProperties,\n        style,\n        styleInfo.scopeSelector\n      );\n    }\n    return style;\n  }\n  _updateProperties(host, styleInfo) {\n    let owner = this._styleOwnerForNode(host);\n    let ownerStyleInfo = StyleInfo.get(owner);\n    let ownerProperties = ownerStyleInfo.styleProperties;\n    // style owner has not updated properties yet\n    // go up the chain and force property update,\n    // except if the owner is the document\n    if (owner !== this._documentOwner && !ownerProperties) {\n      this._updateProperties(owner, ownerStyleInfo);\n      ownerProperties = ownerStyleInfo.styleProperties;\n    }\n    let props = Object.create(ownerProperties || null);\n    let hostAndRootProps = StyleProperties.hostAndRootPropertiesForScope(\n      host,\n      styleInfo.styleRules,\n      styleInfo.cssBuild\n    );\n    let propertyData = StyleProperties.propertyDataFromStyles(\n      ownerStyleInfo.styleRules,\n      host\n    );\n    let propertiesMatchingHost = propertyData.properties;\n    Object.assign(\n      props,\n      hostAndRootProps.hostProps,\n      propertiesMatchingHost,\n      hostAndRootProps.rootProps\n    );\n    this._mixinOverrideStyles(props, styleInfo.overrideStyleProperties);\n    StyleProperties.reify(props);\n    styleInfo.styleProperties = props;\n  }\n  _mixinOverrideStyles(props, overrides) {\n    for (let p in overrides) {\n      let v = overrides[p];\n      // skip override props if they are not truthy or 0\n      // in order to fall back to inherited values\n      if (v || v === 0) {\n        props[p] = v;\n      }\n    }\n  }\n  /**\n   * Update styles of the whole document\n   *\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    this.styleSubtree(this._documentOwner, properties);\n  }\n  /**\n   * Update styles of a subtree\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} properties\n   */\n  styleSubtree(host, properties) {\n    const wrappedHost = StyleUtil.wrap(host);\n    const root = wrappedHost.shadowRoot;\n    const isRootOwner = this._isRootOwner(host);\n    if (root || isRootOwner) {\n      this.styleElement(host, properties);\n    }\n    const descendantRoot = isRootOwner ? wrappedHost : root;\n    if (descendantRoot) {\n      const descendantHosts = Array.from(\n        descendantRoot.querySelectorAll('*')\n      ).filter((x) => StyleUtil.wrap(x).shadowRoot);\n      for (let i = 0; i < descendantHosts.length; i++) {\n        this.styleSubtree(descendantHosts[i]);\n      }\n    }\n  }\n  /* Custom Style operations */\n  _revalidateCustomStyleApplyShim(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        this._revalidateApplyShim(s);\n      }\n    }\n  }\n  _applyCustomStyles(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        StyleProperties.applyCustomStyle(\n          s,\n          this._documentOwnerStyleInfo.styleProperties\n        );\n      }\n    }\n  }\n  transformCustomStyleForDocument(style) {\n    const cssBuild = StyleUtil.getCssBuild(style);\n    if (cssBuild !== this._documentOwnerStyleInfo.cssBuild) {\n      this._documentOwnerStyleInfo.cssBuild = cssBuild;\n    }\n    if (StyleUtil.isOptimalCssBuild(cssBuild)) {\n      return;\n    }\n    let ast = StyleUtil.rulesForStyle(style);\n    StyleUtil.forEachRule(ast, (rule) => {\n      if (nativeShadow) {\n        StyleTransformer.normalizeRootSelector(rule);\n      } else {\n        StyleTransformer.documentRule(rule);\n      }\n      if (nativeCssVariables && cssBuild === '') {\n        this._ensure();\n        this._applyShim && this._applyShim['transformRule'](rule);\n      }\n    });\n    if (nativeCssVariables) {\n      style.textContent = StyleUtil.toCssText(ast);\n    } else {\n      this._documentOwnerStyleInfo.styleRules['rules'].push(ast);\n    }\n  }\n  _revalidateApplyShim(style) {\n    if (nativeCssVariables && this._applyShim) {\n      let ast = StyleUtil.rulesForStyle(style);\n      this._ensure();\n      this._applyShim['transformRules'](ast);\n      style.textContent = StyleUtil.toCssText(ast);\n    }\n  }\n  getComputedStyleValue(element, property) {\n    let value;\n    if (!nativeCssVariables) {\n      // element is either a style host, or an ancestor of a style host\n      let styleInfo =\n        StyleInfo.get(element) ||\n        StyleInfo.get(this._styleOwnerForNode(element));\n      value = styleInfo.styleProperties[property];\n    }\n    // fall back to the property value from the computed styling\n    value =\n      value || window.getComputedStyle(element).getPropertyValue(property);\n    // trim whitespace that can come after the `:` in css\n    // example: padding: 2px -> \" 2px\"\n    return value ? value.trim() : '';\n  }\n  // given an element and a classString, replaces\n  // the element's class with the provided classString and adds\n  // any necessary ShadyCSS static and property based scoping selectors\n  setElementClass(element, classString) {\n    let root = StyleUtil.wrap(element).getRootNode();\n    let classes;\n    if (classString) {\n      let definitelyString =\n        typeof classString === 'string' ? classString : String(classString);\n      classes = definitelyString.split(/\\s/);\n    } else {\n      classes = [];\n    }\n    let scopeName = root.host && root.host.localName;\n    // If no scope, try to discover scope name from existing class.\n    // This can occur if, for example, a template stamped element that\n    // has been scoped is manipulated when not in a root.\n    if (!scopeName) {\n      var classAttr = element.getAttribute('class');\n      if (classAttr) {\n        let k$ = classAttr.split(/\\s/);\n        for (let i = 0; i < k$.length; i++) {\n          if (k$[i] === StyleTransformer.SCOPE_NAME) {\n            scopeName = k$[i + 1];\n            break;\n          }\n        }\n      }\n    }\n    if (scopeName) {\n      classes.push(StyleTransformer.SCOPE_NAME, scopeName);\n    }\n    if (!nativeCssVariables) {\n      let styleInfo = StyleInfo.get(element);\n      if (styleInfo && styleInfo.scopeSelector) {\n        classes.push(StyleProperties.XSCOPE_NAME, styleInfo.scopeSelector);\n      }\n    }\n    StyleUtil.setElementClassRaw(element, classes.join(' '));\n  }\n  _styleInfoForNode(node) {\n    return StyleInfo.get(node);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  scopeNode(node, scope) {\n    StyleTransformer.element(node, scope);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  unscopeNode(node, scope) {\n    StyleTransformer.element(node, scope, true);\n  }\n  /**\n   * @param {!Node} node\n   * @return {string}\n   */\n  scopeForNode(node) {\n    return getOwnerScope(node);\n  }\n  /**\n   * @param {!Element} node\n   * @return {string}\n   */\n  currentScopeForNode(node) {\n    return getCurrentScope(node);\n  }\n}\n\n/* exports */\n/* eslint-disable no-self-assign */\nScopingShim.prototype['flush'] = ScopingShim.prototype.flush;\nScopingShim.prototype['prepareTemplate'] =\n  ScopingShim.prototype.prepareTemplate;\nScopingShim.prototype['styleElement'] = ScopingShim.prototype.styleElement;\nScopingShim.prototype['styleDocument'] = ScopingShim.prototype.styleDocument;\nScopingShim.prototype['styleSubtree'] = ScopingShim.prototype.styleSubtree;\nScopingShim.prototype['getComputedStyleValue'] =\n  ScopingShim.prototype.getComputedStyleValue;\nScopingShim.prototype['setElementClass'] =\n  ScopingShim.prototype.setElementClass;\nScopingShim.prototype['_styleInfoForNode'] =\n  ScopingShim.prototype._styleInfoForNode;\nScopingShim.prototype['transformCustomStyleForDocument'] =\n  ScopingShim.prototype.transformCustomStyleForDocument;\nScopingShim.prototype['getStyleAst'] = ScopingShim.prototype.getStyleAst;\nScopingShim.prototype['styleAstToString'] =\n  ScopingShim.prototype.styleAstToString;\nScopingShim.prototype['flushCustomStyles'] =\n  ScopingShim.prototype.flushCustomStyles;\nScopingShim.prototype['scopeNode'] = ScopingShim.prototype.scopeNode;\nScopingShim.prototype['unscopeNode'] = ScopingShim.prototype.unscopeNode;\nScopingShim.prototype['scopeForNode'] = ScopingShim.prototype.scopeForNode;\nScopingShim.prototype['currentScopeForNode'] =\n  ScopingShim.prototype.currentScopeForNode;\nScopingShim.prototype['prepareAdoptedCssText'] =\n  ScopingShim.prototype.prepareAdoptedCssText;\n/* eslint-enable no-self-assign */\nObject.defineProperties(ScopingShim.prototype, {\n  'nativeShadow': {\n    get() {\n      return nativeShadow;\n    },\n  },\n  'nativeCss': {\n    get() {\n      return nativeCssVariables;\n    },\n  },\n});\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n'use strict';\n\nexport default class StyleCache {\n  constructor(typeMax = 100) {\n    // map element name -> [{properties, styleElement, scopeSelector}]\n    this.cache = {};\n    /** @type {number} */\n    this.typeMax = typeMax;\n  }\n\n  _validate(cacheEntry, properties, ownPropertyNames) {\n    for (let idx = 0; idx < ownPropertyNames.length; idx++) {\n      let pn = ownPropertyNames[idx];\n      if (cacheEntry.properties[pn] !== properties[pn]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  store(tagname, properties, styleElement, scopeSelector) {\n    let list = this.cache[tagname] || [];\n    list.push({properties, styleElement, scopeSelector});\n    if (list.length > this.typeMax) {\n      list.shift();\n    }\n    this.cache[tagname] = list;\n  }\n\n  fetch(tagname, properties, ownPropertyNames) {\n    let list = this.cache[tagname];\n    if (!list) {\n      return;\n    }\n    // reverse list for most-recent lookups\n    for (let idx = list.length - 1; idx >= 0; idx--) {\n      let entry = list[idx];\n      if (this._validate(entry, properties, ownPropertyNames)) {\n        return entry;\n      }\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/** @const {string} */\nconst infoKey = '__styleInfo';\n\nexport default class StyleInfo {\n  /**\n   * @param {Element} node\n   * @return {StyleInfo}\n   */\n  static get(node) {\n    if (node) {\n      return node[infoKey];\n    } else {\n      return null;\n    }\n  }\n  /**\n   * @param {!Element} node\n   * @param {StyleInfo} styleInfo\n   * @return {StyleInfo}\n   */\n  static set(node, styleInfo) {\n    node[infoKey] = styleInfo;\n    return styleInfo;\n  }\n  /**\n   * @param {StyleNode} ast\n   * @param {Node=} placeholder\n   * @param {Array<string>=} ownStylePropertyNames\n   * @param {string=} elementName\n   * @param {string=} typeExtension\n   * @param {string=} cssBuild\n   */\n  constructor(\n    ast,\n    placeholder,\n    ownStylePropertyNames,\n    elementName,\n    typeExtension,\n    cssBuild\n  ) {\n    /** @type {StyleNode} */\n    this.styleRules = ast || null;\n    /** @type {Node} */\n    this.placeholder = placeholder || null;\n    /** @type {!Array<string>} */\n    this.ownStylePropertyNames = ownStylePropertyNames || [];\n    /** @type {Object} */\n    this.overrideStyleProperties = null;\n    /** @type {string} */\n    this.elementName = elementName || '';\n    /** @type {string} */\n    this.cssBuild = cssBuild || '';\n    /** @type {string} */\n    this.typeExtension = typeExtension || '';\n    /** @type {Object<string, string>} */\n    this.styleProperties = null;\n    /** @type {?string} */\n    this.scopeSelector = null;\n    /** @type {HTMLStyleElement} */\n    this.customStyle = null;\n  }\n  _getStyleRules() {\n    return this.styleRules;\n  }\n}\n\n/* eslint-disable-next-line no-self-assign */\nStyleInfo.prototype['_getStyleRules'] = StyleInfo.prototype._getStyleRules;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {applyStylePlaceHolder} from './style-util.js';\nimport {nativeShadow, disableRuntime} from './style-settings.js';\n\n/** @type {!Object<string, !Node>} */\nconst placeholderMap = {};\n\n/**\n * @param {string} elementName\n * @return {Node}\n */\nexport function getStylePlaceholder(elementName) {\n  return placeholderMap[elementName] || null;\n}\n\n/**\n * @param {string} elementName\n */\nexport function ensureStylePlaceholder(elementName) {\n  if (!placeholderMap[elementName]) {\n    placeholderMap[elementName] = applyStylePlaceHolder(elementName);\n  }\n}\n\n/**\n * @const {CustomElementRegistry}\n */\nconst ce = window['customElements'];\nif (ce && !nativeShadow && !disableRuntime) {\n  /**\n   * @const {function(this:CustomElementRegistry, string,function(new:HTMLElement),{extends: string}=)}\n   */\n  const origDefine = ce['define'];\n  /**\n   * @param {string} name\n   * @param {function(new:HTMLElement)} clazz\n   * @param {{extends: string}=} options\n   */\n  const wrappedDefine = (name, clazz, options) => {\n    ensureStylePlaceholder(name);\n    origDefine.call(\n      /** @type {!CustomElementRegistry} */ (ce),\n      name,\n      clazz,\n      options\n    );\n  };\n  ce['define'] = wrappedDefine;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {removeCustomPropAssignment, StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport * as RX from './common-regex.js';\nimport StyleInfo from './style-info.js';\n\n// TODO: dedupe with shady\n/**\n * @param {string} selector\n * @return {boolean}\n * @this {Element}\n */\nconst matchesSelector = function (selector) {\n  const method =\n    this.matches ||\n    this.matchesSelector ||\n    this.mozMatchesSelector ||\n    this.msMatchesSelector ||\n    this.oMatchesSelector ||\n    this.webkitMatchesSelector;\n  return method && method.call(this, selector);\n};\n\nconst rootSelector = /:host\\s*>\\s*/;\n\nfunction checkRoot(hostScope, selector) {\n  return (\n    Boolean(selector.match(rootSelector)) ||\n    (hostScope === 'html' && selector.indexOf('html') > -1)\n  );\n}\n\nconst IS_IE = navigator.userAgent.match('Trident');\n\nconst XSCOPE_NAME = 'x-scope';\n\nclass StyleProperties {\n  /** @return {string} */\n  get XSCOPE_NAME() {\n    return XSCOPE_NAME;\n  }\n  /**\n   * decorates styles with rule info and returns an array of used style property names\n   *\n   * @param {StyleNode} rules\n   * @return {!Array<string>}\n   */\n  decorateStyles(rules) {\n    let self = this,\n      props = {},\n      keyframes = [],\n      ruleIndex = 0;\n    StyleUtil.forEachRule(\n      rules,\n      function (rule) {\n        self.decorateRule(rule);\n        // mark in-order position of ast rule in styles block, used for cache key\n        rule.index = ruleIndex++;\n        self.collectPropertiesInCssText(rule.propertyInfo.cssText, props);\n      },\n      function onKeyframesRule(rule) {\n        keyframes.push(rule);\n      }\n    );\n    // Cache all found keyframes rules for later reference:\n    rules._keyframes = keyframes;\n    // return this list of property names *consumes* in these styles.\n    let names = [];\n    for (let i in props) {\n      names.push(i);\n    }\n    return names;\n  }\n\n  // decorate a single rule with property info\n  decorateRule(rule) {\n    if (rule.propertyInfo) {\n      return rule.propertyInfo;\n    }\n    let info = {},\n      properties = {};\n    let hasProperties = this.collectProperties(rule, properties);\n    if (hasProperties) {\n      info.properties = properties;\n      // TODO(sorvell): workaround parser seeing mixins as additional rules\n      rule['rules'] = null;\n    }\n    info.cssText = this.collectCssText(rule);\n    rule.propertyInfo = info;\n    return info;\n  }\n\n  // collects the custom properties from a rule's cssText\n  collectProperties(rule, properties) {\n    let info = rule.propertyInfo;\n    if (info) {\n      if (info.properties) {\n        Object.assign(properties, info.properties);\n        return true;\n      }\n    } else {\n      let m,\n        rx = RX.VAR_ASSIGN;\n      let cssText = rule['parsedCssText'];\n      let value;\n      let any;\n      while ((m = rx.exec(cssText))) {\n        // note: group 2 is var, 3 is mixin\n        value = (m[2] || m[3]).trim();\n        // value of 'inherit' or 'unset' is equivalent to not setting the property here\n        if (value !== 'inherit' || value !== 'unset') {\n          properties[m[1].trim()] = value;\n        }\n        any = true;\n      }\n      return any;\n    }\n  }\n\n  // returns cssText of properties that consume variables/mixins\n  collectCssText(rule) {\n    return this.collectConsumingCssText(rule['parsedCssText']);\n  }\n\n  // NOTE: we support consumption inside mixin assignment\n  // but not production, so strip out {...}\n  collectConsumingCssText(cssText) {\n    return cssText.replace(RX.BRACKETED, '').replace(RX.VAR_ASSIGN, '');\n  }\n\n  collectPropertiesInCssText(cssText, props) {\n    let m;\n    while ((m = RX.VAR_CONSUMED.exec(cssText))) {\n      let name = m[1];\n      // This regex catches all variable names, and following non-whitespace char\n      // If next char is not ':', then variable is a consumer\n      if (m[2] !== ':') {\n        props[name] = true;\n      }\n    }\n  }\n\n  // turns custom properties into realized values.\n  reify(props) {\n    // big perf optimization here: reify only *own* properties\n    // since this object has __proto__ of the element's scope properties\n    let names = Object.getOwnPropertyNames(props);\n    for (let i = 0, n; i < names.length; i++) {\n      n = names[i];\n      props[n] = this.valueForProperty(props[n], props);\n    }\n  }\n\n  // given a property value, returns the reified value\n  // a property value may be:\n  // (1) a literal value like: red or 5px;\n  // (2) a variable value like: var(--a), var(--a, red), or var(--a, --b) or\n  // var(--a, var(--b));\n  // (3) a literal mixin value like { properties }. Each of these properties\n  // can have values that are: (a) literal, (b) variables, (c) @apply mixins.\n  valueForProperty(property, props) {\n    // case (1) default\n    // case (3) defines a mixin and we have to reify the internals\n    if (property) {\n      if (property.indexOf(';') >= 0) {\n        property = this.valueForProperties(property, props);\n      } else {\n        // case (2) variable\n        let self = this;\n        let fn = function (prefix, value, fallback, suffix) {\n          if (!value) {\n            return prefix + suffix;\n          }\n          let propertyValue = self.valueForProperty(props[value], props);\n          // if value is \"initial\", then the variable should be treated as unset\n          if (!propertyValue || propertyValue === 'initial') {\n            // fallback may be --a or var(--a) or literal\n            propertyValue =\n              self.valueForProperty(props[fallback] || fallback, props) ||\n              fallback;\n          } else if (propertyValue === 'apply-shim-inherit') {\n            // CSS build will replace `inherit` with `apply-shim-inherit`\n            // for use with native css variables.\n            // Since we have full control, we can use `inherit` directly.\n            propertyValue = 'inherit';\n          }\n          return prefix + (propertyValue || '') + suffix;\n        };\n        property = StyleUtil.processVariableAndFallback(property, fn);\n      }\n    }\n    return (property && property.trim()) || '';\n  }\n\n  // note: we do not yet support mixin within mixin\n  valueForProperties(property, props) {\n    let parts = property.split(';');\n    for (let i = 0, p, m; i < parts.length; i++) {\n      if ((p = parts[i])) {\n        RX.MIXIN_MATCH.lastIndex = 0;\n        m = RX.MIXIN_MATCH.exec(p);\n        if (m) {\n          p = this.valueForProperty(props[m[1]], props);\n        } else {\n          let colon = p.indexOf(':');\n          if (colon !== -1) {\n            let pp = p.substring(colon);\n            pp = pp.trim();\n            pp = this.valueForProperty(pp, props) || pp;\n            p = p.substring(0, colon) + pp;\n          }\n        }\n        parts[i] =\n          p && p.lastIndexOf(';') === p.length - 1\n            ? p.slice(0, -1) // strip trailing ;\n            : p || '';\n      }\n    }\n    return parts.join(';');\n  }\n\n  applyProperties(rule, props) {\n    let output = '';\n    // dynamically added sheets may not be decorated so ensure they are.\n    if (!rule.propertyInfo) {\n      this.decorateRule(rule);\n    }\n    if (rule.propertyInfo.cssText) {\n      output = this.valueForProperties(rule.propertyInfo.cssText, props);\n    }\n    rule['cssText'] = output;\n  }\n\n  // Apply keyframe transformations to the cssText of a given rule. The\n  // keyframeTransforms object is a map of keyframe names to transformer\n  // functions which take in cssText and spit out transformed cssText.\n  applyKeyframeTransforms(rule, keyframeTransforms) {\n    let input = rule['cssText'];\n    let output = rule['cssText'];\n    if (rule.hasAnimations == null) {\n      // Cache whether or not the rule has any animations to begin with:\n      rule.hasAnimations = RX.ANIMATION_MATCH.test(input);\n    }\n    // If there are no animations referenced, we can skip transforms:\n    if (rule.hasAnimations) {\n      let transform;\n      // If we haven't transformed this rule before, we iterate over all\n      // transforms:\n      if (rule.keyframeNamesToTransform == null) {\n        rule.keyframeNamesToTransform = [];\n        for (let keyframe in keyframeTransforms) {\n          transform = keyframeTransforms[keyframe];\n          output = transform(input);\n          // If the transform actually changed the CSS text, we cache the\n          // transform name for future use:\n          if (input !== output) {\n            input = output;\n            rule.keyframeNamesToTransform.push(keyframe);\n          }\n        }\n      } else {\n        // If we already have a list of keyframe names that apply to this\n        // rule, we apply only those keyframe name transforms:\n        for (let i = 0; i < rule.keyframeNamesToTransform.length; ++i) {\n          transform = keyframeTransforms[rule.keyframeNamesToTransform[i]];\n          input = transform(input);\n        }\n        output = input;\n      }\n    }\n    rule['cssText'] = output;\n  }\n\n  // Test if the rules in these styles matches the given `element` and if so,\n  // collect any custom properties into `props`.\n  /**\n   * @param {StyleNode} rules\n   * @param {Element} element\n   */\n  propertyDataFromStyles(rules, element) {\n    let props = {};\n    // generates a unique key for these matches\n    let o = [];\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(\n      rules,\n      (rule) => {\n        // TODO(sorvell): we could trim the set of rules at declaration\n        // time to only include ones that have properties\n        if (!rule.propertyInfo) {\n          this.decorateRule(rule);\n        }\n        // match element against transformedSelector: selector may contain\n        // unwanted uniquification and parsedSelector does not directly match\n        // for :host selectors.\n        let selectorToMatch =\n          rule.transformedSelector || rule['parsedSelector'];\n        if (element && rule.propertyInfo.properties && selectorToMatch) {\n          if (matchesSelector.call(element, selectorToMatch)) {\n            this.collectProperties(rule, props);\n            // produce numeric key for these matches for lookup\n            addToBitMask(rule.index, o);\n          }\n        }\n      },\n      null,\n      true\n    );\n    return {properties: props, key: o};\n  }\n\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rule\n   * @param {string} cssBuild\n   * @param {function(Object)} callback\n   */\n  whenHostOrRootRule(scope, rule, cssBuild, callback) {\n    if (!(/** @type {?} */ (rule.propertyInfo))) {\n      this.decorateRule(rule);\n    }\n    if (!(/** @type {?} */ (rule.propertyInfo).properties)) {\n      return;\n    }\n    let {is, typeExtension} = StyleUtil.getIsExtends(scope);\n    let hostScope = is\n      ? StyleTransformer._calcHostScope(is, typeExtension)\n      : 'html';\n    let parsedSelector = rule['parsedSelector'];\n    let isRoot = checkRoot(hostScope, parsedSelector);\n    let isHost = parsedSelector.indexOf(':host') === 0 && !isRoot;\n    // build info is either in scope (when scope is an element) or in the style\n    // when scope is the default scope; note: this allows default scope to have\n    // mixed mode built and unbuilt styles.\n    if (cssBuild === 'shady') {\n      // :root -> x-foo > *.x-foo for elements and html for custom-style\n      isRoot =\n        parsedSelector === hostScope + ' > *.' + hostScope ||\n        parsedSelector.indexOf('html') !== -1;\n      // :host -> x-foo for elements, but sub-rules have .x-foo in them\n      isHost = !isRoot && parsedSelector.indexOf(hostScope) === 0;\n    }\n    if (!isRoot && !isHost) {\n      return;\n    }\n    let selectorToMatch = hostScope;\n    if (isHost) {\n      // need to transform :host because `:host` does not work with `matches`\n      if (!(/** @type {?} */ (rule.transformedSelector))) {\n        // transform :host into a matchable selector\n        rule.transformedSelector = StyleTransformer._transformRuleCss(\n          rule,\n          StyleTransformer._transformComplexSelector,\n          StyleTransformer._calcElementScope(is),\n          hostScope\n        );\n      }\n      selectorToMatch =\n        /** @type {?} */ (rule.transformedSelector) || hostScope;\n    }\n    if (isRoot && hostScope === 'html') {\n      selectorToMatch =\n        /** @type {?} */ (rule.transformedSelector) ||\n        /** @type {?} */ (rule.parsedSelector);\n    }\n    callback({\n      selector: selectorToMatch,\n      isHost: isHost,\n      isRoot: isRoot,\n    });\n  }\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rules\n   * @param {string} cssBuild\n   * @return {!Object}\n   */\n  hostAndRootPropertiesForScope(scope, rules, cssBuild) {\n    let hostProps = {},\n      rootProps = {};\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(\n      rules,\n      (rule) => {\n        // if scope is StyleDefaults, use _element for matchesSelector\n        this.whenHostOrRootRule(scope, rule, cssBuild, (info) => {\n          let element = scope._element || scope;\n          if (matchesSelector.call(element, info.selector)) {\n            if (info.isHost) {\n              this.collectProperties(rule, hostProps);\n            } else {\n              this.collectProperties(rule, rootProps);\n            }\n          }\n        });\n      },\n      null,\n      true\n    );\n    return {rootProps: rootProps, hostProps: hostProps};\n  }\n\n  /**\n   * @param {Element} element\n   * @param {Object} properties\n   * @param {string} scopeSelector\n   */\n  transformStyles(element, properties, scopeSelector) {\n    let self = this;\n    let {is, typeExtension} = StyleUtil.getIsExtends(element);\n    let hostSelector = StyleTransformer._calcHostScope(is, typeExtension);\n    let rxHostSelector = element.extends\n      ? '\\\\' + hostSelector.slice(0, -1) + '\\\\]'\n      : hostSelector;\n    let hostRx = new RegExp(RX.HOST_PREFIX + rxHostSelector + RX.HOST_SUFFIX);\n    let {styleRules: rules, cssBuild} = StyleInfo.get(element);\n    let keyframeTransforms = this._elementKeyframeTransforms(\n      element,\n      rules,\n      scopeSelector\n    );\n    return StyleTransformer.elementStyles(\n      element,\n      rules,\n      function (rule) {\n        self.applyProperties(rule, properties);\n        if (\n          !nativeShadow &&\n          !StyleUtil.isKeyframesSelector(rule) &&\n          rule['cssText']\n        ) {\n          // NOTE: keyframe transforms only scope munge animation names, so it\n          // is not necessary to apply them in ShadowDOM.\n          self.applyKeyframeTransforms(rule, keyframeTransforms);\n          self._scopeSelector(rule, hostRx, hostSelector, scopeSelector);\n        }\n      },\n      cssBuild\n    );\n  }\n\n  /**\n   * @param {Element} element\n   * @param {StyleNode} rules\n   * @param {string} scopeSelector\n   * @return {!Object}\n   */\n  _elementKeyframeTransforms(element, rules, scopeSelector) {\n    let keyframesRules = rules._keyframes;\n    let keyframeTransforms = {};\n    if (!nativeShadow && keyframesRules) {\n      // For non-ShadowDOM, we transform all known keyframes rules in\n      // advance for the current scope. This allows us to catch keyframes\n      // rules that appear anywhere in the stylesheet:\n      for (\n        let i = 0, keyframesRule = keyframesRules[i];\n        i < keyframesRules.length;\n        keyframesRule = keyframesRules[++i]\n      ) {\n        this._scopeKeyframes(keyframesRule, scopeSelector);\n        keyframeTransforms[\n          keyframesRule['keyframesName']\n        ] = this._keyframesRuleTransformer(keyframesRule);\n      }\n    }\n    return keyframeTransforms;\n  }\n\n  // Generate a factory for transforming a chunk of CSS text to handle a\n  // particular scoped keyframes rule.\n  /**\n   * @param {StyleNode} keyframesRule\n   * @return {function(string):string}\n   */\n  _keyframesRuleTransformer(keyframesRule) {\n    return function (cssText) {\n      return cssText.replace(\n        /** @type {?} */ (keyframesRule.keyframesNameRx),\n        /** @type {?} */ (keyframesRule.transformedKeyframesName)\n      );\n    };\n  }\n\n  /**\n   * Transforms `@keyframes` names to be unique for the current host.\n   * Example: @keyframes foo-anim -> @keyframes foo-anim-x-foo-0\n   *\n   * @param {StyleNode} rule\n   * @param {string} scopeId\n   */\n  _scopeKeyframes(rule, scopeId) {\n    // Animation names are of the form [\\w-], so ensure that the name regex does not partially apply\n    // to similarly named keyframe names by checking for a word boundary at the beginning and\n    // a non-word boundary or `-` at the end.\n    rule.keyframesNameRx = new RegExp(\n      `\\\\b${rule['keyframesName']}(?!\\\\B|-)`,\n      'g'\n    );\n    rule.transformedKeyframesName = rule['keyframesName'] + '-' + scopeId;\n    rule.transformedSelector =\n      /** @type {?} */ (rule.transformedSelector) || rule['selector'];\n    rule['selector'] = /** @type {?} */ (rule.transformedSelector).replace(\n      rule['keyframesName'],\n      rule.transformedKeyframesName\n    );\n  }\n\n  // Strategy: x scope shim a selector e.g. to scope `.x-foo-42` (via classes):\n  // non-host selector: .a.x-foo -> .x-foo-42 .a.x-foo\n  // host selector: x-foo.wide -> .x-foo-42.wide\n  // note: we use only the scope class (.x-foo-42) and not the hostSelector\n  // (x-foo) to scope :host rules; this helps make property host rules\n  // have low specificity. They are overrideable by class selectors but,\n  // unfortunately, not by type selectors (e.g. overriding via\n  // `.special` is ok, but not by `x-foo`).\n  /**\n   * @param {StyleNode} rule\n   * @param {RegExp} hostRx\n   * @param {string} hostSelector\n   * @param {string} scopeId\n   */\n  _scopeSelector(rule, hostRx, hostSelector, scopeId) {\n    rule.transformedSelector =\n      /** @type {?} */ (rule.transformedSelector) || rule['selector'];\n    let selector = rule.transformedSelector;\n    let scope = '.' + scopeId;\n    let parts = StyleUtil.splitSelectorList(selector);\n    for (let i = 0, l = parts.length, p; i < l && (p = parts[i]); i++) {\n      parts[i] = p.match(hostRx)\n        ? p.replace(hostSelector, scope)\n        : scope + ' ' + p;\n    }\n    rule['selector'] = parts.join(',');\n  }\n\n  /**\n   * @param {Element} element\n   * @param {string} selector\n   * @param {string} old\n   */\n  applyElementScopeSelector(element, selector, old) {\n    let c = element.getAttribute('class') || '';\n    let v = c;\n    if (old) {\n      v = c.replace(\n        new RegExp('\\\\s*' + XSCOPE_NAME + '\\\\s*' + old + '\\\\s*', 'g'),\n        ' '\n      );\n    }\n    v += (v ? ' ' : '') + XSCOPE_NAME + ' ' + selector;\n    if (c !== v) {\n      StyleUtil.setElementClassRaw(element, v);\n    }\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object} properties\n   * @param {string} selector\n   * @param {HTMLStyleElement} style\n   * @return {HTMLStyleElement}\n   */\n  applyElementStyle(element, properties, selector, style) {\n    // calculate cssText to apply\n    let cssText = style\n      ? style.textContent || ''\n      : this.transformStyles(element, properties, selector);\n    // if shady and we have a cached style that is not style, decrement\n    let styleInfo = StyleInfo.get(element);\n    let s = styleInfo.customStyle;\n    if (s && !nativeShadow && s !== style) {\n      s['_useCount']--;\n      if (s['_useCount'] <= 0 && s.parentNode) {\n        s.parentNode.removeChild(s);\n      }\n    }\n    // apply styling always under native or if we generated style\n    // or the cached style is not in document(!)\n    if (nativeShadow) {\n      // update existing style only under native\n      if (styleInfo.customStyle) {\n        styleInfo.customStyle.textContent = cssText;\n        style = styleInfo.customStyle;\n        // otherwise, if we have css to apply, do so\n      } else if (cssText) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        style = StyleUtil.applyCss(\n          cssText,\n          selector,\n          element.shadowRoot,\n          styleInfo.placeholder\n        );\n      }\n    } else {\n      // shady and no cache hit\n      if (!style) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        if (cssText) {\n          style = StyleUtil.applyCss(\n            cssText,\n            selector,\n            null,\n            styleInfo.placeholder\n          );\n        }\n        // shady and cache hit but not in document\n      } else if (!style.parentNode) {\n        if (IS_IE && cssText.indexOf('@media') > -1) {\n          // @media rules may be stale in IE 10 and 11\n          // refresh the text content of the style to revalidate them.\n          style.textContent = cssText;\n        }\n        StyleUtil.applyStyle(style, null, styleInfo.placeholder);\n      }\n    }\n    // ensure this style is our custom style and increment its use count.\n    if (style) {\n      style['_useCount'] = style['_useCount'] || 0;\n      // increment use count if we changed styles\n      if (styleInfo.customStyle != style) {\n        style['_useCount']++;\n      }\n      styleInfo.customStyle = style;\n    }\n    return style;\n  }\n\n  /**\n   * @param {Element} style\n   * @param {Object} properties\n   */\n  applyCustomStyle(style, properties) {\n    let rules = StyleUtil.rulesForStyle(\n      /** @type {HTMLStyleElement} */ (style)\n    );\n    let self = this;\n    style.textContent = StyleUtil.toCssText(rules, function (\n      /** StyleNode */ rule\n    ) {\n      let css = (rule['cssText'] = rule['parsedCssText']);\n      if (\n        /** @type {?} */ (rule.propertyInfo) &&\n        /** @type {?} */ (rule.propertyInfo).cssText\n      ) {\n        // remove property assignments\n        // so next function isn't confused\n        // NOTE: we have 3 categories of css:\n        // (1) normal properties,\n        // (2) custom property assignments (--foo: red;),\n        // (3) custom property usage: border: var(--foo); @apply(--foo);\n        // In elements, 1 and 3 are separated for efficiency; here they\n        // are not and this makes this case unique.\n        css = removeCustomPropAssignment(/** @type {string} */ (css));\n        // replace with reified properties, scenario is same as mixin\n        rule['cssText'] = self.valueForProperties(css, properties);\n      }\n    });\n  }\n}\n\n/**\n * @param {number} n\n * @param {Array<number>} bits\n */\nfunction addToBitMask(n, bits) {\n  let o = parseInt(n / 32, 10);\n  let v = 1 << n % 32;\n  bits[o] = (bits[o] || 0) | v;\n}\n\nexport default new StyleProperties();\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nexport const nativeShadow = !(\n  window['ShadyDOM'] && window['ShadyDOM']['inUse']\n);\n/** @type {boolean} */\nlet nativeCssVariables_;\n\n/**\n * @param {(ShadyCSSOptions | ShadyCSSInterface)=} settings\n */\nfunction calcCssVariables(settings) {\n  if (settings && settings.shimcssproperties) {\n    nativeCssVariables_ = false;\n  } else {\n    // chrome 49 has semi-working css vars, check if box-shadow works\n    // safari 9.1 has a recalc bug: https://bugs.webkit.org/show_bug.cgi?id=155782\n    // However, shim css custom properties are only supported with ShadyDOM enabled,\n    // so fall back on native if we do not detect ShadyDOM\n    // Edge 15: custom properties used in ::before and ::after will also be used in the parent element\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12414257/\n    nativeCssVariables_ =\n      nativeShadow ||\n      Boolean(\n        !navigator.userAgent.match(/AppleWebKit\\/601|Edge\\/15/) &&\n          window.CSS &&\n          CSS.supports &&\n          CSS.supports('box-shadow', '0 0 0 var(--foo)')\n      );\n  }\n}\n\n/** @type {string | undefined} */\nexport let cssBuild;\nif (window.ShadyCSS && window.ShadyCSS.cssBuild !== undefined) {\n  cssBuild = window.ShadyCSS.cssBuild;\n}\n\n/** @type {boolean} */\nexport const disableRuntime = Boolean(\n  window.ShadyCSS && window.ShadyCSS.disableRuntime\n);\n\nif (window.ShadyCSS && window.ShadyCSS.nativeCss !== undefined) {\n  nativeCssVariables_ = window.ShadyCSS.nativeCss;\n} else if (window.ShadyCSS) {\n  calcCssVariables(window.ShadyCSS);\n  // reset window variable to let ShadyCSS API take its place\n  window.ShadyCSS = undefined;\n} else {\n  calcCssVariables(window['WebComponents'] && window['WebComponents']['flags']);\n}\n\n// Hack for type error under new type inference which doesn't like that\n// nativeCssVariables is updated in a function and assigns the type\n// `function(): ?` instead of `boolean`.\nexport const nativeCssVariables = /** @type {boolean} */ (nativeCssVariables_);\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport * as StyleUtil from './style-util.js';\nimport {nativeShadow} from './style-settings.js';\n\n/* Transforms ShadowDOM styling into ShadyDOM styling\n\n* scoping:\n\n  * elements in scope get scoping selector class=\"x-foo-scope\"\n  * selectors re-written as follows:\n\n    div button -> div.x-foo-scope button.x-foo-scope\n\n* :host -> scopeName\n\n* :host(...) -> scopeName...\n\n* ::slotted(...) -> scopeName > ...\n\n* ...:dir(ltr|rtl) -> [dir=\"ltr|rtl\"] ..., ...[dir=\"ltr|rtl\"]\n\n* :host(:dir[rtl]) -> scopeName:dir(rtl) -> [dir=\"rtl\"] scopeName, scopeName[dir=\"rtl\"]\n\n*/\nconst SCOPE_NAME = 'style-scope';\n\nclass StyleTransformer {\n  /** @return {string} */\n  get SCOPE_NAME() {\n    return SCOPE_NAME;\n  }\n  /**\n   * Given a node and scope name, add a scoping class to each node\n   * in the tree. This facilitates transforming css into scoped rules.\n   * @param {!Node} node\n   * @param {string} scope\n   * @param {boolean=} shouldRemoveScope\n   * @deprecated\n   */\n  dom(node, scope, shouldRemoveScope) {\n    const fn = (node) => {\n      this.element(node, scope || '', shouldRemoveScope);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * Given a node and scope name, add a scoping class to each node in the tree.\n   * @param {!Node} node\n   * @param {string} scope\n   */\n  domAddScope(node, scope) {\n    const fn = (node) => {\n      this.element(node, scope || '');\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {!Node} startNode\n   * @param {function(!Node)} transformer\n   */\n  _transformDom(startNode, transformer) {\n    if (startNode.nodeType === Node.ELEMENT_NODE) {\n      transformer(startNode);\n    }\n    let c$;\n    if (startNode.localName === 'template') {\n      const template = /** @type {!HTMLTemplateElement} */ (startNode);\n      // In case the template is in svg context, fall back to the node\n      // since it won't be an HTMLTemplateElement with a .content property\n      c$ = (template.content || template._content || template).childNodes;\n    } else {\n      c$ =\n        /** @type {!ParentNode} */ (startNode).children || startNode.childNodes;\n    }\n    if (c$) {\n      for (let i = 0; i < c$.length; i++) {\n        this._transformDom(c$[i], transformer);\n      }\n    }\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} scope\n   * @param {?=} shouldRemoveScope\n   */\n  element(element, scope, shouldRemoveScope) {\n    // note: if using classes, we add both the general 'style-scope' class\n    // as well as the specific scope. This enables easy filtering of all\n    // `style-scope` elements\n    if (scope) {\n      // note: svg on IE does not have classList so fallback to class\n      if (element.classList) {\n        if (shouldRemoveScope) {\n          element.classList.remove(SCOPE_NAME);\n          element.classList.remove(scope);\n        } else {\n          element.classList.add(SCOPE_NAME);\n          element.classList.add(scope);\n        }\n      } else if (element.getAttribute) {\n        let c = element.getAttribute(CLASS);\n        if (shouldRemoveScope) {\n          if (c) {\n            let newValue = c.replace(SCOPE_NAME, '').replace(scope, '');\n            StyleUtil.setElementClassRaw(element, newValue);\n          }\n        } else {\n          let newValue = (c ? c + ' ' : '') + SCOPE_NAME + ' ' + scope;\n          StyleUtil.setElementClassRaw(element, newValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Given a node, replace the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   * @param {string} newScope\n   */\n  domReplaceScope(node, oldScope, newScope) {\n    const fn = (node) => {\n      this.element(node, oldScope, true);\n      this.element(node, newScope);\n    };\n    this._transformDom(node, fn);\n  }\n  /**\n   * Given a node, remove the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   */\n  domRemoveScope(node, oldScope) {\n    const fn = (node) => {\n      this.element(node, oldScope || '', true);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} styleRules\n   * @param {?=} callback\n   * @param {string=} cssBuild\n   * @param {string=} cssText\n   * @return {string}\n   */\n  elementStyles(element, styleRules, callback, cssBuild = '', cssText = '') {\n    // no need to shim selectors if settings.useNativeShadow, also\n    // a shady css build will already have transformed selectors\n    // NOTE: This method may be called as part of static or property shimming.\n    // When there is a targeted build it will not be called for static shimming,\n    // but when the property shim is used it is called and should opt out of\n    // static shimming work when a proper build exists.\n    if (cssText === '') {\n      if (nativeShadow || cssBuild === 'shady') {\n        cssText = StyleUtil.toCssText(styleRules, callback);\n      } else {\n        let {is, typeExtension} = StyleUtil.getIsExtends(element);\n        cssText = this.css(styleRules, is, typeExtension, callback) + '\\n\\n';\n      }\n    }\n    return cssText.trim();\n  }\n\n  // Given a string of cssText and a scoping string (scope), returns\n  // a string of scoped css where each selector is transformed to include\n  // a class created from the scope. ShadowDOM selectors are also transformed\n  // (e.g. :host) to use the scoping selector.\n  css(rules, scope, ext, callback) {\n    let hostScope = this._calcHostScope(scope, ext);\n    scope = this._calcElementScope(scope);\n    let self = this;\n    return StyleUtil.toCssText(rules, function (/** StyleNode */ rule) {\n      if (!(/** @type {?} */ (rule.isScoped))) {\n        self.rule(rule, scope, hostScope);\n        rule.isScoped = true;\n      }\n      if (callback) {\n        callback(rule, scope, hostScope);\n      }\n    });\n  }\n\n  _calcElementScope(scope) {\n    if (scope) {\n      return CSS_CLASS_PREFIX + scope;\n    } else {\n      return '';\n    }\n  }\n\n  _calcHostScope(scope, ext) {\n    return ext ? `[is=${scope}]` : scope;\n  }\n\n  rule(rule, scope, hostScope) {\n    this._transformRule(rule, this._transformComplexSelector, scope, hostScope);\n  }\n\n  /**\n   * transforms a css rule to a scoped rule.\n   *\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRule(rule, transformer, scope, hostScope) {\n    // NOTE: save transformedSelector for subsequent matching of elements\n    // against selectors (e.g. when calculating style properties)\n    rule[\n      'selector'\n    ] = /** @type {?} */ (rule).transformedSelector = this._transformRuleCss(\n      rule,\n      transformer,\n      scope,\n      hostScope\n    );\n  }\n\n  /**\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRuleCss(rule, transformer, scope, hostScope) {\n    let p$ = StyleUtil.splitSelectorList(rule['selector']);\n    // we want to skip transformation of rules that appear in keyframes,\n    // because they are keyframe selectors, not element selectors.\n    if (!StyleUtil.isKeyframesSelector(rule)) {\n      for (let i = 0, l = p$.length, p; i < l && (p = p$[i]); i++) {\n        p$[i] = transformer.call(this, p, scope, hostScope);\n      }\n    }\n    return p$.filter((part) => Boolean(part)).join(COMPLEX_SELECTOR_SEP);\n  }\n\n  /**\n   * @param {string} selector\n   * @return {string}\n   */\n  _twiddleNthPlus(selector) {\n    return selector.replace(NTH, (m, type, inside) => {\n      if (inside.indexOf('+') > -1) {\n        inside = inside.replace(/\\+/g, '___');\n      } else if (inside.indexOf('___') > -1) {\n        inside = inside.replace(/___/g, '+');\n      }\n      return `:${type}(${inside})`;\n    });\n  }\n\n  /**\n   * Preserve `:matches()` selectors by replacing them with MATCHES_REPLACMENT\n   * and returning an array of `:matches()` selectors.\n   * Use `_replacesMatchesPseudo` to replace the `:matches()` parts\n   *\n   * @param {string} selector\n   * @return {{selector: string, matches: !Array<string>}}\n   */\n  _preserveMatchesPseudo(selector) {\n    /** @type {!Array<string>} */\n    const matches = [];\n    let match;\n    while ((match = selector.match(MATCHES))) {\n      const start = match.index;\n      const end = StyleUtil.findMatchingParen(selector, start);\n      if (end === -1) {\n        throw new Error(`${match.input} selector missing ')'`);\n      }\n      const part = selector.slice(start, end + 1);\n      selector = selector.replace(part, MATCHES_REPLACEMENT);\n      matches.push(part);\n    }\n    return {selector, matches};\n  }\n\n  /**\n   * Replace MATCHES_REPLACMENT character with the given set of `:matches()`\n   * selectors.\n   *\n   * @param {string} selector\n   * @param {!Array<string>} matches\n   * @return {string}\n   */\n  _replaceMatchesPseudo(selector, matches) {\n    const parts = selector.split(MATCHES_REPLACEMENT);\n    return matches.reduce(\n      (acc, cur, idx) => acc + cur + parts[idx + 1],\n      parts[0]\n    );\n  }\n\n  /**\n   * @param {string} selector\n   * @param {string} scope\n   * @param {string=} hostScope\n   */\n  _transformComplexSelector(selector, scope, hostScope) {\n    let stop = false;\n    selector = selector.trim();\n    // Remove spaces inside of selectors like `:nth-of-type` because it confuses SIMPLE_SELECTOR_SEP\n    let isNth = NTH.test(selector);\n    if (isNth) {\n      selector = selector.replace(\n        NTH,\n        (m, type, inner) => `:${type}(${inner.replace(/\\s/g, '')})`\n      );\n      selector = this._twiddleNthPlus(selector);\n    }\n    // Preserve selectors like `:-webkit-any` so that SIMPLE_SELECTOR_SEP does\n    // not get confused by spaces inside the pseudo selector\n    const isMatches = MATCHES.test(selector);\n    /** @type {!Array<string>} */\n    let matches;\n    if (isMatches) {\n      ({selector, matches} = this._preserveMatchesPseudo(selector));\n    }\n    selector = selector.replace(SLOTTED_START, `${HOST} $1`);\n    selector = selector.replace(SIMPLE_SELECTOR_SEP, (m, c, s) => {\n      if (!stop) {\n        let info = this._transformCompoundSelector(s, c, scope, hostScope);\n        stop = stop || info.stop;\n        c = info.combinator;\n        s = info.value;\n      }\n      return c + s;\n    });\n    // replace `:matches()` selectors\n    if (isMatches) {\n      selector = this._replaceMatchesPseudo(selector, matches);\n    }\n    if (isNth) {\n      selector = this._twiddleNthPlus(selector);\n    }\n    selector = selector.replace(\n      DIR_PAREN,\n      (m, before, dir, after) =>\n        `[dir=\"${dir}\"] ${before}${after}, ${before}[dir=\"${dir}\"]${after}`\n    );\n    return selector;\n  }\n\n  _transformCompoundSelector(selector, combinator, scope, hostScope) {\n    // replace :host with host scoping class\n    let slottedIndex = selector.indexOf(SLOTTED);\n    if (selector.indexOf(HOST) >= 0) {\n      selector = this._transformHostSelector(selector, hostScope);\n      // replace other selectors with scoping class\n    } else if (slottedIndex !== 0) {\n      selector = scope\n        ? this._transformSimpleSelector(selector, scope)\n        : selector;\n    }\n    // mark ::slotted() scope jump to replace with descendant selector + arg\n    // also ignore left-side combinator\n    let slotted = false;\n    if (slottedIndex >= 0) {\n      combinator = '';\n      slotted = true;\n    }\n    // process scope jumping selectors up to the scope jump and then stop\n    let stop;\n    if (slotted) {\n      stop = true;\n      if (slotted) {\n        // .zonk ::slotted(.foo) -> .zonk.scope > .foo\n        selector = selector.replace(SLOTTED_PAREN, (m, paren) => ` > ${paren}`);\n      }\n    }\n    return {value: selector, combinator, stop};\n  }\n\n  _transformSimpleSelector(selector, scope) {\n    const attributes = selector.split(/(\\[.+?\\])/);\n\n    const output = [];\n    for (let i = 0; i < attributes.length; i++) {\n      // Do not attempt to transform any attribute selector content\n      if (i % 2 === 1) {\n        output.push(attributes[i]);\n      } else {\n        const part = attributes[i];\n\n        if (!(part === '' && i === attributes.length - 1)) {\n          let p$ = part.split(PSEUDO_PREFIX);\n          p$[0] += scope;\n          output.push(p$.join(PSEUDO_PREFIX));\n        }\n      }\n    }\n\n    return output.join('');\n  }\n\n  // :host(...) -> scopeName...\n  _transformHostSelector(selector, hostScope) {\n    let m = selector.match(HOST_PAREN);\n    let paren = (m && m[2].trim()) || '';\n    if (paren) {\n      if (!paren[0].match(SIMPLE_SELECTOR_PREFIX)) {\n        // paren starts with a type selector\n        let typeSelector = paren.split(SIMPLE_SELECTOR_PREFIX)[0];\n        // if the type selector is our hostScope then avoid pre-pending it\n        if (typeSelector === hostScope) {\n          return paren;\n        }\n        // otherwise, this selector should not match in this scope so\n        // output a bogus selector.\n        else {\n          return SELECTOR_NO_MATCH;\n        }\n      } else {\n        // make sure to do a replace here to catch selectors like:\n        // `:host(.foo)::before`\n        return selector.replace(HOST_PAREN, function (m, host, paren) {\n          return hostScope + paren;\n        });\n      }\n    }\n    // if no paren, do a straight :host replacement.\n    // TODO(sorvell): this should not strictly be necessary but\n    // it's needed to maintain support for `:host[foo]` type selectors\n    // which have been improperly used under Shady DOM. This should be\n    // deprecated.\n    else {\n      return selector.replace(HOST, hostScope);\n    }\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  documentRule(rule) {\n    // reset selector in case this is redone.\n    rule['selector'] = rule['parsedSelector'];\n    this.normalizeRootSelector(rule);\n    this._transformRule(rule, this._transformDocumentSelector);\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  normalizeRootSelector(rule) {\n    if (rule['selector'] === ROOT) {\n      rule['selector'] = 'html';\n    }\n  }\n\n  /**\n   * @param {string} selector\n   */\n  _transformDocumentSelector(selector) {\n    if (selector.match(HOST)) {\n      // remove ':host' type selectors in document rules\n      return '';\n    } else if (selector.match(SLOTTED)) {\n      return this._transformComplexSelector(selector, SCOPE_DOC_SELECTOR);\n    } else {\n      return this._transformSimpleSelector(selector.trim(), SCOPE_DOC_SELECTOR);\n    }\n  }\n}\n\nconst NTH = /:(nth[-\\w]+)\\(([^)]+)\\)/;\nconst SCOPE_DOC_SELECTOR = `:not(.${SCOPE_NAME})`;\nconst COMPLEX_SELECTOR_SEP = ',';\nconst SIMPLE_SELECTOR_SEP = /(^|[\\s>+~]+)((?:\\[.+?\\]|[^\\s>+~=[])+)/g;\nconst SIMPLE_SELECTOR_PREFIX = /[[.:#*]/;\nconst HOST = ':host';\nconst ROOT = ':root';\nconst SLOTTED = '::slotted';\nconst SLOTTED_START = new RegExp(`^(${SLOTTED})`);\n// NOTE: this supports 1 nested () pair for things like\n// :host(:not([selected]), more general support requires\n// parsing which seems like overkill\nconst HOST_PAREN = /(:host)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\n// similar to HOST_PAREN\nconst SLOTTED_PAREN = /(?:::slotted)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\nconst DIR_PAREN = /(.*):dir\\((?:(ltr|rtl))\\)(.*)/;\nconst CSS_CLASS_PREFIX = '.';\nconst PSEUDO_PREFIX = ':';\nconst CLASS = 'class';\nconst SELECTOR_NO_MATCH = 'should_not_match';\nconst MATCHES = /:(?:matches|any|-(?:webkit|moz)-any)/;\nconst MATCHES_REPLACEMENT = '\\u{e000}';\n\nexport default new StyleTransformer();\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow, nativeCssVariables, cssBuild} from './style-settings.js';\nimport {parse, stringify, types, StyleNode} from './css-parse.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\nimport {MEDIA_MATCH} from './common-regex.js';\n// prettier-ignore\nimport {processUnscopedStyle, isUnscopedStyle} from './unscoped-style-handler.js';\n\n/**\n * @param {string|StyleNode} rules\n * @param {function(StyleNode)=} callback\n * @return {string}\n */\nexport function toCssText(rules, callback) {\n  if (!rules) {\n    return '';\n  }\n  if (typeof rules === 'string') {\n    rules = parse(rules);\n  }\n  if (callback) {\n    forEachRule(rules, callback);\n  }\n  return stringify(rules, nativeCssVariables);\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @return {StyleNode}\n */\nexport function rulesForStyle(style) {\n  if (!style['__cssRules'] && style.textContent) {\n    style['__cssRules'] = parse(style.textContent);\n  }\n  return style['__cssRules'] || null;\n}\n\n// Tests if a rule is a keyframes selector, which looks almost exactly\n// like a normal selector but is not (it has nothing to do with scoping\n// for example).\n/**\n * @param {StyleNode} rule\n * @return {boolean}\n */\nexport function isKeyframesSelector(rule) {\n  return (\n    Boolean(rule['parent']) && rule['parent']['type'] === types.KEYFRAMES_RULE\n  );\n}\n\n/**\n * @param {StyleNode} node\n * @param {Function=} styleRuleCallback\n * @param {Function=} keyframesRuleCallback\n * @param {boolean=} onlyActiveRules\n */\nexport function forEachRule(\n  node,\n  styleRuleCallback,\n  keyframesRuleCallback,\n  onlyActiveRules\n) {\n  if (!node) {\n    return;\n  }\n  let skipRules = false;\n  let type = node['type'];\n  if (onlyActiveRules) {\n    if (type === types.MEDIA_RULE) {\n      let matchMedia = node['selector'].match(MEDIA_MATCH);\n      if (matchMedia) {\n        // if rule is a non matching @media rule, skip subrules\n        if (!window.matchMedia(matchMedia[1]).matches) {\n          skipRules = true;\n        }\n      }\n    }\n  }\n  if (type === types.STYLE_RULE) {\n    styleRuleCallback(node);\n  } else if (keyframesRuleCallback && type === types.KEYFRAMES_RULE) {\n    keyframesRuleCallback(node);\n  } else if (type === types.MIXIN_RULE) {\n    skipRules = true;\n  }\n  let r$ = node['rules'];\n  if (r$ && !skipRules) {\n    for (let i = 0, l = r$.length, r; i < l && (r = r$[i]); i++) {\n      forEachRule(r, styleRuleCallback, keyframesRuleCallback, onlyActiveRules);\n    }\n  }\n}\n\n// add a string of cssText to the document.\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @param {Node} target\n * @param {Node} contextNode\n * @return {HTMLStyleElement}\n */\nexport function applyCss(cssText, moniker, target, contextNode) {\n  let style = createScopeStyle(cssText, moniker);\n  applyStyle(style, target, contextNode);\n  return style;\n}\n\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @return {!HTMLStyleElement}\n */\nexport function createScopeStyle(cssText, moniker) {\n  let style = /** @type {HTMLStyleElement} */ (document.createElement('style'));\n  if (moniker) {\n    style.setAttribute('scope', moniker);\n  }\n  style.textContent = cssText;\n  return style;\n}\n\n/**\n * Track the position of the last added style for placing placeholders\n * @type {Node}\n */\nlet lastHeadApplyNode = null;\n\n// insert a comment node as a styling position placeholder.\n/**\n * @param {string} moniker\n * @return {!Comment}\n */\nexport function applyStylePlaceHolder(moniker) {\n  let placeHolder = document.createComment(\n    ' Shady DOM styles for ' + moniker + ' '\n  );\n  let after = lastHeadApplyNode ? lastHeadApplyNode['nextSibling'] : null;\n  let scope = document.head;\n  scope.insertBefore(placeHolder, after || scope.firstChild);\n  lastHeadApplyNode = placeHolder;\n  return placeHolder;\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @param {?Node} target\n * @param {?Node} contextNode\n */\nexport function applyStyle(style, target, contextNode) {\n  target = target || document.head;\n  let after = (contextNode && contextNode.nextSibling) || target.firstChild;\n  target.insertBefore(style, after);\n  if (!lastHeadApplyNode) {\n    lastHeadApplyNode = style;\n  } else {\n    // only update lastHeadApplyNode if the new style is inserted after the old lastHeadApplyNode\n    let position = style.compareDocumentPosition(lastHeadApplyNode);\n    if (position === Node.DOCUMENT_POSITION_PRECEDING) {\n      lastHeadApplyNode = style;\n    }\n  }\n}\n\n/**\n * @param {string} buildType\n * @return {boolean}\n */\nexport function isTargetedBuild(buildType) {\n  return nativeShadow ? buildType === 'shadow' : buildType === 'shady';\n}\n\n/**\n * Walk from text[start] matching parens and\n * returns position of the outer end paren\n * @param {string} text\n * @param {number} start\n * @return {number}\n */\nexport function findMatchingParen(text, start) {\n  let level = 0;\n  for (let i = start, l = text.length; i < l; i++) {\n    if (text[i] === '(') {\n      level++;\n    } else if (text[i] === ')') {\n      if (--level === 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * @param {string} str\n * @param {function(string, string, string, string)} callback\n */\nexport function processVariableAndFallback(str, callback) {\n  // find 'var('\n  let start = str.indexOf('var(');\n  if (start === -1) {\n    // no var?, everything is prefix\n    return callback(str, '', '', '');\n  }\n  //${prefix}var(${inner})${suffix}\n  let end = findMatchingParen(str, start + 3);\n  let inner = str.substring(start + 4, end);\n  let prefix = str.substring(0, start);\n  // suffix may have other variables\n  let suffix = processVariableAndFallback(str.substring(end + 1), callback);\n  let comma = inner.indexOf(',');\n  // value and fallback args should be trimmed to match in property lookup\n  if (comma === -1) {\n    // variable, no fallback\n    return callback(prefix, inner.trim(), '', suffix);\n  }\n  // var(${value},${fallback})\n  let value = inner.substring(0, comma).trim();\n  let fallback = inner.substring(comma + 1).trim();\n  return callback(prefix, value, fallback, suffix);\n}\n\n/**\n * @param {Element} element\n * @param {string} value\n */\nexport function setElementClassRaw(element, value) {\n  // use native setAttribute provided by ShadyDOM when setAttribute is patched\n  if (nativeShadow) {\n    element.setAttribute('class', value);\n  } else {\n    window['ShadyDOM']['nativeMethods']['setAttribute'].call(\n      element,\n      'class',\n      value\n    );\n  }\n}\n\n/**\n * @type {function(*):*}\n */\nexport const wrap =\n  (window['ShadyDOM'] && window['ShadyDOM']['wrap']) || ((node) => node);\n\n/**\n * @param {Element | {is: string, extends: string}} element\n * @return {{is: string, typeExtension: string}}\n */\nexport function getIsExtends(element) {\n  let localName = element['localName'];\n  let is = '',\n    typeExtension = '';\n  /*\n  NOTE: technically, this can be wrong for certain svg elements\n  with `-` in the name like `<font-face>`\n  */\n  if (localName) {\n    if (localName.indexOf('-') > -1) {\n      is = localName;\n    } else {\n      typeExtension = localName;\n      is = (element.getAttribute && element.getAttribute('is')) || '';\n    }\n  } else {\n    is = /** @type {?} */ (element).is;\n    typeExtension = /** @type {?} */ (element).extends;\n  }\n  return {is, typeExtension};\n}\n\n/**\n * @param {Element|DocumentFragment} element\n * @return {string}\n */\nexport function gatherStyleText(element) {\n  /** @type {!Array<string>} */\n  const styleTextParts = [];\n  const styles = /** @type {!NodeList<!HTMLStyleElement>} */ (element.querySelectorAll(\n    'style'\n  ));\n  for (let i = 0; i < styles.length; i++) {\n    const style = styles[i];\n    if (isUnscopedStyle(style)) {\n      if (!nativeShadow) {\n        processUnscopedStyle(style);\n        style.parentNode.removeChild(style);\n      }\n    } else {\n      styleTextParts.push(style.textContent);\n      style.parentNode.removeChild(style);\n    }\n  }\n  return styleTextParts.join('').trim();\n}\n\n/**\n * Split a selector separated by commas into an array in a smart way\n * @param {string} selector\n * @return {!Array<string>}\n */\nexport function splitSelectorList(selector) {\n  const parts = [];\n  let part = '';\n  for (let i = 0; i >= 0 && i < selector.length; i++) {\n    // A selector with parentheses will be one complete part\n    if (selector[i] === '(') {\n      // find the matching paren\n      const end = findMatchingParen(selector, i);\n      // push the paren block into the part\n      part += selector.slice(i, end + 1);\n      // move the index to after the paren block\n      i = end;\n    } else if (selector[i] === ',') {\n      parts.push(part);\n      part = '';\n    } else {\n      part += selector[i];\n    }\n  }\n  // catch any pieces after the last comma\n  if (part) {\n    parts.push(part);\n  }\n  return parts;\n}\n\nconst CSS_BUILD_ATTR = 'css-build';\n\n/**\n * Return the polymer-css-build \"build type\" applied to this element\n *\n * @param {!HTMLElement} element\n * @return {string} Can be \"\", \"shady\", or \"shadow\"\n */\nexport function getCssBuild(element) {\n  if (cssBuild !== undefined) {\n    return /** @type {string} */ (cssBuild);\n  }\n  if (element.__cssBuild === undefined) {\n    // try attribute first, as it is the common case\n    const attrValue = element.getAttribute(CSS_BUILD_ATTR);\n    if (attrValue) {\n      element.__cssBuild = attrValue;\n    } else {\n      const buildComment = getBuildComment(element);\n      if (buildComment !== '') {\n        // remove build comment so it is not needlessly copied into every element instance\n        removeBuildComment(element);\n      }\n      element.__cssBuild = buildComment;\n    }\n  }\n  return element.__cssBuild || '';\n}\n\n/**\n * Check if the given element, either a <template> or <style>, has been processed\n * by polymer-css-build.\n *\n * If so, then we can make a number of optimizations:\n * - polymer-css-build will decompose mixins into individual CSS Custom Properties,\n * so the ApplyShim can be skipped entirely.\n * - Under native ShadowDOM, the style text can just be copied into each instance\n * without modification\n * - If the build is \"shady\" and ShadyDOM is in use, the styling does not need\n * scoping beyond the shimming of CSS Custom Properties\n *\n * @param {!HTMLElement} element\n * @return {boolean}\n */\nexport function elementHasBuiltCss(element) {\n  return getCssBuild(element) !== '';\n}\n\n/**\n * For templates made with tagged template literals, polymer-css-build will\n * insert a comment of the form `<!--css-build:shadow-->`\n *\n * @param {!HTMLElement} element\n * @return {string}\n */\nexport function getBuildComment(element) {\n  const buildComment =\n    element.localName === 'template'\n      ? /** @type {!HTMLTemplateElement} */ (element).content.firstChild\n      : element.firstChild;\n  if (buildComment instanceof Comment) {\n    const commentParts = buildComment.textContent.trim().split(':');\n    if (commentParts[0] === CSS_BUILD_ATTR) {\n      return commentParts[1];\n    }\n  }\n  return '';\n}\n\n/**\n * Check if the css build status is optimal, and do no unneeded work.\n *\n * @param {string=} cssBuild CSS build status\n * @return {boolean} css build is optimal or not\n */\nexport function isOptimalCssBuild(cssBuild = '') {\n  // CSS custom property shim always requires work\n  if (cssBuild === '' || !nativeCssVariables) {\n    return false;\n  }\n  return nativeShadow ? cssBuild === 'shadow' : cssBuild === 'shady';\n}\n\n/**\n * @param {!HTMLElement} element\n */\nfunction removeBuildComment(element) {\n  const buildComment =\n    element.localName === 'template'\n      ? /** @type {!HTMLTemplateElement} */ (element).content.firstChild\n      : element.firstChild;\n  buildComment.parentNode.removeChild(buildComment);\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/**\n * @const {!Object<string, !HTMLTemplateElement>}\n */\nconst templateMap = {};\nexport default templateMap;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {!Set<string>} */\nconst styleTextSet = new Set();\n\nexport const scopingAttribute = 'shady-unscoped';\n\n/**\n * Add a specifically-marked style to the document directly, and only one copy of that style.\n *\n * @param {!HTMLStyleElement} style\n * @return {undefined}\n */\nexport function processUnscopedStyle(style) {\n  const text = style.textContent;\n  if (!styleTextSet.has(text)) {\n    styleTextSet.add(text);\n    const newStyle = document.createElement('style');\n    newStyle.setAttribute('shady-unscoped', '');\n    newStyle.textContent = text;\n    document.head.appendChild(newStyle);\n  }\n}\n\n/**\n * Check if a style is supposed to be unscoped\n * @param {!HTMLStyleElement} style\n * @return {boolean} true if the style has the unscoping attribute\n */\nexport function isUnscopedStyle(style) {\n  return style.hasAttribute(scopingAttribute);\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport class ShadyData {\n  /** @override */\n  toJSON() {\n    return {};\n  }\n}\n\nexport function ensureShadyDataForNode(node) {\n  if (!node.__shady) {\n    node.__shady = new ShadyData();\n  }\n  return node.__shady;\n}\n\nexport function shadyDataForNode(node) {\n  return node && node.__shady;\n}\n",null,null,null,null,null,"/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport {shadyDataForNode} from './shady-data.js';\n\n/** @type {!Object} */\nexport const settings = window['ShadyDOM'] || {};\n\nsettings.hasNativeShadowDOM = Boolean(\n  Element.prototype.attachShadow && Node.prototype.getRootNode\n);\n\n// The user might need to pass the custom elements polyfill a flag by setting an\n// object to `customElements`, so check for `customElements.define` also.\nexport const hasCustomElements = () =>\n  Boolean(window.customElements && window.customElements.define);\n// The custom elements polyfill is typically loaded after Shady DOM, so this\n// check isn't reliable during initial evaluation. However, because the\n// polyfills are loaded immediately after one another, it works at runtime.\nexport const hasPolyfilledCustomElements = () =>\n  Boolean(\n    window.customElements && window.customElements['polyfillWrapFlushCallback']\n  );\n\nconst desc = Object.getOwnPropertyDescriptor(Node.prototype, 'firstChild');\n\nsettings.hasDescriptors = Boolean(desc && desc.configurable && desc.get);\nsettings.inUse = settings['force'] || !settings.hasNativeShadowDOM;\nsettings.noPatch = /** @type {string|boolean} */ (settings['noPatch'] || false);\n// eslint-disable-next-line no-self-assign\nsettings.preferPerformance = settings['preferPerformance'];\nsettings.patchOnDemand = settings.noPatch === 'on-demand';\nsettings.querySelectorImplementation = (() => {\n  const acceptedValues = ['native', 'selectorEngine'];\n  const userValue = settings['querySelectorImplementation'];\n  if (acceptedValues.indexOf(userValue) > -1) {\n    return userValue;\n  }\n  return undefined;\n})();\n\nconst IS_IE = navigator.userAgent.match('Trident');\nsettings.IS_IE = IS_IE;\n\n// Helper for prefixed properties.\nexport const getPropertyName = (obj, name) => {\n  const prefixed = `ms${name[0].toUpperCase() + name.slice(1)}`;\n  return obj[prefixed] ? prefixed : name;\n};\n\nexport const canUpgrade = () => !settings.IS_IE;\n\nexport const isTrackingLogicalChildNodes = (node) => {\n  const nodeData = shadyDataForNode(node);\n  return nodeData && nodeData.firstChild !== undefined;\n};\n\nexport const isShadyRoot = (obj) => obj instanceof ShadowRoot;\n\nexport const hasShadowRootWithSlot = (node) => {\n  const nodeData = shadyDataForNode(node);\n  let root = nodeData && nodeData.root;\n  return root && root._hasInsertionPoint();\n};\n\nlet p = Element.prototype;\nlet matches =\n  p.matches ||\n  p.matchesSelector ||\n  p.mozMatchesSelector ||\n  p.msMatchesSelector ||\n  p.oMatchesSelector ||\n  p.webkitMatchesSelector;\n\nexport const matchesSelector = (element, selector) => {\n  return matches.call(element, selector);\n};\n\nexport const mixin = (target, source) => {\n  for (var i in source) {\n    target[i] = source[i];\n  }\n  return target;\n};\n\n// NOTE, prefer MutationObserver over Promise for microtask timing\n// for consistency x-platform.\nlet twiddle = document.createTextNode('');\nlet content = 0;\nlet queue = [];\nnew MutationObserver(() => {\n  while (queue.length) {\n    // catch errors in user code...\n    try {\n      queue.shift()();\n    } catch (e) {\n      // enqueue another record and throw\n      twiddle.textContent = content++;\n      throw e;\n    }\n  }\n}).observe(twiddle, {characterData: true});\n\n// use MutationObserver to get microtask async timing.\nexport const microtask = (callback) => {\n  queue.push(callback);\n  twiddle.textContent = content++;\n};\n\n/** @type {function(!Document, !Node): boolean} */\nexport const documentContains = (() => {\n  if (document.contains) {\n    return (doc, node) => doc[NATIVE_PREFIX + 'contains'](node);\n  } else {\n    return (doc, node) =>\n      doc === node ||\n      (doc.documentElement &&\n        doc.documentElement[NATIVE_PREFIX + 'contains'](node));\n  }\n})();\n\nexport const contains = (container, node) => {\n  while (node) {\n    if (node == container) {\n      return true;\n    }\n    node = node[SHADY_PREFIX + 'parentNode'];\n  }\n  return false;\n};\n\nconst getNodeHTMLCollectionName = (node) =>\n  node.getAttribute('id') || node.getAttribute('name');\n\nconst isValidHTMLCollectionName = (name) => name !== 'length' && isNaN(name);\n\nexport const createPolyfilledHTMLCollection = (nodes) => {\n  // Note: loop in reverse so that the first named item matches the named property\n  for (let l = nodes.length - 1; l >= 0; l--) {\n    const node = nodes[l];\n    const name = getNodeHTMLCollectionName(node);\n\n    if (name && isValidHTMLCollectionName(name)) {\n      nodes[name] = node;\n    }\n  }\n  nodes.item = function (index) {\n    return nodes[index];\n  };\n  nodes.namedItem = function (name) {\n    if (isValidHTMLCollectionName(name) && nodes[name]) {\n      return nodes[name];\n    }\n\n    for (const node of nodes) {\n      const nodeName = getNodeHTMLCollectionName(node);\n\n      if (nodeName == name) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n  return nodes;\n};\n\nexport const NATIVE_PREFIX = '__shady_native_';\nexport const SHADY_PREFIX = '__shady_';\n\nexport const nativeChildNodesArray = (parent) => {\n  const result = [];\n  for (\n    let n = parent[NATIVE_PREFIX + 'firstChild'];\n    n;\n    n = n[NATIVE_PREFIX + 'nextSibling']\n  ) {\n    result.push(n);\n  }\n  return result;\n};\n\nexport const childNodesArray = (parent) => {\n  const result = [];\n  for (\n    let n = parent[SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[SHADY_PREFIX + 'nextSibling']\n  ) {\n    result.push(n);\n  }\n  return result;\n};\n\nconst patchProperty = (proto, name, descriptor) => {\n  descriptor.configurable = true;\n  // NOTE: we prefer writing directly because some browsers\n  // have descriptors that are writable but not configurable (e.g.\n  // `appendChild` on older browsers)\n  if (descriptor.value) {\n    proto[name] = descriptor.value;\n  } else {\n    try {\n      Object.defineProperty(proto, name, descriptor);\n    } catch (e) {\n      // this error is harmless so we just trap it.\n    }\n  }\n};\n\n/**\n * Patch a group of accessors on an object. By default this overrides\n * @param {!Object} proto\n * @param {!Object} descriptors\n * @param {string=} prefix\n * @param {Array=} disallowedPatches\n */\nexport const patchProperties = (\n  proto,\n  descriptors,\n  prefix = '',\n  disallowedPatches\n) => {\n  for (let name in descriptors) {\n    if (disallowedPatches && disallowedPatches.indexOf(name) >= 0) {\n      continue;\n    }\n    patchProperty(proto, prefix + name, descriptors[name]);\n  }\n};\n\nexport const patchExistingProperties = (proto, descriptors) => {\n  for (let name in descriptors) {\n    if (name in proto) {\n      patchProperty(proto, name, descriptors[name]);\n    }\n  }\n};\n\n// note, this is not a perfect polyfill since it doesn't include symbols\n/** @return {!Object<!ObjectPropertyDescriptor>} */\nexport const getOwnPropertyDescriptors = (obj) => {\n  const descriptors = {};\n  Object.getOwnPropertyNames(obj).forEach((name) => {\n    descriptors[name] = Object.getOwnPropertyDescriptor(obj, name);\n  });\n  return descriptors;\n};\n\nexport const assign = (target, source) => {\n  const names = Object.getOwnPropertyNames(source);\n  for (let i = 0, p; i < names.length; i++) {\n    p = names[i];\n    target[p] = source[p];\n  }\n};\n\nexport const arrayFrom = (object) => {\n  return [].slice.call(/** @type {IArrayLike} */ (object));\n};\n\n/**\n * Converts a single value to a node for `convertNodesIntoANode`.\n *\n * @param {*} arg\n * @return {!Node}\n */\nconst convertIntoANode = (arg) => {\n  // `\"\" + arg` is used to implicitly coerce the value to a string (coercing a\n  // symbol *should* fail here) before passing to `createTextNode`, which has\n  // argument type `(number|string)`.\n  return !(arg instanceof Node) ? document.createTextNode('' + arg) : arg;\n};\n\n/**\n * Implements 'convert nodes into a node'. The spec text indicates that strings\n * become text nodes, but doesn't describe what should happen if a non-Node,\n * non-string value is found in the arguments list. In practice, browsers coerce\n * these values to strings and convert those to text nodes.\n * https://dom.spec.whatwg.org/#converting-nodes-into-a-node\n *\n * @param {...*} args\n * @return {!Node}\n */\nexport const convertNodesIntoANode = (...args) => {\n  if (args.length === 1) {\n    return convertIntoANode(args[0]);\n  }\n\n  const fragment = document.createDocumentFragment();\n  for (const arg of args) {\n    fragment.appendChild(convertIntoANode(arg));\n  }\n  return fragment;\n};\n\n/**\n * Equivalent to `Array.prototype.flat`. Closure does not compile out this\n * function, so we need an implementation for browsers that don't natively\n * support it.\n *\n * @template T\n * @param {!Array<!T | !Array<!T>>} array\n * @param {number} depth\n * @return {!Array<!T>}\n */\nexport const flat = (array, depth = 1) => {\n  for (; depth > 0; depth--) {\n    array = array.reduce((acc, item) => {\n      if (Array.isArray(item)) {\n        acc.push(...item);\n      } else {\n        acc.push(item);\n      }\n      return acc;\n    }, []);\n  }\n\n  return array;\n};\n\n/**\n * Deduplicates items in an array.\n *\n * This function could normally be implemented as merely `Array.from(new\n * Set(...))`. However, in IE 11, `Set` does not support being constructed with\n * an iterable. Further, some polyfills for `Array.from` effectively default to\n * `Array.prototype.slice.call(...)` when they are unable to find\n * `[Symbol.iterator]`; this is incompatible with `Set` which has no `length` or\n * indexable properties.\n *\n * @template T\n * @param {!Array<!T>} array\n * @return {!Array<!T>}\n */\nexport const deduplicate = (array) => {\n  const results = [];\n  const set = new Set();\n  for (const item of array) {\n    if (!set.has(item)) {\n      results.push(item);\n      set.add(item);\n    }\n  }\n  return results;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from './utils.js';\nimport {patchProperties} from './utils.js';\nimport {getInnerHTML} from './innerHTML.js';\n\nconst hasDescriptors = utils.settings.hasDescriptors;\nexport const NATIVE_PREFIX = utils.NATIVE_PREFIX;\n\n// Object on which raw native methods are stored.\n// e.g. `nativeMethods.querySelector.call(node, selector)`\n// same as `node.querySelector(selector)`\nexport const nativeMethods = {\n  /** @this {Element} */\n  querySelector(selector) {\n    return this[NATIVE_PREFIX + 'querySelector'](selector);\n  },\n  /** @this {Element} */\n  querySelectorAll(selector) {\n    return this[NATIVE_PREFIX + 'querySelectorAll'](selector);\n  },\n};\n// Object on which raw native accessors are available via `accessorName(node)`.\n// e.g. `nativeTree.firstChild(node)`\n// same as `node.firstChild`\nexport const nativeTree = {};\n\nconst installNativeAccessor = (name) => {\n  nativeTree[name] = (node) => node[NATIVE_PREFIX + name];\n};\n\nconst installNativeMethod = (name, fn) => {\n  if (!nativeMethods[name]) {\n    nativeMethods[name] = fn;\n  }\n};\n\nconst defineNativeAccessors = (proto, descriptors) => {\n  patchProperties(proto, descriptors, NATIVE_PREFIX);\n  // make native accessors available to users\n  for (let prop in descriptors) {\n    installNativeAccessor(prop);\n  }\n};\n\nconst copyProperties = (proto, list = []) => {\n  for (let i = 0; i < list.length; i++) {\n    const name = list[i];\n    const descriptor = Object.getOwnPropertyDescriptor(proto, name);\n    if (descriptor) {\n      Object.defineProperty(proto, NATIVE_PREFIX + name, descriptor);\n      // make native methods/accessors available to users\n      if (descriptor.value) {\n        installNativeMethod(name, descriptor.value);\n      } else {\n        installNativeAccessor(name);\n      }\n    }\n  }\n};\n\n/** @type {!TreeWalker} */\nconst nodeWalker = document.createTreeWalker(\n  document,\n  NodeFilter.SHOW_ALL,\n  null,\n  false\n);\n\n/** @type {!TreeWalker} */\nconst elementWalker = document.createTreeWalker(\n  document,\n  NodeFilter.SHOW_ELEMENT,\n  null,\n  false\n);\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nconst clearNode = (node) => {\n  let firstChild;\n  while ((firstChild = node[NATIVE_PREFIX + 'firstChild'])) {\n    node[NATIVE_PREFIX + 'removeChild'](firstChild);\n  }\n};\n\nconst ParentNodeAccessors = [\n  'firstElementChild',\n  'lastElementChild',\n  'children',\n  'childElementCount',\n];\n\nconst ParentNodeMethods = [\n  'querySelector',\n  'querySelectorAll',\n  'append',\n  'prepend',\n  'replaceChildren',\n];\n\nexport const addNativePrefixedProperties = () => {\n  // EventTarget\n  const eventProps = [\n    'dispatchEvent',\n    'addEventListener',\n    'removeEventListener',\n  ];\n  if (window.EventTarget) {\n    copyProperties(window.EventTarget.prototype, eventProps);\n\n    // In Firefox 31, `EventTarget` exists, but `EventTarget.prototype` is not\n    // in the prototype chain of `window` and, strangely,\n    // `window instanceof EventTarget` still returns true.\n    if (window[NATIVE_PREFIX + 'addEventListener'] === undefined) {\n      copyProperties(Window.prototype, eventProps);\n    }\n  } else {\n    copyProperties(Node.prototype, eventProps);\n    copyProperties(Window.prototype, eventProps);\n    copyProperties(XMLHttpRequest.prototype, eventProps);\n  }\n\n  // Node\n  if (hasDescriptors) {\n    copyProperties(Node.prototype, [\n      'parentNode',\n      'firstChild',\n      'lastChild',\n      'previousSibling',\n      'nextSibling',\n      'childNodes',\n      'parentElement',\n      'textContent',\n    ]);\n  } else {\n    defineNativeAccessors(Node.prototype, {\n      parentNode: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.parentNode();\n        },\n      },\n      firstChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.firstChild();\n        },\n      },\n      lastChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.lastChild();\n        },\n      },\n      previousSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.previousSibling();\n        },\n      },\n      nextSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.nextSibling();\n        },\n      },\n      // TODO(sorvell): make this a NodeList or whatever\n      childNodes: {\n        /** @this {Node} */\n        get() {\n          const nodes = [];\n          nodeWalker.currentNode = this;\n          let n = nodeWalker.firstChild();\n          while (n) {\n            nodes.push(n);\n            n = nodeWalker.nextSibling();\n          }\n          return nodes;\n        },\n      },\n      parentElement: {\n        /** @this {Node} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.parentNode();\n        },\n      },\n      textContent: {\n        /** @this {Node} */\n        get() {\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              // TODO(sorvell): This cannot be a single TreeWalker that's reused\n              // at least for Safari 9, but it's unclear why.\n              // eslint-disable-next-line no-case-declarations\n              const textWalker = document.createTreeWalker(\n                this,\n                NodeFilter.SHOW_TEXT,\n                null,\n                false\n              );\n              // eslint-disable-next-line no-case-declarations\n              let content = '',\n                n;\n              while ((n = textWalker.nextNode())) {\n                // TODO(sorvell): can't use textContent since we patch it on Node.prototype!\n                // However, should probably patch it only on element.\n                content += n.nodeValue;\n              }\n              return content;\n            default:\n              return this.nodeValue;\n          }\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Node} */\n        set(value) {\n          if (typeof value === 'undefined' || value === null) {\n            value = '';\n          }\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              clearNode(this);\n              // Document fragments must have no childnodes if setting a blank string\n              if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n                // Note: old Chrome versions require 2nd argument here\n                this[NATIVE_PREFIX + 'insertBefore'](\n                  document.createTextNode(value),\n                  undefined\n                );\n              }\n              break;\n            default:\n              // TODO(sorvell): can't do this if patch nodeValue.\n              this.nodeValue = value;\n              break;\n          }\n        },\n      },\n    });\n  }\n\n  copyProperties(Node.prototype, [\n    'appendChild',\n    'insertBefore',\n    'removeChild',\n    'replaceChild',\n    'cloneNode',\n    'contains',\n  ]);\n\n  // NOTE, on some browsers IE 11 / Edge 15 some properties are incorrectly on HTMLElement\n  copyProperties(HTMLElement.prototype, ['parentElement', 'contains']);\n\n  const ParentNodeWalkerDescriptors = {\n    firstElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.firstChild();\n      },\n    },\n    lastElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.lastChild();\n      },\n    },\n    children: {\n      /** @this {ParentNode} */\n      get() {\n        let nodes = [];\n        elementWalker.currentNode = this;\n        let n = elementWalker.firstChild();\n        while (n) {\n          nodes.push(n);\n          n = elementWalker.nextSibling();\n        }\n        return utils.createPolyfilledHTMLCollection(nodes);\n      },\n    },\n    childElementCount: {\n      /** @this {ParentNode} */\n      get() {\n        if (this.children) {\n          return this.children.length;\n        }\n        return 0;\n      },\n    },\n  };\n\n  // Element\n  if (hasDescriptors) {\n    copyProperties(Element.prototype, ParentNodeAccessors);\n\n    copyProperties(Element.prototype, [\n      'previousElementSibling',\n      'nextElementSibling',\n      'innerHTML',\n      'className',\n    ]);\n\n    // NOTE, on some browsers IE 11 / Edge 15 some properties are incorrectly on HTMLElement\n    copyProperties(HTMLElement.prototype, [\n      'children',\n      'innerHTML',\n      'className',\n    ]);\n  } else {\n    defineNativeAccessors(Element.prototype, ParentNodeWalkerDescriptors);\n    defineNativeAccessors(Element.prototype, {\n      previousElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.previousSibling();\n        },\n      },\n      nextElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.nextSibling();\n        },\n      },\n      innerHTML: {\n        /** @this {Element} */\n        get() {\n          return getInnerHTML(this, utils.nativeChildNodesArray);\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Element} */\n        set(value) {\n          const content =\n            this.localName === 'template'\n              ? /** @type {HTMLTemplateElement} */ (this).content\n              : this;\n          clearNode(content);\n          const containerName = this.localName || 'div';\n          let htmlContainer;\n          if (\n            !this.namespaceURI ||\n            this.namespaceURI === inertDoc.namespaceURI\n          ) {\n            htmlContainer = inertDoc.createElement(containerName);\n          } else {\n            htmlContainer = inertDoc.createElementNS(\n              this.namespaceURI,\n              containerName\n            );\n          }\n          htmlContainer.innerHTML = value;\n          const newContent =\n            this.localName === 'template'\n              ? /** @type {HTMLTemplateElement} */ (htmlContainer).content\n              : htmlContainer;\n          let firstChild;\n          while ((firstChild = newContent[NATIVE_PREFIX + 'firstChild'])) {\n            // Note: old Chrome versions require 2nd argument here\n            content[NATIVE_PREFIX + 'insertBefore'](firstChild, undefined);\n          }\n        },\n      },\n      className: {\n        /** @this {Element} */\n        get() {\n          return this.getAttribute('class') || '';\n        },\n        /** @this {Element} */\n        set(value) {\n          this.setAttribute('class', value);\n        },\n      },\n    });\n  }\n\n  copyProperties(Element.prototype, [\n    'setAttribute',\n    'getAttribute',\n    'hasAttribute',\n    'removeAttribute',\n    'toggleAttribute',\n    // on older Safari, these are on Element.\n    'focus',\n    'blur',\n  ]);\n  copyProperties(Element.prototype, ParentNodeMethods);\n\n  // HTMLElement\n  copyProperties(HTMLElement.prototype, ['focus', 'blur']);\n\n  // HTMLTemplateElement\n  if (window.HTMLTemplateElement) {\n    copyProperties(window.HTMLTemplateElement.prototype, ['innerHTML']);\n  }\n\n  // DocumentFragment\n  if (hasDescriptors) {\n    // NOTE, IE 11 does not have on DocumentFragment\n    // firstElementChild\n    // lastElementChild\n    copyProperties(DocumentFragment.prototype, ParentNodeAccessors);\n  } else {\n    defineNativeAccessors(\n      DocumentFragment.prototype,\n      ParentNodeWalkerDescriptors\n    );\n  }\n\n  copyProperties(DocumentFragment.prototype, ParentNodeMethods);\n\n  // Document\n  if (hasDescriptors) {\n    copyProperties(Document.prototype, ParentNodeAccessors);\n    copyProperties(Document.prototype, ['activeElement']);\n  } else {\n    defineNativeAccessors(Document.prototype, ParentNodeWalkerDescriptors);\n  }\n\n  copyProperties(Document.prototype, [\n    'importNode',\n    'getElementById',\n    'elementFromPoint',\n    utils.getPropertyName(Document.prototype, 'elementsFromPoint'),\n  ]);\n  copyProperties(Document.prototype, ParentNodeMethods);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\n// render enqueuer/flusher\nlet flushList = [];\nlet scheduled;\nexport function enqueue(callback) {\n  if (!scheduled) {\n    scheduled = true;\n    utils.microtask(flush);\n  }\n  flushList.push(callback);\n}\n\nexport function flush() {\n  scheduled = false;\n  let didFlush = Boolean(flushList.length);\n  while (flushList.length) {\n    flushList.shift()();\n  }\n  return didFlush;\n}\n\nflush['list'] = flushList;\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nclass AsyncObserver {\n  constructor() {\n    this._scheduled = false;\n    this.addedNodes = [];\n    this.removedNodes = [];\n    this.callbacks = new Set();\n  }\n\n  schedule() {\n    if (!this._scheduled) {\n      this._scheduled = true;\n      utils.microtask(() => {\n        this.flush();\n      });\n    }\n  }\n\n  flush() {\n    if (this._scheduled) {\n      this._scheduled = false;\n      let mutations = this.takeRecords();\n      if (mutations.length) {\n        this.callbacks.forEach(function (cb) {\n          cb(mutations);\n        });\n      }\n    }\n  }\n\n  takeRecords() {\n    if (this.addedNodes.length || this.removedNodes.length) {\n      let mutations = [\n        {\n          addedNodes: this.addedNodes,\n          removedNodes: this.removedNodes,\n        },\n      ];\n      this.addedNodes = [];\n      this.removedNodes = [];\n      return mutations;\n    }\n    return [];\n  }\n}\n\n// TODO(sorvell): consider instead polyfilling MutationObserver\n// directly so that users do not have to fork their code.\n// Supporting the entire api may be challenging: e.g. filtering out\n// removed nodes in the wrong scope and seeing non-distributing\n// subtree child mutations.\nexport let observeChildren = function (node, callback) {\n  const sd = ensureShadyDataForNode(node);\n  if (!sd.observer) {\n    sd.observer = new AsyncObserver();\n  }\n  sd.observer.callbacks.add(callback);\n  let observer = sd.observer;\n  return {\n    _callback: callback,\n    _observer: observer,\n    _node: node,\n    takeRecords() {\n      return observer.takeRecords();\n    },\n  };\n};\n\nexport let unobserveChildren = function (handle) {\n  let observer = handle && handle._observer;\n  if (observer) {\n    observer.callbacks.delete(handle._callback);\n    if (!observer.callbacks.size) {\n      ensureShadyDataForNode(handle._node).observer = null;\n    }\n  }\n};\n\nexport function filterMutations(mutations, target) {\n  /** @const {Node} */\n  const targetRootNode = target.getRootNode();\n  return mutations\n    .map(function (mutation) {\n      /** @const {boolean} */\n      const mutationInScope = targetRootNode === mutation.target.getRootNode();\n      if (mutationInScope && mutation.addedNodes) {\n        let nodes = utils.arrayFrom(mutation.addedNodes).filter(function (n) {\n          return targetRootNode === n.getRootNode();\n        });\n        if (nodes.length) {\n          mutation = Object.create(mutation);\n          Object.defineProperty(mutation, 'addedNodes', {\n            value: nodes,\n            configurable: true,\n          });\n          return mutation;\n        }\n      } else if (mutationInScope) {\n        return mutation;\n      }\n    })\n    .filter(function (m) {\n      return m;\n    });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Cribbed from ShadowDOM polyfill\n// https://github.com/webcomponents/webcomponentsjs/blob/master/src/ShadowDOM/wrappers/HTMLElement.js#L28\n/////////////////////////////////////////////////////////////////////////////\n// innerHTML and outerHTML\n\n// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#escapingString\nlet escapeAttrRegExp = /[&\\u00A0\"]/g;\nlet escapeDataRegExp = /[&\\u00A0<>]/g;\n\nfunction escapeReplace(c) {\n  switch (c) {\n    case '&':\n      return '&amp;';\n    case '<':\n      return '&lt;';\n    case '>':\n      return '&gt;';\n    case '\"':\n      return '&quot;';\n    case '\\u00A0':\n      return '&nbsp;';\n  }\n}\n\nfunction escapeAttr(s) {\n  return s.replace(escapeAttrRegExp, escapeReplace);\n}\n\nfunction escapeData(s) {\n  return s.replace(escapeDataRegExp, escapeReplace);\n}\n\nfunction makeSet(arr) {\n  let set = {};\n  for (let i = 0; i < arr.length; i++) {\n    set[arr[i]] = true;\n  }\n  return set;\n}\n\n// http://www.whatwg.org/specs/web-apps/current-work/#void-elements\nlet voidElements = makeSet([\n  'area',\n  'base',\n  'br',\n  'col',\n  'command',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr',\n]);\n\nlet plaintextParents = makeSet([\n  'style',\n  'script',\n  'xmp',\n  'iframe',\n  'noembed',\n  'noframes',\n  'plaintext',\n  'noscript',\n]);\n\n/**\n * @param {Node} node\n * @param {Node} parentNode\n * @param {Function=} callback\n */\nexport function getOuterHTML(node, parentNode, callback) {\n  switch (node.nodeType) {\n    case Node.ELEMENT_NODE: {\n      let tagName = node.localName;\n      let s = '<' + tagName;\n      let attrs = node.attributes;\n      for (let i = 0, attr; (attr = attrs[i]); i++) {\n        s += ' ' + attr.name + '=\"' + escapeAttr(attr.value) + '\"';\n      }\n      s += '>';\n      if (voidElements[tagName]) {\n        return s;\n      }\n      return s + getInnerHTML(node, callback) + '</' + tagName + '>';\n    }\n    case Node.TEXT_NODE: {\n      let data = /** @type {Text} */ (node).data;\n      if (parentNode && plaintextParents[parentNode.localName]) {\n        return data;\n      }\n      return escapeData(data);\n    }\n    case Node.COMMENT_NODE: {\n      return '<!--' + /** @type {Comment} */ (node).data + '-->';\n    }\n    default: {\n      window.console.error(node);\n      throw new Error('not implemented');\n    }\n  }\n}\n\n/**\n * @param {Node} node\n * @param {Function=} callback\n */\nexport function getInnerHTML(node, callback) {\n  if (node.localName === 'template') {\n    node = /** @type {HTMLTemplateElement} */ (node).content;\n  }\n  let s = '';\n  let c$ = callback ? callback(node) : node.childNodes;\n  for (let i = 0, l = c$.length, child; i < l && (child = c$[i]); i++) {\n    s += getOuterHTML(child, node, callback);\n  }\n  return s;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nexport const InsideDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get childNodes() {\n    return this[utils.SHADY_PREFIX + 'childNodes'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    return this[utils.SHADY_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    return this[utils.SHADY_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get childElementCount() {\n    return this[utils.SHADY_PREFIX + 'childElementCount'];\n  },\n\n  /** @this {Node} */\n  get children() {\n    return this[utils.SHADY_PREFIX + 'children'];\n  },\n\n  /** @this {Node} */\n  get firstElementChild() {\n    return this[utils.SHADY_PREFIX + 'firstElementChild'];\n  },\n\n  /** @this {Node} */\n  get lastElementChild() {\n    return this[utils.SHADY_PREFIX + 'lastElementChild'];\n  },\n\n  /** @this {Node} */\n  get shadowRoot() {\n    return this[utils.SHADY_PREFIX + 'shadowRoot'];\n  },\n});\n\nexport const TextContentInnerHTMLDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get textContent() {\n    return this[utils.SHADY_PREFIX + 'textContent'];\n  },\n\n  /** @this {Node} */\n  set textContent(value) {\n    this[utils.SHADY_PREFIX + 'textContent'] = value;\n  },\n\n  /** @this {Node} */\n  get innerHTML() {\n    return this[utils.SHADY_PREFIX + 'innerHTML'];\n  },\n\n  /** @this {Node} */\n  set innerHTML(value) {\n    this[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  },\n});\n\nexport const OutsideDescriptors = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get parentElement() {\n    return this[utils.SHADY_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get parentNode() {\n    return this[utils.SHADY_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    return this[utils.SHADY_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    return this[utils.SHADY_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get nextElementSibling() {\n    return this[utils.SHADY_PREFIX + 'nextElementSibling'];\n  },\n\n  /** @this {Node} */\n  get previousElementSibling() {\n    return this[utils.SHADY_PREFIX + 'previousElementSibling'];\n  },\n\n  /** @this {Node} */\n  get className() {\n    return this[utils.SHADY_PREFIX + 'className'];\n  },\n\n  /** @this {Node} */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'className'] = value;\n  },\n});\n\nconst makeNonEnumerable = (descriptors) => {\n  for (let prop in descriptors) {\n    const descriptor = descriptors[prop];\n    // NOTE, the only known reason the descriptor wouldn't exist here is\n    // if someone has patched `Object.getOwnPropertyNames`, but we've seen this\n    // so this is just to be extra safe.\n    if (descriptor) {\n      descriptor.enumerable = false;\n    }\n  }\n};\n\nmakeNonEnumerable(InsideDescriptors);\nmakeNonEnumerable(TextContentInnerHTMLDescriptors);\nmakeNonEnumerable(OutsideDescriptors);\n\nconst noInstancePatching =\n  utils.settings.hasDescriptors || utils.settings.noPatch === true;\n\n// ensure an element has patched \"outside\" accessors; no-op when not needed\nexport let patchOutsideElementAccessors = noInstancePatching\n  ? function () {}\n  : function (element) {\n      const sd = ensureShadyDataForNode(element);\n      if (!sd.__outsideAccessors) {\n        sd.__outsideAccessors = true;\n        utils.patchExistingProperties(element, OutsideDescriptors);\n      }\n    };\n\n// ensure an element has patched \"inside\" accessors; no-op when not needed\nexport let patchInsideElementAccessors = noInstancePatching\n  ? function () {}\n  : function (element) {\n      const sd = ensureShadyDataForNode(element);\n      if (!sd.__insideAccessors) {\n        sd.__insideAccessors = true;\n        utils.patchExistingProperties(element, InsideDescriptors);\n        // NOTE: There are compatibility issues with patches for `textContent`\n        // and `innerHTML` between CE and SD. Since SD patches are applied\n        // via `ShadyDOM.patch` and CE patches are applied as the tree is walked,\n        // SD patches overwrite CE patches.\n        // * When SD is in patching mode, SD calls through to native\n        // methods not patched by CE (since SD is at the bottom) and CE does not\n        // upgrade, connect, or disconnect elements. Therefore do *not patch*\n        // these accessors in this case.\n        // * When SD is in `noPatch` mode, the SD patches call through to\n        // \"native\" methods that are patched by CE (since CE is at the bottom).\n        // Therefore continue to patch in this case.\n        // If the custom elements polyfill is not loaded, then these accessors\n        // should be patched so they work correctly.\n        if (!utils.hasPolyfilledCustomElements() || utils.settings.noPatch) {\n          utils.patchExistingProperties(\n            element,\n            TextContentInnerHTMLDescriptors\n          );\n        }\n      }\n    };\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {flush} from './flush.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\n\n/*\nMake this name unique so it is unlikely to conflict with properties on objects passed to `addEventListener`\nhttps://github.com/webcomponents/shadydom/issues/173\n*/\nconst /** string */ eventWrappersName = `__eventWrappers${Date.now()}`;\n\n/** @type {?function(!Event): boolean} */\nconst composedGetter = (() => {\n  const composedProp = Object.getOwnPropertyDescriptor(\n    Event.prototype,\n    'composed'\n  );\n  return composedProp ? (ev) => composedProp.get.call(ev) : null;\n})();\n\nconst supportsEventOptions = (() => {\n  let supported = false;\n  let eventOptions = {\n    get capture() {\n      supported = true;\n      return false;\n    },\n  };\n  const listener = () => {};\n  // NOTE: These will be unpatched at this point.\n  window.addEventListener('test', listener, eventOptions);\n  window.removeEventListener('test', listener, eventOptions);\n  return supported;\n})();\n\nconst parseEventOptions = (optionsOrCapture) => {\n  let capture, once, shadyTarget;\n  if (\n    optionsOrCapture !== null &&\n    (typeof optionsOrCapture === 'object' ||\n      typeof optionsOrCapture === 'function')\n  ) {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    shadyTarget = optionsOrCapture.__shadyTarget;\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n  }\n  return {\n    shadyTarget,\n    capture,\n    once,\n    nativeEventOptions: supportsEventOptions ? optionsOrCapture : capture,\n  };\n};\n\n// https://github.com/w3c/webcomponents/issues/513#issuecomment-224183937\nconst alwaysComposed = {\n  'blur': true,\n  'focus': true,\n  'focusin': true,\n  'focusout': true,\n  'click': true,\n  'dblclick': true,\n  'mousedown': true,\n  'mouseenter': true,\n  'mouseleave': true,\n  'mousemove': true,\n  'mouseout': true,\n  'mouseover': true,\n  'mouseup': true,\n  'wheel': true,\n  'beforeinput': true,\n  'input': true,\n  'keydown': true,\n  'keyup': true,\n  'compositionstart': true,\n  'compositionupdate': true,\n  'compositionend': true,\n  'touchstart': true,\n  'touchend': true,\n  'touchmove': true,\n  'touchcancel': true,\n  'pointerover': true,\n  'pointerenter': true,\n  'pointerdown': true,\n  'pointermove': true,\n  'pointerup': true,\n  'pointercancel': true,\n  'pointerout': true,\n  'pointerleave': true,\n  'gotpointercapture': true,\n  'lostpointercapture': true,\n  'dragstart': true,\n  'drag': true,\n  'dragenter': true,\n  'dragleave': true,\n  'dragover': true,\n  'drop': true,\n  'dragend': true,\n  'DOMActivate': true,\n  'DOMFocusIn': true,\n  'DOMFocusOut': true,\n  'keypress': true,\n};\n\nconst unpatchedEvents = {\n  'DOMAttrModified': true,\n  'DOMAttributeNameChanged': true,\n  'DOMCharacterDataModified': true,\n  'DOMElementNameChanged': true,\n  'DOMNodeInserted': true,\n  'DOMNodeInsertedIntoDocument': true,\n  'DOMNodeRemoved': true,\n  'DOMNodeRemovedFromDocument': true,\n  'DOMSubtreeModified': true,\n};\n\n/**\n * Some EventTarget subclasses are not Node subclasses, and you cannot call\n * `getRootNode()` on them.\n *\n * @param {!(Node|EventTarget)} eventTarget\n * @return {!(Node|EventTarget)}\n */\nfunction getRootNodeWithFallback(eventTarget) {\n  if (eventTarget instanceof Node) {\n    return eventTarget[utils.SHADY_PREFIX + 'getRootNode']();\n  } else {\n    return eventTarget;\n  }\n}\n\nfunction pathComposer(startNode, composed) {\n  let composedPath = [];\n  let current = startNode;\n  let startRoot = getRootNodeWithFallback(startNode);\n  while (current) {\n    composedPath.push(current);\n    if (current[utils.SHADY_PREFIX + 'assignedSlot']) {\n      current = current[utils.SHADY_PREFIX + 'assignedSlot'];\n    } else if (\n      current.nodeType === Node.DOCUMENT_FRAGMENT_NODE &&\n      current.host &&\n      (composed || current !== startRoot)\n    ) {\n      current = current.host;\n    } else {\n      current = current[utils.SHADY_PREFIX + 'parentNode'];\n    }\n  }\n  // event composedPath includes window when startNode's ownerRoot is document\n  if (composedPath[composedPath.length - 1] === document) {\n    composedPath.push(window);\n  }\n  return composedPath;\n}\n\nexport const composedPath = (event) => {\n  if (!event.__composedPath) {\n    event.__composedPath = pathComposer(event.target, true);\n  }\n  return event.__composedPath;\n};\n\nfunction retarget(refNode, path) {\n  if (!utils.isShadyRoot) {\n    return refNode;\n  }\n  // If ANCESTOR's root is not a shadow root or ANCESTOR's root is BASE's\n  // shadow-including inclusive ancestor, return ANCESTOR.\n  let refNodePath = pathComposer(refNode, true);\n  let p$ = path;\n  for (let i = 0, ancestor, lastRoot, root, rootIdx; i < p$.length; i++) {\n    ancestor = p$[i];\n    root = getRootNodeWithFallback(ancestor);\n    if (root !== lastRoot) {\n      rootIdx = refNodePath.indexOf(root);\n      lastRoot = root;\n    }\n    if (!utils.isShadyRoot(root) || rootIdx > -1) {\n      return ancestor;\n    }\n  }\n}\n\nlet EventPatches = {\n  /**\n   * @this {Event}\n   */\n  get composed() {\n    if (this.__composed === undefined) {\n      // if there's an original `composed` getter on the Event prototype, use that\n      if (composedGetter) {\n        // TODO(web-padawan): see https://github.com/webcomponents/shadydom/issues/275\n        this.__composed =\n          this.type === 'focusin' ||\n          this.type === 'focusout' ||\n          composedGetter(this);\n        // If the event is trusted, or `isTrusted` is not supported, check the list of always composed events\n      } else if (this.isTrusted !== false) {\n        this.__composed = alwaysComposed[this.type];\n      }\n    }\n    return /** @type {!Event} */ (this).__composed || false;\n  },\n\n  /**\n   * @this {Event}\n   */\n  composedPath() {\n    if (!this.__composedPath) {\n      this.__composedPath = pathComposer(this['__target'], this.composed);\n    }\n    return /** @type {!Event} */ (this).__composedPath;\n  },\n\n  /**\n   * @this {Event}\n   */\n  get target() {\n    return retarget(\n      this.currentTarget || this['__previousCurrentTarget'],\n      this.composedPath()\n    );\n  },\n\n  // http://w3c.github.io/webcomponents/spec/shadow/#event-relatedtarget-retargeting\n  /**\n   * @this {Event}\n   */\n  get relatedTarget() {\n    if (!this.__relatedTarget) {\n      return null;\n    }\n    if (!this.__relatedTargetComposedPath) {\n      this.__relatedTargetComposedPath = pathComposer(\n        this.__relatedTarget,\n        true\n      );\n    }\n    // find the deepest node in relatedTarget composed path that is in the same root with the currentTarget\n    return retarget(\n      this.currentTarget || this['__previousCurrentTarget'],\n      /** @type {!Event} */ (this).__relatedTargetComposedPath\n    );\n  },\n  /**\n   * @this {Event}\n   */\n  stopPropagation() {\n    Event.prototype.stopPropagation.call(this);\n    this.__propagationStopped = true;\n  },\n  /**\n   * @this {Event}\n   */\n  stopImmediatePropagation() {\n    Event.prototype.stopImmediatePropagation.call(this);\n    this.__immediatePropagationStopped = true;\n    this.__propagationStopped = true;\n  },\n};\n\n// Some browsers have missing or broken descriptors. If this is the case\n// eventPhase can't be polyfilled. For example, Chrome 41 does not\n// have prototypical descriptors on DOM objects and Safari 9 has broken ones\n// that cannot be used.\nconst eventPhaseDescriptor =\n  utils.settings.hasDescriptors &&\n  Object.getOwnPropertyDescriptor(Event.prototype, 'eventPhase');\nif (eventPhaseDescriptor) {\n  Object.defineProperty(\n    EventPatches,\n    'eventPhase',\n    /** @type {!ObjectPropertyDescriptor<!Event>} */ ({\n      /**\n       * @this {Event}\n       */\n      get() {\n        return this.currentTarget === this.target\n          ? Event.AT_TARGET\n          : this[utils.NATIVE_PREFIX + 'eventPhase'];\n      },\n      enumerable: true,\n      configurable: true,\n    })\n  );\n\n  Object.defineProperty(\n    EventPatches,\n    utils.NATIVE_PREFIX + 'eventPhase',\n    eventPhaseDescriptor\n  );\n}\n\nfunction mixinComposedFlag(Base) {\n  // NOTE: avoiding use of `class` here so that transpiled output does not\n  // try to do `Base.call` with a dom construtor.\n  let klazz = function (type, options) {\n    let event = new Base(type, options);\n    event.__composed = options && Boolean(options['composed']);\n    return event;\n  };\n  // put constructor properties on subclass\n  klazz.__proto__ = Base;\n  klazz.prototype = Base.prototype;\n  return klazz;\n}\n\nlet nonBubblingEventsToRetarget = {\n  'focus': true,\n  'blur': true,\n};\n\n/**\n * Check if the event has been retargeted by comparing original `target`, and calculated `target`\n * @param {Event} event\n * @return {boolean} True if the original target and calculated target are the same\n */\nfunction hasRetargeted(event) {\n  return (\n    event['__target'] !== event.target ||\n    event.__relatedTarget !== event.relatedTarget\n  );\n}\n\n/**\n *\n * @param {Event} event\n * @param {Node} node\n * @param {string} phase\n */\nfunction fireHandlers(event, node, phase) {\n  let hs =\n    node.__handlers &&\n    node.__handlers[event.type] &&\n    node.__handlers[event.type][phase];\n  if (hs) {\n    for (let i = 0, fn; (fn = hs[i]); i++) {\n      if (hasRetargeted(event) && event.target === event.relatedTarget) {\n        return;\n      }\n      fn.call(node, event);\n      if (event.__immediatePropagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\n// In Chrome 41, `currentTarget` is an own property of every `Event` and its\n// descriptor is a _data_ descriptor and not an accessor descriptor (so there is\n// no getter that could be saved and wrapped) but the browser effectively treats\n// this property as if it had a getter and returns different values on getting\n// as necessary. Further, setting a new descriptor for `currentTarget`, as\n// `shadyDispatchEvent` does below, permanently breaks this special descriptor\n// behavior. In this case, `shadyDispatchEvent` creates a new object with the\n// original event as its prototype (via `Object.create`) and modifies that\n// object's `currentTarget` instead, to avoid breaking the descriptor on the\n// original event.\n//\n// In Chrome 104 and Safari 9, some getters on events do not allow `this` to be\n// anything other than exactly the original event object. This means that the\n// above process of using a proxy-like (not a `Proxy`) object for the event\n// fails because any user that attempts to use properties of the original event\n// will be using the proxy as `this`.\n//\n// Fortunately, these two issues seem to be mutually exclusive amongst the\n// browsers that we test on, so we can specifically check if `currentTarget`\n// exists on a new `Event` and switch based off of that.\n// `utils.settings.hasDescriptors` is not sufficient for deciding this behavior\n// because, in Safari 9, `currentTarget` is not an own property of events, but\n// `.hasDescriptors` is still false.\nconst shadyDispatchEventNeedsProxyEvent = new Event('e').hasOwnProperty(\n  'currentTarget'\n);\n\nfunction shadyDispatchEvent(originalEvent) {\n  const e = shadyDispatchEventNeedsProxyEvent\n    ? Object.create(originalEvent)\n    : originalEvent;\n  const path = e.composedPath();\n  const retargetedPath = path.map((node) => retarget(node, path));\n  const bubbles = e.bubbles;\n\n  let currentTarget;\n  // override `currentTarget` to let patched `target` calculate correctly\n  const prevCurrentTargetDesc = Object.getOwnPropertyDescriptor(\n    e,\n    'currentTarget'\n  );\n  Object.defineProperty(e, 'currentTarget', {\n    configurable: true,\n    enumerable: true,\n    get: function () {\n      return currentTarget;\n    },\n  });\n\n  let eventPhase = Event.CAPTURING_PHASE;\n  const prevEventPhaseDesc = Object.getOwnPropertyDescriptor(e, 'eventPhase');\n  Object.defineProperty(e, 'eventPhase', {\n    configurable: true,\n    enumerable: true,\n    get: function () {\n      return eventPhase;\n    },\n  });\n\n  try {\n    for (let i = path.length - 1; i >= 0; i--) {\n      currentTarget = path[i];\n      eventPhase =\n        currentTarget === retargetedPath[i]\n          ? Event.AT_TARGET\n          : Event.CAPTURING_PHASE;\n      // capture phase fires all capture handlers\n      fireHandlers(e, currentTarget, 'capture');\n      if (e.__propagationStopped) {\n        return;\n      }\n    }\n\n    for (let i = 0; i < path.length; i++) {\n      currentTarget = path[i];\n      const atTarget = currentTarget === retargetedPath[i];\n      if (atTarget || bubbles) {\n        eventPhase = atTarget ? Event.AT_TARGET : Event.BUBBLING_PHASE;\n        fireHandlers(e, currentTarget, 'bubble');\n        if (e.__propagationStopped) {\n          return;\n        }\n      }\n    }\n  } finally {\n    if (!shadyDispatchEventNeedsProxyEvent) {\n      // Restore previous currentTarget & eventPhase descriptors when\n      // dispatching is complete\n      if (prevCurrentTargetDesc) {\n        Object.defineProperty(e, 'currentTarget', prevCurrentTargetDesc);\n      } else {\n        delete e['currentTarget'];\n      }\n      if (prevEventPhaseDesc) {\n        Object.defineProperty(e, 'eventPhase', prevEventPhaseDesc);\n      } else {\n        delete e['eventPhase'];\n      }\n    }\n  }\n}\n\nfunction listenerSettingsEqual(savedListener, node, type, capture) {\n  let {node: savedNode, type: savedType, capture: savedCapture} = savedListener;\n  return node === savedNode && type === savedType && capture === savedCapture;\n}\n\nexport function findListener(wrappers, node, type, capture) {\n  for (let i = 0; i < wrappers.length; i++) {\n    if (listenerSettingsEqual(wrappers[i], node, type, capture)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Firefox can throw on accessing eventWrappers inside of `removeEventListener` during a selenium run\n * Try/Catch accessing eventWrappers to work around\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1353074\n */\nfunction getEventWrappers(eventLike) {\n  let wrappers = null;\n  try {\n    wrappers = eventLike[eventWrappersName];\n  } catch (e) {} // eslint-disable-line no-empty\n  return wrappers;\n}\n\nfunction targetNeedsPathCheck(node) {\n  return utils.isShadyRoot(node) || node.localName === 'slot';\n}\n\n/** @this {Node} */\nexport function dispatchEvent(event) {\n  flush();\n  // If the target is disconnected from the real document, it might still be\n  // connected in the user-facing tree. To allow its path to potentially\n  // include both connected and disconnected parts, dispatch it manually.\n  if (\n    !utils.settings.preferPerformance &&\n    this instanceof Node &&\n    !utils.documentContains(document, this)\n  ) {\n    if (!event['__target']) {\n      patchEvent(event, this);\n    }\n    return shadyDispatchEvent(event);\n  } else {\n    return this[utils.NATIVE_PREFIX + 'dispatchEvent'](event);\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function addEventListener(type, fnOrObj, optionsOrCapture) {\n  const {capture, once, shadyTarget, nativeEventOptions} = parseEventOptions(\n    optionsOrCapture\n  );\n  if (!fnOrObj) {\n    return;\n  }\n\n  const handlerType = typeof fnOrObj;\n\n  // bail if `fnOrObj` is not a function, not an object\n  if (handlerType !== 'function' && handlerType !== 'object') {\n    return;\n  }\n\n  // bail if `fnOrObj` is an object without a `handleEvent` method\n  if (\n    handlerType === 'object' &&\n    (!fnOrObj.handleEvent || typeof fnOrObj.handleEvent !== 'function')\n  ) {\n    return;\n  }\n\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'addEventListener'](\n      type,\n      fnOrObj,\n      nativeEventOptions\n    );\n  }\n\n  // hack to let ShadyRoots have event listeners\n  // event listener will be on host, but `currentTarget`\n  // will be set to shadyroot for event listener\n  let target = shadyTarget || this;\n\n  let wrappers = fnOrObj[eventWrappersName];\n  if (wrappers) {\n    // The callback `fn` might be used for multiple nodes/events. Since we generate\n    // a wrapper function, we need to keep track of it when we remove the listener.\n    // It's more efficient to store the node/type/options information as Array in\n    // `fn` itself rather than the node (we assume that the same callback is used\n    // for few nodes at most, whereas a node will likely have many event listeners).\n    // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n    // Stop if the wrapper function has already been created.\n    if (findListener(wrappers, target, type, capture) > -1) {\n      return;\n    }\n  } else {\n    fnOrObj[eventWrappersName] = [];\n  }\n\n  /**\n   * @this {EventTarget}\n   * @param {Event} e\n   */\n  const wrapperFn = (e) => {\n    // Support `once` option.\n    if (once) {\n      this[utils.SHADY_PREFIX + 'removeEventListener'](\n        type,\n        fnOrObj,\n        optionsOrCapture\n      );\n    }\n    if (!e['__target']) {\n      patchEvent(e);\n    }\n    let lastCurrentTargetDesc;\n    let lastEventPhaseDesc;\n    if (target !== this) {\n      // replace `currentTarget` to make `target` and `relatedTarget` correct for inside the shadowroot\n      lastCurrentTargetDesc = Object.getOwnPropertyDescriptor(\n        e,\n        'currentTarget'\n      );\n      Object.defineProperty(e, 'currentTarget', {\n        get() {\n          return target;\n        },\n        configurable: true,\n      });\n      lastEventPhaseDesc = Object.getOwnPropertyDescriptor(e, 'eventPhase');\n      Object.defineProperty(e, 'eventPhase', {\n        configurable: true,\n        enumerable: true,\n        get() {\n          // Shady DOM doesn't support dispatching to a shadow root as the\n          // target, so we don't need to handle Event.AT_TARGET.\n          return capture ? Event.CAPTURING_PHASE : Event.BUBBLING_PHASE;\n        },\n      });\n    }\n    e['__previousCurrentTarget'] = e['currentTarget'];\n    // Always check if a shadowRoot or slot is in the current event path.\n    // If it is not, the event was generated on either the host of the shadowRoot\n    // or a children of the host.\n    if (\n      targetNeedsPathCheck(target) &&\n      e.composedPath().indexOf(target) == -1\n    ) {\n      return;\n    }\n    // There are two critera that should stop events from firing on this node\n    // 1. the event is not composed and the current node is not in the same root as the target\n    // 2. when bubbling, if after retargeting, relatedTarget and target point to the same node\n    if (e.composed || e.composedPath().indexOf(target) > -1) {\n      if (hasRetargeted(e) && e.target === e.relatedTarget) {\n        if (e.eventPhase === Event.BUBBLING_PHASE) {\n          e.stopImmediatePropagation();\n        }\n        return;\n      }\n      // prevent non-bubbling events from triggering bubbling handlers on shadowroot, but only if not in capture phase\n      if (\n        e.eventPhase !== Event.CAPTURING_PHASE &&\n        !e.bubbles &&\n        e.target !== target &&\n        !(target instanceof Window)\n      ) {\n        return;\n      }\n      let ret =\n        handlerType === 'function'\n          ? fnOrObj.call(target, e)\n          : fnOrObj.handleEvent && fnOrObj.handleEvent(e);\n      if (target !== this) {\n        // Replace the original descriptors for `currentTarget` and `eventPhase`.\n        if (lastCurrentTargetDesc) {\n          Object.defineProperty(e, 'currentTarget', lastCurrentTargetDesc);\n          lastCurrentTargetDesc = null;\n        } else {\n          delete e['currentTarget'];\n        }\n        if (lastEventPhaseDesc) {\n          Object.defineProperty(e, 'eventPhase', lastEventPhaseDesc);\n          lastEventPhaseDesc = null;\n        } else {\n          delete e['eventPhase'];\n        }\n      }\n      return ret;\n    }\n  };\n\n  // Store the wrapper information.\n  fnOrObj[eventWrappersName].push({\n    // note: use target here which is either a shadowRoot\n    // (when the host element is proxy'ing the event) or this element\n    node: target,\n    type,\n    capture,\n    wrapperFn,\n  });\n\n  this.__handlers = this.__handlers || {};\n  this.__handlers[type] = this.__handlers[type] || {\n    'capture': [],\n    'bubble': [],\n  };\n  this.__handlers[type][capture ? 'capture' : 'bubble'].push(wrapperFn);\n\n  if (!nonBubblingEventsToRetarget[type]) {\n    this[utils.NATIVE_PREFIX + 'addEventListener'](\n      type,\n      wrapperFn,\n      nativeEventOptions\n    );\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function removeEventListener(type, fnOrObj, optionsOrCapture) {\n  if (!fnOrObj) {\n    return;\n  }\n  const {capture, shadyTarget, nativeEventOptions} = parseEventOptions(\n    optionsOrCapture\n  );\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'removeEventListener'](\n      type,\n      fnOrObj,\n      nativeEventOptions\n    );\n  }\n  let target = shadyTarget || this;\n  // Search the wrapped function.\n  let wrapperFn = undefined;\n  let wrappers = getEventWrappers(fnOrObj);\n  if (wrappers) {\n    let idx = findListener(wrappers, target, type, capture);\n    if (idx > -1) {\n      wrapperFn = wrappers.splice(idx, 1)[0].wrapperFn;\n      // Cleanup.\n      if (!wrappers.length) {\n        fnOrObj[eventWrappersName] = undefined;\n      }\n    }\n  }\n  this[utils.NATIVE_PREFIX + 'removeEventListener'](\n    type,\n    wrapperFn || fnOrObj,\n    nativeEventOptions\n  );\n  if (wrapperFn && this.__handlers && this.__handlers[type]) {\n    const arr = this.__handlers[type][capture ? 'capture' : 'bubble'];\n    const idx = arr.indexOf(wrapperFn);\n    if (idx > -1) {\n      arr.splice(idx, 1);\n    }\n  }\n}\n\nfunction activateFocusEventOverrides() {\n  for (let ev in nonBubblingEventsToRetarget) {\n    window[utils.NATIVE_PREFIX + 'addEventListener'](\n      ev,\n      function (e) {\n        if (!e['__target']) {\n          patchEvent(e);\n          shadyDispatchEvent(e);\n        }\n      },\n      true\n    );\n  }\n}\n\nconst EventPatchesDescriptors = utils.getOwnPropertyDescriptors(EventPatches);\n\nconst SHADY_PROTO = '__shady_patchedProto';\nconst SHADY_SOURCE_PROTO = '__shady_sourceProto';\n\nfunction patchEvent(event, target = event.target) {\n  event['__target'] = target;\n  event.__relatedTarget = event.relatedTarget;\n  // attempt to patch prototype (via cache)\n  if (utils.settings.hasDescriptors) {\n    const proto = Object.getPrototypeOf(event);\n    // eslint-disable-next-line no-prototype-builtins\n    if (!proto.hasOwnProperty(SHADY_PROTO)) {\n      const patchedProto = Object.create(proto);\n      patchedProto[SHADY_SOURCE_PROTO] = proto;\n      utils.patchProperties(patchedProto, EventPatchesDescriptors);\n      proto[SHADY_PROTO] = patchedProto;\n    }\n    event.__proto__ = proto[SHADY_PROTO];\n    // and fallback to patching instance\n  } else {\n    utils.patchProperties(event, EventPatchesDescriptors);\n  }\n}\n\nlet PatchedEvent = mixinComposedFlag(Event);\nlet PatchedCustomEvent = mixinComposedFlag(CustomEvent);\nlet PatchedMouseEvent = mixinComposedFlag(MouseEvent);\n\nexport function patchEvents() {\n  activateFocusEventOverrides();\n  window.Event = PatchedEvent;\n  window.CustomEvent = PatchedCustomEvent;\n  window.MouseEvent = PatchedMouseEvent;\n}\n\nexport function patchClick() {\n  // Fix up `Element.prototype.click()` if `isTrusted` is supported, but `composed` isn't\n  if (\n    !composedGetter &&\n    Object.getOwnPropertyDescriptor(Event.prototype, 'isTrusted')\n  ) {\n    /** @this {Element} */\n    const composedClickFn = function () {\n      const ev = new MouseEvent('click', {\n        bubbles: true,\n        cancelable: true,\n        composed: true,\n      });\n      this[utils.SHADY_PREFIX + 'dispatchEvent'](ev);\n    };\n    if (Element.prototype.click) {\n      Element.prototype.click = composedClickFn;\n    } else if (HTMLElement.prototype.click) {\n      HTMLElement.prototype.click = composedClickFn;\n    }\n  }\n}\n\nexport const eventPropertyNamesForElement = Object.getOwnPropertyNames(\n  Element.prototype\n).filter((name) => name.substring(0, 2) === 'on');\n\nexport const eventPropertyNamesForHTMLElement = Object.getOwnPropertyNames(\n  HTMLElement.prototype\n).filter((name) => name.substring(0, 2) === 'on');\n\n/**\n * @param {string} property\n * @return {!ObjectPropertyDescriptor<Element>}\n */\nexport const wrappedDescriptorForEventProperty = (property) => {\n  return {\n    /** @this {Element} */\n    set: function (fn) {\n      const shadyData = ensureShadyDataForNode(this);\n      const eventName = property.substring(2);\n      if (!shadyData.__onCallbackListeners) {\n        shadyData.__onCallbackListeners = {};\n      }\n      shadyData.__onCallbackListeners[property] &&\n        this.removeEventListener(\n          eventName,\n          shadyData.__onCallbackListeners[property]\n        );\n      this[utils.SHADY_PREFIX + 'addEventListener'](eventName, fn);\n      shadyData.__onCallbackListeners[property] = fn;\n    },\n    /** @this {Element} */\n    get() {\n      const shadyData = shadyDataForNode(this);\n      return (\n        shadyData &&\n        shadyData.__onCallbackListeners &&\n        shadyData.__onCallbackListeners[property]\n      );\n    },\n    configurable: true,\n  };\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount,\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\n// Note: This function is *based* on the computation of the Levenshtein\n// \"edit\" distance. The one change is that \"updates\" are treated as two\n// edits - not one. With Array splices, an update is really a delete\n// followed by an add. By retaining this, we optimize for \"keeping\" the\n// maximum array items in the original array. For example:\n//\n//   'xxxx123' -> '123yyyy'\n//\n// With 1-edit updates, the shortest path would be just to update all seven\n// characters. With 2-edit updates, we delete 4, leave 3, and add 4. This\n// leaves the substring '123' intact.\nfunction calcEditDistances(\n  current,\n  currentStart,\n  currentEnd,\n  old,\n  oldStart,\n  oldEnd\n) {\n  // \"Deletion\" columns\n  let rowCount = oldEnd - oldStart + 1;\n  let columnCount = currentEnd - currentStart + 1;\n  let distances = new Array(rowCount);\n\n  // \"Addition\" rows. Initialize null column.\n  for (let i = 0; i < rowCount; i++) {\n    distances[i] = new Array(columnCount);\n    distances[i][0] = i;\n  }\n\n  // Initialize null row\n  for (let j = 0; j < columnCount; j++) {\n    distances[0][j] = j;\n  }\n\n  for (let i = 1; i < rowCount; i++) {\n    for (let j = 1; j < columnCount; j++) {\n      if (equals(current[currentStart + j - 1], old[oldStart + i - 1])) {\n        distances[i][j] = distances[i - 1][j - 1];\n      } else {\n        let north = distances[i - 1][j] + 1;\n        let west = distances[i][j - 1] + 1;\n        distances[i][j] = north < west ? north : west;\n      }\n    }\n  }\n\n  return distances;\n}\n\n// This starts at the final weight, and walks \"backward\" by finding\n// the minimum previous weight recursively until the origin of the weight\n// matrix.\nfunction spliceOperationsFromEditDistances(distances) {\n  let i = distances.length - 1;\n  let j = distances[0].length - 1;\n  let current = distances[i][j];\n  let edits = [];\n  while (i > 0 || j > 0) {\n    if (i == 0) {\n      edits.push(EDIT_ADD);\n      j--;\n      continue;\n    }\n    if (j == 0) {\n      edits.push(EDIT_DELETE);\n      i--;\n      continue;\n    }\n    let northWest = distances[i - 1][j - 1];\n    let west = distances[i - 1][j];\n    let north = distances[i][j - 1];\n\n    let min;\n    if (west < north) {\n      min = west < northWest ? west : northWest;\n    } else {\n      min = north < northWest ? north : northWest;\n    }\n\n    if (min == northWest) {\n      if (northWest == current) {\n        edits.push(EDIT_LEAVE);\n      } else {\n        edits.push(EDIT_UPDATE);\n        current = northWest;\n      }\n      i--;\n      j--;\n    } else if (min == west) {\n      edits.push(EDIT_DELETE);\n      i--;\n      current = west;\n    } else {\n      edits.push(EDIT_ADD);\n      j--;\n      current = north;\n    }\n  }\n\n  edits.reverse();\n  return edits;\n}\n\n/**\n * Splice Projection functions:\n *\n * A splice map is a representation of how a previous array of items\n * was transformed into a new array of items. Conceptually it is a list of\n * tuples of\n *\n *   <index, removed, addedCount>\n *\n * which are kept in ascending index order of. The tuple represents that at\n * the |index|, |removed| sequence of items were removed, and counting forward\n * from |index|, |addedCount| items were added.\n */\n\n/**\n * Lacking individual splice mutation information, the minimal set of\n * splices can be synthesized given the previous state and final state of an\n * array. The basic approach is to calculate the edit distance matrix and\n * choose the shortest path through it.\n *\n * Complexity: O(l * p)\n *   l: The length of the current array\n *   p: The length of the old array\n */\nfunction calcSplices(current, currentStart, currentEnd, old, oldStart, oldEnd) {\n  let prefixCount = 0;\n  let suffixCount = 0;\n  let splice;\n\n  let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n  if (currentStart == 0 && oldStart == 0) {\n    prefixCount = sharedPrefix(current, old, minLength);\n  }\n\n  if (currentEnd == current.length && oldEnd == old.length) {\n    suffixCount = sharedSuffix(current, old, minLength - prefixCount);\n  }\n\n  currentStart += prefixCount;\n  oldStart += prefixCount;\n  currentEnd -= suffixCount;\n  oldEnd -= suffixCount;\n\n  if (currentEnd - currentStart == 0 && oldEnd - oldStart == 0) {\n    return [];\n  }\n\n  if (currentStart == currentEnd) {\n    splice = newSplice(currentStart, [], 0);\n    while (oldStart < oldEnd) {\n      splice.removed.push(old[oldStart++]);\n    }\n\n    return [splice];\n  } else if (oldStart == oldEnd) {\n    return [newSplice(currentStart, [], currentEnd - currentStart)];\n  }\n\n  let ops = spliceOperationsFromEditDistances(\n    calcEditDistances(current, currentStart, currentEnd, old, oldStart, oldEnd)\n  );\n\n  splice = undefined;\n  let splices = [];\n  let index = currentStart;\n  let oldIndex = oldStart;\n  for (let i = 0; i < ops.length; i++) {\n    switch (ops[i]) {\n      case EDIT_LEAVE:\n        if (splice) {\n          splices.push(splice);\n          splice = undefined;\n        }\n\n        index++;\n        oldIndex++;\n        break;\n      case EDIT_UPDATE:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.addedCount++;\n        index++;\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n      case EDIT_ADD:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.addedCount++;\n        index++;\n        break;\n      case EDIT_DELETE:\n        if (!splice) {\n          splice = newSplice(index, [], 0);\n        }\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n    }\n  }\n\n  if (splice) {\n    splices.push(splice);\n  }\n  return splices;\n}\n\nfunction sharedPrefix(current, old, searchLength) {\n  for (let i = 0; i < searchLength; i++) {\n    if (!equals(current[i], old[i])) {\n      return i;\n    }\n  }\n  return searchLength;\n}\n\nfunction sharedSuffix(current, old, searchLength) {\n  let index1 = current.length;\n  let index2 = old.length;\n  let count = 0;\n  while (count < searchLength && equals(current[--index1], old[--index2])) {\n    count++;\n  }\n\n  return count;\n}\n\nfunction equals(currentValue, previousValue) {\n  return currentValue === previousValue;\n}\n\nexport function calculateSplices(current, previous) {\n  return calcSplices(current, 0, current.length, previous, 0, previous.length);\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {addEventListener, removeEventListener, dispatchEvent} from '../patch-events.js';\n\nexport const EventTargetPatches = utils.getOwnPropertyDescriptors({\n  dispatchEvent,\n\n  addEventListener,\n\n  removeEventListener,\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\nlet scopingShim = null;\n\nexport function getScopingShim() {\n  if (!scopingShim) {\n    scopingShim = window['ShadyCSS'] && window['ShadyCSS']['ScopingShim'];\n  }\n  return scopingShim || null;\n}\n\n/**\n * @param {!Node} node\n * @param {string} attr\n * @param {string} value\n */\nexport function scopeClassAttribute(node, attr, value) {\n  const scopingShim = getScopingShim();\n  if (scopingShim && attr === 'class') {\n    scopingShim['setElementClass'](node, value);\n    return true;\n  }\n  return false;\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n */\nexport function addShadyScoping(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['scopeNode'](node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} currentScopeName\n */\nexport function removeShadyScoping(node, currentScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['unscopeNode'](node, currentScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @param {string} oldScopeName\n */\nexport function replaceShadyScoping(node, newScopeName, oldScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  if (oldScopeName) {\n    removeShadyScoping(node, oldScopeName);\n  }\n  addShadyScoping(node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @return {boolean}\n */\nexport function currentScopeIsCorrect(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return true;\n  }\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // NOTE: as an optimization, only check that all the top-level children\n    // have the correct scope.\n    let correctScope = true;\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      correctScope = correctScope && currentScopeIsCorrect(n, newScopeName);\n    }\n    return correctScope;\n  }\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return true;\n  }\n  const currentScope = scopingShim['currentScopeForNode'](node);\n  return currentScope === newScopeName;\n}\n\n/**\n * @param {!Node} node\n * @return {string}\n */\nexport function currentScopeForNode(node) {\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return '';\n  }\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return '';\n  }\n  return scopingShim['currentScopeForNode'](node);\n}\n\n/**\n * Walk over a node's tree and apply visitorFn to each element node\n *\n * @param {Node} node\n * @param {function(!Node):void} visitorFn\n */\nexport function treeVisitor(node, visitorFn) {\n  if (!node) {\n    return;\n  }\n  // this check is necessary if `node` is a Document Fragment\n  if (node.nodeType === Node.ELEMENT_NODE) {\n    visitorFn(node);\n  }\n  for (\n    let n = node[utils.SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[utils.SHADY_PREFIX + 'nextSibling']\n  ) {\n    if (n.nodeType === Node.ELEMENT_NODE) {\n      treeVisitor(n, visitorFn);\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {getScopingShim, removeShadyScoping, replaceShadyScoping, treeVisitor, currentScopeForNode, currentScopeIsCorrect} from '../style-scoping.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from '../shady-data.js';\nimport {recordInsertBefore, recordRemoveChild} from '../link-nodes.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nconst doc = window.document;\n\nconst preferPerformance = utils.settings.preferPerformance;\n\nconst nativeIsConnectedAccessors = /** @type {ObjectPropertyDescriptor} */ (Object.getOwnPropertyDescriptor(\n  Node.prototype,\n  'isConnected'\n));\n\nconst nativeIsConnected =\n  nativeIsConnectedAccessors && nativeIsConnectedAccessors.get;\n\nexport function clearNode(node) {\n  let firstChild;\n  while ((firstChild = node[utils.SHADY_PREFIX + 'firstChild'])) {\n    node[utils.SHADY_PREFIX + 'removeChild'](firstChild);\n  }\n}\n\nfunction removeOwnerShadyRoot(node) {\n  // optimization: only reset the tree if node is actually in a root\n  if (hasCachedOwnerRoot(node)) {\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      removeOwnerShadyRoot(n);\n    }\n  }\n  const nodeData = shadyDataForNode(node);\n  if (nodeData) {\n    nodeData.ownerShadyRoot = undefined;\n  }\n}\n\nfunction hasCachedOwnerRoot(node) {\n  const nodeData = shadyDataForNode(node);\n  return Boolean(nodeData && nodeData.ownerShadyRoot !== undefined);\n}\n\n/**\n * Finds the first flattened node that is composed in the node's parent.\n * If the given node is a slot, then the first flattened node is returned\n * if it exists, otherwise advance to the node's nextSibling.\n * @param {Node} node within which to find first composed node\n * @returns {Node} first composed node\n */\nfunction firstComposedNode(node) {\n  let composed = node;\n  if (node && node.localName === 'slot') {\n    const nodeData = shadyDataForNode(node);\n    const flattened = nodeData && nodeData.flattenedNodes;\n    // Note, if `flattened` is falsey, it means that the containing shadowRoot\n    // has not rendered and therefore the `<slot>` is still in the composed\n    // DOM. If that's the case the `<slot>` is the first composed node.\n    if (flattened) {\n      composed = flattened.length\n        ? flattened[0]\n        : firstComposedNode(node[utils.SHADY_PREFIX + 'nextSibling']);\n    }\n  }\n  return composed;\n}\n\n/**\n * @param {Node} node\n * @param {Node=} addedNode\n * @param {Node=} removedNode\n */\nfunction scheduleObserver(node, addedNode, removedNode) {\n  const nodeData = shadyDataForNode(node);\n  const observer = nodeData && nodeData.observer;\n  if (observer) {\n    if (addedNode) {\n      if (addedNode.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n        for (let i = 0, l = addedNode.childNodes.length; i < l; i++) {\n          observer.addedNodes.push(addedNode.childNodes[i]);\n        }\n      } else {\n        observer.addedNodes.push(addedNode);\n      }\n    }\n    if (removedNode) {\n      observer.removedNodes.push(removedNode);\n    }\n    observer.schedule();\n  }\n}\n\nexport const NodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get parentNode() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.parentNode;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.firstChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.lastChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.nextSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.previousSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get childNodes() {\n    let childNodes;\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const nodeData = shadyDataForNode(this);\n      if (!nodeData.childNodes) {\n        nodeData.childNodes = [];\n        for (\n          let n = this[utils.SHADY_PREFIX + 'firstChild'];\n          n;\n          n = n[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          nodeData.childNodes.push(n);\n        }\n      }\n      childNodes = nodeData.childNodes;\n    } else {\n      childNodes = this[utils.NATIVE_PREFIX + 'childNodes'];\n    }\n    childNodes.item = function (index) {\n      return childNodes[index];\n    };\n    return childNodes;\n  },\n\n  /** @this {Node} */\n  get parentElement() {\n    const nodeData = shadyDataForNode(this);\n    let l = nodeData && nodeData.parentNode;\n    if (l && l.nodeType !== Node.ELEMENT_NODE) {\n      l = null;\n    }\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get isConnected() {\n    if (nativeIsConnected && nativeIsConnected.call(this)) {\n      return true;\n    }\n    if (this.nodeType == Node.DOCUMENT_FRAGMENT_NODE) {\n      return false;\n    }\n    // Fast path for distributed nodes.\n    const ownerDocument = this.ownerDocument;\n    if (ownerDocument === null || utils.documentContains(ownerDocument, this)) {\n      return true;\n    }\n    // Slow path for non-distributed nodes.\n    let node = this;\n    while (node && !(node instanceof Document)) {\n      node =\n        node[utils.SHADY_PREFIX + 'parentNode'] ||\n        (utils.isShadyRoot(node)\n          ? /** @type {ShadowRoot} */ (node).host\n          : undefined);\n    }\n    return !!(node && node instanceof Document);\n  },\n\n  /** @this {Node} */\n  get textContent() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      let tc = [];\n      for (\n        let n = this[utils.SHADY_PREFIX + 'firstChild'];\n        n;\n        n = n[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        if (n.nodeType !== Node.COMMENT_NODE) {\n          tc.push(n[utils.SHADY_PREFIX + 'textContent']);\n        }\n      }\n      return tc.join('');\n    } else {\n      return this[utils.NATIVE_PREFIX + 'textContent'];\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {string} value\n   */\n  set textContent(value) {\n    if (typeof value === 'undefined' || value === null) {\n      value = '';\n    }\n    switch (this.nodeType) {\n      case Node.ELEMENT_NODE:\n      case Node.DOCUMENT_FRAGMENT_NODE:\n        if (\n          !utils.isTrackingLogicalChildNodes(this) &&\n          utils.settings.hasDescriptors\n        ) {\n          // may be removing a nested slot but fast path if we know we are not.\n          const firstChild = this[utils.SHADY_PREFIX + 'firstChild'];\n          if (\n            firstChild != this[utils.SHADY_PREFIX + 'lastChild'] ||\n            (firstChild && firstChild.nodeType != Node.TEXT_NODE)\n          ) {\n            clearNode(this);\n          }\n          this[utils.NATIVE_PREFIX + 'textContent'] = value;\n        } else {\n          clearNode(this);\n          // Document fragments must have no childNodes if setting a blank string\n          if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n            this[utils.SHADY_PREFIX + 'insertBefore'](\n              document.createTextNode(value)\n            );\n          }\n        }\n        break;\n      default:\n        // Note, be wary of patching `nodeValue`.\n        this.nodeValue = value;\n        break;\n    }\n  },\n\n  // Patched `insertBefore`. Note that all mutations that add nodes are routed\n  // here. When a <slot> is added or a node is added to a host with a shadowRoot\n  // with a slot, a standard dom `insert` call is aborted and `_asyncRender`\n  // is called on the relevant shadowRoot. In all other cases, a standard dom\n  // `insert` can be made, but the location and ref_node may need to be changed.\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  insertBefore(node, ref_node) {\n    // optimization: assume native insertBefore is ok if the nodes are not in the document.\n    if (this.ownerDocument !== doc && node.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      return node;\n    }\n    if (node === this) {\n      throw Error(\n        `Failed to execute 'appendChild' on 'Node': The new child element contains the parent.`\n      );\n    }\n    if (ref_node) {\n      const refData = shadyDataForNode(ref_node);\n      const p = refData && refData.parentNode;\n      if (\n        (p !== undefined && p !== this) ||\n        (p === undefined &&\n          ref_node[utils.NATIVE_PREFIX + 'parentNode'] !== this)\n      ) {\n        throw Error(\n          `Failed to execute 'insertBefore' on 'Node': The node ` +\n            `before which the new node is to be inserted is not a child of this node.`\n        );\n      }\n    }\n    if (ref_node === node) {\n      return node;\n    }\n    scheduleObserver(this, node);\n    /** @type {!Array<!HTMLSlotElement>} */\n    const slotsAdded = [];\n    const ownerRoot = ownerShadyRootForNode(this);\n    /** @type {string} */\n    const newScopeName = ownerRoot\n      ? ownerRoot.host.localName\n      : currentScopeForNode(this);\n    /** @type {string} */\n    let oldScopeName;\n    // remove from existing location\n    const parentNode = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode) {\n      oldScopeName = currentScopeForNode(node);\n      const skipUnscoping =\n        // Don't remove scoping if we're inserting into another shadowRoot;\n        // this would be unnecessary since it will be re-scoped below\n        Boolean(ownerRoot) ||\n        // Don't remove scoping if we're being moved between non-shadowRoot\n        // locations (the likely case is when moving pre-scoped nodes in a template)\n        !ownerShadyRootForNode(node) ||\n        // Under preferPerformance, don't remove scoping when moving back into\n        // a document fragment that was previously scoped; the assumption is\n        // that the user should only move correctly-scoped DOM back into it\n        (preferPerformance && this['__noInsertionPoint'] !== undefined);\n      parentNode[utils.SHADY_PREFIX + 'removeChild'](node, skipUnscoping);\n    }\n    // add to new parent\n    let allowNativeInsert = true;\n    const needsScoping =\n      (!preferPerformance ||\n        // Under preferPerformance, only re-scope if we're not coming from a\n        // pre-scoped doc fragment or back into a pre-scoped doc fragment\n        (node['__noInsertionPoint'] === undefined &&\n          this['__noInsertionPoint'] === undefined)) &&\n      !currentScopeIsCorrect(node, newScopeName);\n    const needsSlotFinding =\n      ownerRoot &&\n      !node['__noInsertionPoint'] &&\n      (!preferPerformance || node.nodeType === Node.DOCUMENT_FRAGMENT_NODE);\n    if (needsSlotFinding || needsScoping) {\n      // NOTE: avoid node.removeChild as this *can* trigger another patched\n      // method (e.g. custom elements) and we want only the shady method to run.\n      // The following table describes what style scoping actions should happen as a result of this insertion.\n      // document -> shadowRoot: replace\n      // shadowRoot -> shadowRoot: replace\n      // shadowRoot -> shadowRoot of same type: do nothing\n      // shadowRoot -> document: allow unscoping\n      // document -> document: do nothing\n      // The \"same type of shadowRoot\" and \"document to document cases rely on `currentScopeIsCorrect` returning true\n      if (needsScoping) {\n        // in a document or disconnected tree, replace scoping if necessary\n        oldScopeName = oldScopeName || currentScopeForNode(node);\n      }\n      treeVisitor(node, (node) => {\n        if (needsSlotFinding && node.localName === 'slot') {\n          slotsAdded.push(/** @type {!HTMLSlotElement} */ (node));\n        }\n        if (needsScoping) {\n          replaceShadyScoping(node, newScopeName, oldScopeName);\n        }\n      });\n    }\n    // if a slot is added, must render containing root.\n    if (slotsAdded.length) {\n      ownerRoot._addSlots(slotsAdded);\n      ownerRoot._asyncRender();\n    }\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordInsertBefore(node, this, ref_node);\n      const parentData = shadyDataForNode(this);\n      // if the node being inserted into has a shadowRoot, do not perform\n      // a native insertion\n      if (parentData.root) {\n        allowNativeInsert = false;\n        // when inserting into a host with a shadowRoot with slot, use\n        // `shadowRoot._asyncRender()` via `attach-shadow` module\n        // when inserting into a host with shadowRoot with NO slot, do nothing\n        // as the node should not be added to composed DOM anywhere.\n        if (utils.hasShadowRootWithSlot(this)) {\n          parentData.root._asyncRender();\n        }\n      }\n      // when inserting into a slot inside a shadowRoot, render the\n      // containing shadowRoot to update fallback content.\n      else if (ownerRoot && this.localName === 'slot') {\n        allowNativeInsert = false;\n        ownerRoot._asyncRender();\n      }\n    }\n    if (allowNativeInsert) {\n      // if adding to a shadyRoot, add to host instead\n      let container = utils.isShadyRoot(this)\n        ? /** @type {ShadowRoot} */ (this).host\n        : this;\n      // if ref_node, get the ref_node that's actually in composed dom.\n      if (ref_node) {\n        ref_node = firstComposedNode(ref_node);\n        container[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      } else {\n        container[utils.NATIVE_PREFIX + 'appendChild'](node);\n      }\n    }\n    // Since ownerDocument is not patched, it can be incorrect after this call\n    // if the node is physically appended via distribution. This can result\n    // in the custom elements polyfill not upgrading the node if it's in an inert doc.\n    // We correct this by calling `adoptNode`.\n    else if (node.ownerDocument !== this.ownerDocument) {\n      this.ownerDocument.adoptNode(node);\n    }\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   */\n  appendChild(node) {\n    // if this is a shadowRoot and the shadowRoot is passed as `node`\n    // then an optimized append has already been performed, so do nothing.\n    if (!(this == node && utils.isShadyRoot(node))) {\n      return this[utils.SHADY_PREFIX + 'insertBefore'](node);\n    }\n  },\n\n  /**\n   * Patched `removeChild`. Note that all dom \"removals\" are routed here.\n   * Removes the given `node` from the element's `children`.\n   * This method also performs dom composition.\n   * @this {Node}\n   * @param {Node} node\n   * @param {boolean=} skipUnscoping\n   */\n  removeChild(node, skipUnscoping = false) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'removeChild'](node);\n    }\n    if (node[utils.SHADY_PREFIX + 'parentNode'] !== this) {\n      throw Error(\n        'The node to be removed is not a child of this node: ' + node\n      );\n    }\n    scheduleObserver(this, null, node);\n    let preventNativeRemove;\n    let ownerRoot = ownerShadyRootForNode(node);\n    const removingInsertionPoint =\n      ownerRoot && ownerRoot._removeContainedSlots(node);\n    const parentData = shadyDataForNode(this);\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordRemoveChild(node, this);\n      if (utils.hasShadowRootWithSlot(this)) {\n        parentData.root._asyncRender();\n        preventNativeRemove = true;\n      }\n    }\n    // unscope a node leaving a ShadowRoot if ShadyCSS is present, and this node\n    // is not going to be rescoped in `insertBefore`\n    if (\n      getScopingShim() &&\n      !skipUnscoping &&\n      ownerRoot &&\n      node.nodeType !== Node.TEXT_NODE\n    ) {\n      const oldScopeName = currentScopeForNode(node);\n      treeVisitor(node, (node) => {\n        removeShadyScoping(node, oldScopeName);\n      });\n    }\n    removeOwnerShadyRoot(node);\n    // if removing slot, must render containing root\n    if (ownerRoot) {\n      let changeSlotContent = this.localName === 'slot';\n      if (changeSlotContent) {\n        preventNativeRemove = true;\n      }\n      if (removingInsertionPoint || changeSlotContent) {\n        ownerRoot._asyncRender();\n      }\n    }\n    if (!preventNativeRemove) {\n      // if removing from a shadyRoot, remove from host instead\n      let container = utils.isShadyRoot(this)\n        ? /** @type {ShadowRoot} */ (this).host\n        : this;\n      // not guaranteed to physically be in container; e.g.\n      // (1) if parent has a shadyRoot, element may or may not at distributed\n      // location (could be undistributed)\n      // (2) if parent is a slot, element may not ben in composed dom\n      if (\n        !(parentData.root || node.localName === 'slot') ||\n        container === node[utils.NATIVE_PREFIX + 'parentNode']\n      ) {\n        container[utils.NATIVE_PREFIX + 'removeChild'](node);\n      }\n    }\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  replaceChild(node, ref_node) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n    this[utils.SHADY_PREFIX + 'removeChild'](ref_node);\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {boolean=} deep\n   */\n  cloneNode(deep) {\n    if (this.localName == 'template') {\n      return this[utils.NATIVE_PREFIX + 'cloneNode'](deep);\n    } else {\n      const n = this[utils.NATIVE_PREFIX + 'cloneNode'](false);\n      // Attribute nodes historically had childNodes, but they have later\n      // been removed from the spec.\n      // Make sure we do not do a deep clone on them for old browsers (IE11)\n      if (deep && n.nodeType !== Node.ATTRIBUTE_NODE) {\n        for (\n          let c = this[utils.SHADY_PREFIX + 'firstChild'], nc;\n          c;\n          c = c[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          nc = c[utils.SHADY_PREFIX + 'cloneNode'](true);\n          n[utils.SHADY_PREFIX + 'appendChild'](nc);\n        }\n      }\n      return n;\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {Object=} options\n   */\n  // TODO(sorvell): implement `options` e.g. `{ composed: boolean }`\n  getRootNode(options) {\n    if (!this || !this.nodeType) {\n      return;\n    }\n    const nodeData = ensureShadyDataForNode(this);\n    let root = nodeData.ownerShadyRoot;\n    if (root === undefined) {\n      if (utils.isShadyRoot(this)) {\n        root = this;\n        nodeData.ownerShadyRoot = root;\n      } else {\n        let parent = this[utils.SHADY_PREFIX + 'parentNode'];\n        root = parent\n          ? parent[utils.SHADY_PREFIX + 'getRootNode'](options)\n          : this;\n        // memo-ize result for performance but only memo-ize\n        // result if node is in the document. This avoids a problem where a root\n        // can be cached while an element is inside a fragment.\n        // If this happens and we cache the result, the value can become stale\n        // because for perf we avoid processing the subtree of added fragments.\n        if (document.documentElement[utils.NATIVE_PREFIX + 'contains'](this)) {\n          nodeData.ownerShadyRoot = root;\n        }\n      }\n    }\n    return root;\n  },\n\n  /** @this {Node} */\n  contains(node) {\n    return utils.contains(this, node);\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport {calculateSplices} from './array-splice.js';\nimport * as utils from './utils.js';\nimport {enqueue} from './flush.js';\nimport {ensureShadyDataForNode, shadyDataForNode} from './shady-data.js';\nimport {recordChildNodes} from './link-nodes.js';\nimport {patchShadyRoot} from './patch-shadyRoot.js';\n\n// Do not export this object. It must be passed as the first argument to the\n// ShadyRoot constructor in `attachShadow` to prevent the constructor from\n// throwing. This prevents the user from being able to manually construct a\n// ShadyRoot (i.e. `new ShadowRoot()`).\nconst ShadyRootConstructionToken = {};\n\nconst CATCHALL_NAME = '__catchall';\n\nconst MODE_CLOSED = 'closed';\n\nlet isRendering =\n  utils.settings['deferConnectionCallbacks'] &&\n  document.readyState === 'loading';\nlet rootRendered;\n\nfunction ancestorList(node) {\n  let ancestors = [];\n  do {\n    ancestors.unshift(node);\n  } while ((node = node[utils.SHADY_PREFIX + 'parentNode']));\n  return ancestors;\n}\n\n/**\n * @extends {ShadowRoot}\n */\nclass ShadyRoot {\n  constructor(token, host, options) {\n    if (token !== ShadyRootConstructionToken) {\n      throw new TypeError('Illegal constructor');\n    }\n    /** @type {boolean} */\n    this._renderPending;\n    /** @type {boolean} */\n    this._hasRendered;\n    /** @type {?Array<HTMLSlotElement>} */\n    this._slotList = null;\n    /** @type {?Object<string, Array<HTMLSlotElement>>} */\n    this._slotMap;\n    /** @type {?Array<HTMLSlotElement>} */\n    this._pendingSlots;\n    this._init(host, options);\n  }\n\n  _init(host, options) {\n    // root <=> host\n    this.host = host;\n    /** @type {!string|undefined} */\n    this.mode = options && options.mode;\n    recordChildNodes(this.host);\n    const hostData = ensureShadyDataForNode(this.host);\n    /** @type {!ShadyRoot} */\n    hostData.root = this;\n    hostData.publicRoot = this.mode !== MODE_CLOSED ? this : null;\n    // setup root\n    const rootData = ensureShadyDataForNode(this);\n    rootData.firstChild = rootData.lastChild = rootData.parentNode = rootData.nextSibling = rootData.previousSibling = null;\n    // NOTE: optimization flag, only require an asynchronous render\n    // to record parsed children if flag is not set.\n    if (utils.settings['preferPerformance']) {\n      let n;\n      while ((n = this.host[utils.NATIVE_PREFIX + 'firstChild'])) {\n        this.host[utils.NATIVE_PREFIX + 'removeChild'](n);\n      }\n    } else {\n      this._asyncRender();\n    }\n  }\n\n  _asyncRender() {\n    if (!this._renderPending) {\n      this._renderPending = true;\n      enqueue(() => this._render());\n    }\n  }\n\n  // returns the oldest renderPending ancestor root.\n  _getPendingDistributionRoot() {\n    let renderRoot;\n    let root = this;\n    while (root) {\n      if (root._renderPending) {\n        renderRoot = root;\n      }\n      root = root._getDistributionParent();\n    }\n    return renderRoot;\n  }\n\n  // Returns the shadyRoot `this.host` if `this.host`\n  // has children that require distribution.\n  _getDistributionParent() {\n    let root = this.host[utils.SHADY_PREFIX + 'getRootNode']();\n    if (!utils.isShadyRoot(root)) {\n      return;\n    }\n    const nodeData = shadyDataForNode(this.host);\n    if (nodeData && nodeData.__childSlotCount > 0) {\n      return root;\n    }\n  }\n\n  // Renders the top most render pending shadowRoot in the distribution tree.\n  // This is safe because when a distribution parent renders, all children render.\n  _render() {\n    // If this root is not pending, it needs no rendering work. Any pending\n    // parent that needs to render wll cause this root to render.\n    const root = this._renderPending && this._getPendingDistributionRoot();\n    if (root) {\n      root._renderSelf();\n    }\n  }\n\n  _flushInitial() {\n    if (!this._hasRendered && this._renderPending) {\n      this._render();\n    }\n  }\n\n  /** @override */\n  _renderSelf() {\n    // track rendering state.\n    const wasRendering = isRendering;\n    isRendering = true;\n    this._renderPending = false;\n    if (this._slotList) {\n      this._distribute();\n      this._compose();\n    }\n    // NOTE: optimization flag, only process parsed children\n    // if optimization flag is not set.\n    // on initial render remove any undistributed children.\n    if (!utils.settings['preferPerformance'] && !this._hasRendered) {\n      for (\n        let n = this.host[utils.SHADY_PREFIX + 'firstChild'];\n        n;\n        n = n[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        const data = shadyDataForNode(n);\n        if (\n          n[utils.NATIVE_PREFIX + 'parentNode'] === this.host &&\n          (n.localName === 'slot' || !data.assignedSlot)\n        ) {\n          this.host[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n      }\n    }\n    this._hasRendered = true;\n    isRendering = wasRendering;\n    if (rootRendered) {\n      rootRendered();\n    }\n  }\n\n  _distribute() {\n    this._validateSlots();\n    // capture # of previously assigned nodes to help determine if dirty.\n    for (let i = 0, slot; i < this._slotList.length; i++) {\n      slot = this._slotList[i];\n      this._clearSlotAssignedNodes(slot);\n    }\n    // distribute host children.\n    for (\n      let n = this.host[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      this._distributeNodeToSlot(n);\n    }\n    // fallback content, slotchange, and dirty roots\n    for (let i = 0; i < this._slotList.length; i++) {\n      const slot = this._slotList[i];\n      const slotData = shadyDataForNode(slot);\n      // distribute fallback content\n      if (!slotData.assignedNodes.length) {\n        for (\n          let n = slot[utils.SHADY_PREFIX + 'firstChild'];\n          n;\n          n = n[utils.SHADY_PREFIX + 'nextSibling']\n        ) {\n          this._distributeNodeToSlot(n, slot);\n        }\n      }\n      const slotParentData = shadyDataForNode(\n        slot[utils.SHADY_PREFIX + 'parentNode']\n      );\n      const slotParentRoot = slotParentData && slotParentData.root;\n      if (\n        slotParentRoot &&\n        (slotParentRoot._hasInsertionPoint() || slotParentRoot._renderPending)\n      ) {\n        slotParentRoot._renderSelf();\n      }\n      this._addAssignedToFlattenedNodes(\n        slotData.flattenedNodes,\n        slotData.assignedNodes\n      );\n      let prevAssignedNodes = slotData._previouslyAssignedNodes;\n      if (prevAssignedNodes) {\n        for (let i = 0; i < prevAssignedNodes.length; i++) {\n          shadyDataForNode(prevAssignedNodes[i])._prevAssignedSlot = null;\n        }\n        slotData._previouslyAssignedNodes = null;\n        // dirty if previously less assigned nodes than previously assigned.\n        if (prevAssignedNodes.length > slotData.assignedNodes.length) {\n          slotData.dirty = true;\n        }\n      }\n      /* Note: A slot is marked dirty whenever a node is newly assigned to it\n      or a node is assigned to a different slot (done in `_distributeNodeToSlot`)\n      or if the number of nodes assigned to the slot has decreased (done above);\n      */\n      if (slotData.dirty) {\n        slotData.dirty = false;\n        this._fireSlotChange(slot);\n      }\n    }\n  }\n\n  /**\n   * Distributes given `node` to the appropriate slot based on its `slot`\n   * attribute. If `forcedSlot` is given, then the node is distributed to the\n   * `forcedSlot`.\n   * Note: slot to which the node is assigned will be marked dirty for firing\n   * `slotchange`.\n   * @param {Node} node\n   * @param {Node=} forcedSlot\n   *\n   */\n  _distributeNodeToSlot(node, forcedSlot) {\n    const nodeData = ensureShadyDataForNode(node);\n    let oldSlot = nodeData._prevAssignedSlot;\n    nodeData._prevAssignedSlot = null;\n    let slot = forcedSlot;\n    if (!slot) {\n      let name = node[utils.SHADY_PREFIX + 'slot'] || CATCHALL_NAME;\n      const list = this._slotMap[name];\n      slot = list && list[0];\n    }\n    if (slot) {\n      const slotData = ensureShadyDataForNode(slot);\n      slotData.assignedNodes.push(node);\n      nodeData.assignedSlot = slot;\n    } else {\n      nodeData.assignedSlot = undefined;\n    }\n    if (oldSlot !== nodeData.assignedSlot) {\n      if (nodeData.assignedSlot) {\n        ensureShadyDataForNode(nodeData.assignedSlot).dirty = true;\n      }\n    }\n  }\n\n  /**\n   * Clears the assignedNodes tracking data for a given `slot`. Note, the current\n   * assigned node data is tracked (via _previouslyAssignedNodes and\n   * _prevAssignedSlot) to see if `slotchange` should fire. This data may be out\n   *  of date at this time because the assigned nodes may have already been\n   * distributed to another root. This is ok since this data is only used to\n   * track changes.\n   * @param {HTMLSlotElement} slot\n   */\n  _clearSlotAssignedNodes(slot) {\n    const slotData = shadyDataForNode(slot);\n    let n$ = slotData.assignedNodes;\n    slotData.assignedNodes = [];\n    slotData.flattenedNodes = [];\n    slotData._previouslyAssignedNodes = n$;\n    if (n$) {\n      for (let i = 0; i < n$.length; i++) {\n        let n = shadyDataForNode(n$[i]);\n        n._prevAssignedSlot = n.assignedSlot;\n        // only clear if it was previously set to this slot;\n        // this helps ensure that if the node has otherwise been distributed\n        // ignore it.\n        if (n.assignedSlot === slot) {\n          n.assignedSlot = null;\n        }\n      }\n    }\n  }\n\n  _addAssignedToFlattenedNodes(flattened, assigned) {\n    for (let i = 0, n; i < assigned.length && (n = assigned[i]); i++) {\n      if (n.localName == 'slot') {\n        const nestedAssigned = shadyDataForNode(n).assignedNodes;\n        if (nestedAssigned && nestedAssigned.length) {\n          this._addAssignedToFlattenedNodes(flattened, nestedAssigned);\n        }\n      } else {\n        flattened.push(assigned[i]);\n      }\n    }\n  }\n\n  _fireSlotChange(slot) {\n    // NOTE: cannot bubble correctly here so not setting bubbles: true\n    // Safari tech preview does not bubble but chrome does\n    // Spec says it bubbles (https://dom.spec.whatwg.org/#mutation-observers)\n    slot[utils.NATIVE_PREFIX + 'dispatchEvent'](new Event('slotchange'));\n    const slotData = shadyDataForNode(slot);\n    if (slotData.assignedSlot) {\n      this._fireSlotChange(slotData.assignedSlot);\n    }\n  }\n\n  // Reify dom such that it is at its correct rendering position\n  // based on logical distribution.\n  // NOTE: here we only compose parents of <slot> elements and not the\n  // shadowRoot into the host. The latter is performend via a fast path\n  // in the `logical-mutation`.insertBefore.\n  _compose() {\n    const slots = this._slotList;\n    let composeList = [];\n    for (let i = 0; i < slots.length; i++) {\n      const parent = slots[i][utils.SHADY_PREFIX + 'parentNode'];\n      /* compose node only if:\n        (1) parent does not have a shadowRoot since shadowRoot has already\n        composed into the host\n        (2) we're not already composing it\n        [consider (n^2) but rare better than Set]\n      */\n      const parentData = shadyDataForNode(parent);\n      if (!(parentData && parentData.root) && composeList.indexOf(parent) < 0) {\n        composeList.push(parent);\n      }\n    }\n    for (let i = 0; i < composeList.length; i++) {\n      const node = composeList[i];\n      const targetNode = node === this ? this.host : node;\n      this._updateChildNodes(targetNode, this._composeNode(node));\n    }\n  }\n\n  // Returns the list of nodes which should be rendered inside `node`.\n  _composeNode(node) {\n    let children = [];\n    for (\n      let n = node[utils.SHADY_PREFIX + 'firstChild'];\n      n;\n      n = n[utils.SHADY_PREFIX + 'nextSibling']\n    ) {\n      // Note: if we see a slot here, the nodes are guaranteed to need to be\n      // composed here. This is because if there is redistribution, it has\n      // already been handled by this point.\n      if (this._isInsertionPoint(n)) {\n        let flattenedNodes = shadyDataForNode(n).flattenedNodes;\n        for (let j = 0; j < flattenedNodes.length; j++) {\n          let distributedNode = flattenedNodes[j];\n          children.push(distributedNode);\n        }\n      } else {\n        children.push(n);\n      }\n    }\n    return children;\n  }\n\n  _isInsertionPoint(node) {\n    return node.localName == 'slot';\n  }\n\n  // Ensures that the rendered node list inside `container` is `children`.\n  _updateChildNodes(container, children) {\n    let composed = utils.nativeChildNodesArray(container);\n    let splices = calculateSplices(children, composed);\n    // process removals\n    for (let i = 0, d = 0, s; i < splices.length && (s = splices[i]); i++) {\n      for (let j = 0, n; j < s.removed.length && (n = s.removed[j]); j++) {\n        // check if the node is still where we expect it is before trying\n        // to remove it; this can happen if we move a node and\n        // then schedule its previous host for distribution resulting in\n        // the node being removed here.\n        if (n[utils.NATIVE_PREFIX + 'parentNode'] === container) {\n          container[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n        // TODO(sorvell): avoid the need for splicing here.\n        composed.splice(s.index + d, 1);\n      }\n      d -= s.addedCount;\n    }\n    // process adds\n    for (let i = 0, s, next; i < splices.length && (s = splices[i]); i++) {\n      // eslint-disable-line no-redeclare\n      next = composed[s.index];\n      for (let j = s.index, n; j < s.index + s.addedCount; j++) {\n        n = children[j];\n        container[utils.NATIVE_PREFIX + 'insertBefore'](n, next);\n        composed.splice(j, 0, n);\n      }\n    }\n  }\n\n  _ensureSlotData() {\n    this._pendingSlots = this._pendingSlots || [];\n    this._slotList = this._slotList || [];\n    this._slotMap = this._slotMap || {};\n  }\n\n  _addSlots(slots) {\n    this._ensureSlotData();\n    this._pendingSlots.push(...slots);\n  }\n\n  _validateSlots() {\n    if (this._pendingSlots && this._pendingSlots.length) {\n      this._mapSlots(this._pendingSlots);\n      this._pendingSlots = [];\n    }\n  }\n\n  /**\n   * Adds the given slots. Slots are maintained in an dom-ordered list.\n   * In addition a map of name to slot is updated.\n   */\n  _mapSlots(slots) {\n    let slotNamesToSort;\n    for (let i = 0; i < slots.length; i++) {\n      const slot = slots[i];\n      // ensure insertionPoints's and their parents have logical dom info.\n      // save logical tree info\n      // a. for shadyRoot\n      // b. for insertion points (fallback)\n      // c. for parents of insertion points\n      recordChildNodes(slot);\n      const slotParent = slot[utils.SHADY_PREFIX + 'parentNode'];\n      recordChildNodes(slotParent);\n      const slotParentData = shadyDataForNode(slotParent);\n      slotParentData.__childSlotCount =\n        (slotParentData.__childSlotCount || 0) + 1;\n      let name = this._nameForSlot(slot);\n      if (this._slotMap[name]) {\n        slotNamesToSort = slotNamesToSort || {};\n        slotNamesToSort[name] = true;\n        this._slotMap[name].push(slot);\n      } else {\n        this._slotMap[name] = [slot];\n      }\n      this._slotList.push(slot);\n    }\n    if (slotNamesToSort) {\n      for (let n in slotNamesToSort) {\n        this._slotMap[n] = this._sortSlots(this._slotMap[n]);\n      }\n    }\n  }\n\n  _nameForSlot(slot) {\n    const name = slot['name'] || slot.getAttribute('name') || CATCHALL_NAME;\n    slot.__slotName = name;\n    return name;\n  }\n\n  /**\n   * Slots are kept in an ordered list. Slots with the same name\n   * are sorted here by tree order.\n   */\n  _sortSlots(slots) {\n    // NOTE: Cannot use `compareDocumentPosition` because it's not polyfilled,\n    // but the code here could be used to polyfill the preceeding/following info\n    // in `compareDocumentPosition`.\n    return slots.sort((a, b) => {\n      let listA = ancestorList(a);\n      let listB = ancestorList(b);\n      for (var i = 0; i < listA.length; i++) {\n        let nA = listA[i];\n        let nB = listB[i];\n        if (nA !== nB) {\n          let c$ = utils.childNodesArray(nA[utils.SHADY_PREFIX + 'parentNode']);\n          return c$.indexOf(nA) - c$.indexOf(nB);\n        }\n      }\n    });\n  }\n\n  /**\n   * Removes from tracked slot data any slots contained within `container` and\n   * then updates the tracked data (_slotList and _slotMap).\n   * Any removed slots also have their `assignedNodes` removed from comopsed dom.\n   */\n  _removeContainedSlots(container) {\n    if (!this._slotList) {\n      return;\n    }\n    this._validateSlots();\n    let didRemove;\n    const map = this._slotMap;\n    for (let n in map) {\n      const slots = map[n];\n      for (let i = 0; i < slots.length; i++) {\n        const slot = slots[i];\n        if (utils.contains(container, slot)) {\n          slots.splice(i, 1);\n          const x = this._slotList.indexOf(slot);\n          if (x >= 0) {\n            this._slotList.splice(x, 1);\n            const slotParentData = shadyDataForNode(\n              slot[utils.SHADY_PREFIX + 'parentNode']\n            );\n            if (slotParentData && slotParentData.__childSlotCount) {\n              slotParentData.__childSlotCount--;\n            }\n          }\n          i--;\n          this._removeFlattenedNodes(slot);\n          didRemove = true;\n        }\n      }\n    }\n    return didRemove;\n  }\n\n  _updateSlotName(slot) {\n    if (!this._slotList) {\n      return;\n    }\n    // make sure slotMap is initialized with this slot\n    this._validateSlots();\n    const oldName = slot.__slotName;\n    const name = this._nameForSlot(slot);\n    if (name === oldName) {\n      return;\n    }\n    // remove from existing tracking\n    let slots = this._slotMap[oldName];\n    const i = slots.indexOf(slot);\n    if (i >= 0) {\n      slots.splice(i, 1);\n    }\n    // add to new location and sort if nedessary\n    let list = this._slotMap[name] || (this._slotMap[name] = []);\n    list.push(slot);\n    if (list.length > 1) {\n      this._slotMap[name] = this._sortSlots(list);\n    }\n  }\n\n  _removeFlattenedNodes(slot) {\n    const data = shadyDataForNode(slot);\n    let n$ = data.flattenedNodes;\n    if (n$) {\n      for (let i = 0; i < n$.length; i++) {\n        let node = n$[i];\n        let parent = node[utils.NATIVE_PREFIX + 'parentNode'];\n        if (parent) {\n          parent[utils.NATIVE_PREFIX + 'removeChild'](node);\n        }\n      }\n    }\n    data.flattenedNodes = [];\n    data.assignedNodes = [];\n  }\n\n  _hasInsertionPoint() {\n    this._validateSlots();\n    return Boolean(this._slotList && this._slotList.length);\n  }\n}\n\npatchShadyRoot(ShadyRoot.prototype);\nexport {ShadyRoot};\n\n/**\n  Implements a pared down version of ShadowDOM's scoping, which is easy to\n  polyfill across browsers.\n*/\nexport const attachShadow = (host, options) => {\n  if (!host) {\n    throw new Error('Must provide a host.');\n  }\n  if (!options) {\n    throw new Error('Not enough arguments.');\n  }\n  let root;\n  // Optimization for booting up a shadowRoot from a fragment rather than\n  // creating one.\n  if (options['shadyUpgradeFragment'] && utils.canUpgrade()) {\n    root = options['shadyUpgradeFragment'];\n    root.__proto__ = ShadowRoot.prototype;\n    root._init(host, options);\n    recordChildNodes(root, root);\n    // Note: qsa is native when used with noPatch.\n    /** @type {?NodeList<Element>} */\n    const slotsAdded = root['__noInsertionPoint']\n      ? null\n      : root.querySelectorAll('slot');\n    // Reset scoping information so normal scoing rules apply after this.\n    root['__noInsertionPoint'] = undefined;\n    // if a slot is added, must render containing root.\n    if (slotsAdded && slotsAdded.length) {\n      root._addSlots(slotsAdded);\n      root._asyncRender();\n    }\n    /** @type {ShadowRoot} */ (root).host[utils.NATIVE_PREFIX + 'appendChild'](\n      root\n    );\n  } else {\n    root = new ShadyRoot(ShadyRootConstructionToken, host, options);\n  }\n  return root;\n};\n\n// Mitigate connect/disconnect spam by wrapping custom element classes. This\n// should happen if custom elements are available in any capacity, polyfilled or\n// not.\nif (\n  utils.hasCustomElements() &&\n  utils.settings.inUse &&\n  !utils.settings['preferPerformance']\n) {\n  // process connect/disconnect after roots have rendered to avoid\n  // issues with reaction stack.\n  let connectMap = new Map();\n  rootRendered = function () {\n    // allow elements to connect\n    // save map state (without needing polyfills on IE11)\n    const r = [];\n    connectMap.forEach((v, k) => {\n      r.push([k, v]);\n    });\n    connectMap.clear();\n    for (let i = 0; i < r.length; i++) {\n      const e = r[i][0],\n        value = r[i][1];\n      if (value) {\n        e['__shadydom_connectedCallback']();\n      } else {\n        e['__shadydom_disconnectedCallback']();\n      }\n    }\n  };\n\n  // Document is in loading state and flag is set (deferConnectionCallbacks)\n  // so process connection stack when `readystatechange` fires.\n  if (isRendering) {\n    document.addEventListener(\n      'readystatechange',\n      () => {\n        isRendering = false;\n        rootRendered();\n      },\n      {once: true}\n    );\n  }\n\n  /*\n   * (1) elements can only be connected/disconnected if they are in the expected\n   * state.\n   * (2) never run connect/disconnect during rendering to avoid reaction stack issues.\n   */\n  const ManageConnect = (base, connected, disconnected) => {\n    let counter = 0;\n    const connectFlag = `__isConnected${counter++}`;\n    if (connected || disconnected) {\n      /** @this {!HTMLElement} */\n      base.prototype.connectedCallback = base.prototype[\n        '__shadydom_connectedCallback'\n      ] = function () {\n        // if rendering defer connected\n        // otherwise connect only if we haven't already\n        if (isRendering) {\n          connectMap.set(this, true);\n        } else if (!this[connectFlag]) {\n          this[connectFlag] = true;\n          if (connected) {\n            connected.call(this);\n          }\n        }\n      };\n\n      /** @this {!HTMLElement} */\n      base.prototype.disconnectedCallback = base.prototype[\n        '__shadydom_disconnectedCallback'\n      ] = function () {\n        // if rendering, cancel a pending connection and queue disconnect,\n        // otherwise disconnect only if a connection has been allowed\n        if (isRendering) {\n          // This is necessary only because calling removeChild\n          // on a node that requires distribution leaves it in the DOM tree\n          // until distribution.\n          // NOTE: remember this is checking the patched isConnected to determine\n          // if the node is in the logical tree.\n          if (!this.isConnected) {\n            connectMap.set(this, false);\n          }\n        } else if (this[connectFlag]) {\n          this[connectFlag] = false;\n          if (disconnected) {\n            disconnected.call(this);\n          }\n        }\n      };\n    }\n\n    return base;\n  };\n\n  const originalDefine = window['customElements']['define'];\n  const define = function (name, constructor) {\n    const connected = constructor.prototype.connectedCallback;\n    const disconnected = constructor.prototype.disconnectedCallback;\n    originalDefine.call(\n      window['customElements'],\n      name,\n      ManageConnect(constructor, connected, disconnected)\n    );\n    // unpatch connected/disconnected on class; custom elements tears this off\n    // so the patch is maintained, but if the user calls these methods for\n    // e.g. testing, they will be as expected.\n    constructor.prototype.connectedCallback = connected;\n    constructor.prototype.disconnectedCallback = disconnected;\n  };\n  // Note, it would be better to only patch the CustomElementRegistry.prototype,\n  // but ShadyCSS patches define directly.\n  window.customElements.define = define;\n  // Still patch the registry directly since Safari 10 loses the patch\n  // unless this is done.\n  Object.defineProperty(window['CustomElementRegistry'].prototype, 'define', {\n    value: define,\n    configurable: true,\n  });\n}\n\n/** @return {!ShadyRoot|undefined} */\nexport const ownerShadyRootForNode = (node) => {\n  let root = node[utils.SHADY_PREFIX + 'getRootNode']();\n  if (utils.isShadyRoot(root)) {\n    return root;\n  }\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const SlotablePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Node} */\n  get assignedSlot() {\n    // Force any parent's shadowRoot to flush so that distribution occurs\n    // and this node has an assignedSlot.\n    const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n    const ownerRoot = parent && parent[utils.SHADY_PREFIX + 'shadowRoot'];\n    if (ownerRoot) {\n      ownerRoot._render();\n    }\n    const nodeData = shadyDataForNode(this);\n    return (nodeData && nodeData.assignedSlot) || null;\n  },\n});\n","/**\n * @license\n * Copyright (c) 2022 The Polymer Project Authors\n * SPDX-License-Identifier: BSD-3-Clause\n */\n\n/**\n * A map describing parentheses-like grouping characters and their behavior. The\n * keys are the group's start character and the value's `end` property contains\n * the end character. The `matchNestedParens` property indicates whether or not\n * other grouping characters nested in the group retain their grouping behavior\n * within that group - i.e. if nested grouping characters need to be matched.\n *\n * @type {!Map<string, {end: string, matchNestedParens: boolean}>}\n */\nconst PARENS = new Map();\n// IE 11 doesn't support `Map`'s constructor parameter.\n[\n  ['(', {end: ')', matchNestedParens: true}],\n  ['[', {end: ']', matchNestedParens: true}],\n  ['\"', {end: '\"', matchNestedParens: false}],\n  [\"'\", {end: \"'\", matchNestedParens: false}],\n].forEach(([k, v]) => {\n  PARENS.set(k, v);\n});\n\n/**\n * Finds the first character of `queryChars` within `str` from index `start`\n * onwards that is _not_ nested within any parentheses, brackets, or\n * single/double-quoted strings or part of an escape sequence.\n *\n * If the end of the string is reached without finding a character in\n * `queryChars`, the length of the string is returned.\n *\n * @param {string} str\n * @param {number} start\n * @param {!Array<string>} queryChars\n * @param {boolean} matchNestedParens\n * @return {number}\n */\nconst findNext = (str, start, queryChars, matchNestedParens = true) => {\n  for (let i = start; i < str.length; i++) {\n    if (str[i] === '\\\\' && i < str.length - 1 && str[i + 1] !== '\\n') {\n      // Skip escape sequences.\n      i++;\n    } else if (queryChars.indexOf(str[i]) !== -1) {\n      // One of `queryChars` was found.\n      return i;\n    } else if (matchNestedParens && PARENS.has(str[i])) {\n      // Handle any grouping characters by skipping over the group.\n      const parenInfo = PARENS.get(str[i]);\n      i = findNext(str, i + 1, [parenInfo.end], parenInfo.matchNestedParens);\n      continue;\n    }\n\n    // Do nothing, let `i++` happen.\n  }\n\n  // Reached the end of the string without finding a final char.\n  return str.length;\n};\n\n/**\n * Arrays of compound selectors and combinators that form a complex selector\n * when interleaved.\n *\n * @typedef {{\n *   compoundSelectors: !Array<string>,\n *   combinators: !Array<string>,\n * }}\n */\nexport let ComplexSelectorParts;\n\n/**\n * Splits a selector list into individual complex selectors and creates a\n * `ComplexSelectorParts` for each.\n *\n * @param {string} str\n * @return {!Array<!ComplexSelectorParts>}\n */\nexport const parseSelectorList = (str) => {\n  /**\n   * @type {!Array<!ComplexSelectorParts>}\n   */\n  const results = [];\n\n  /**\n   * Compound selectors and combinators parsed from the current complex\n   * selector.\n   *\n   * @type {!Array<string>}\n   */\n  const chunks = [];\n\n  /**\n   * Creates a new `ComplexSelectorParts` from the current `chunks`, pushes it\n   * into `results` and resets `chunks`.\n   */\n  const endComplexSelector = () => {\n    if (chunks.length > 0) {\n      while (chunks[chunks.length - 1] === ' ') {\n        chunks.pop();\n      }\n      results.push({\n        compoundSelectors: chunks.filter((x, i) => i % 2 === 0),\n        combinators: chunks.filter((x, i) => i % 2 === 1),\n      });\n      chunks.length = 0;\n    }\n  };\n\n  for (let i = 0; i < str.length; ) {\n    const prevChunk = chunks[chunks.length - 1];\n    // `nextIndex` is the next complex selector boundary, combinator, or\n    // whitespace that isn't inside other grouping characters.\n    const nextIndex = findNext(str, i, [',', ' ', '>', '+', '~']);\n    // If `nextIndex` is `i`, then the chunk we're considering is only the next\n    // single character.\n    const nextChunk = nextIndex === i ? str[i] : str.substring(i, nextIndex);\n\n    if (nextChunk === ',') {\n      endComplexSelector();\n    } else if (\n      [undefined, ' ', '>', '+', '~'].indexOf(prevChunk) !== -1 &&\n      nextChunk === ' '\n    ) {\n      // Ignore leading whitespace and whitespace directly after combinators.\n    } else if (prevChunk === ' ' && ['>', '+', '~'].indexOf(nextChunk) !== -1) {\n      // If the last chunk was whitespace and this chunk is a non-whitespace\n      // combinator, replace the whitespace with this combinator.\n      chunks[chunks.length - 1] = nextChunk;\n    } else {\n      chunks.push(nextChunk);\n    }\n\n    i = nextIndex + (nextIndex === i ? 1 : 0);\n  }\n\n  endComplexSelector();\n\n  return results;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {ComplexSelectorParts, parseSelectorList} from '../selector-parser.js'; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n/**\n * @param {Node} node\n * @param {Function} matcher\n * @param {Function=} halter\n */\nexport function query(node, matcher, halter) {\n  let list = [];\n  queryChildNodes(node, matcher, halter, list);\n  return list;\n}\n\nfunction queryChildNodes(parent, matcher, halter, list) {\n  for (\n    let n = parent[utils.SHADY_PREFIX + 'firstChild'];\n    n;\n    n = n[utils.SHADY_PREFIX + 'nextSibling']\n  ) {\n    if (\n      n.nodeType === Node.ELEMENT_NODE &&\n      queryElement(n, matcher, halter, list)\n    ) {\n      return true;\n    }\n  }\n}\n\nfunction queryElement(node, matcher, halter, list) {\n  let result = matcher(node);\n  if (result) {\n    list.push(node);\n  }\n  if (halter && halter(result)) {\n    return result;\n  }\n  queryChildNodes(node, matcher, halter, list);\n}\n\n// Needed on Element, DocumentFragment, Document\nexport const ParentNodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get firstElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.firstChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'firstChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'firstElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get lastElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.lastChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'lastChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'lastElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get children() {\n    if (!utils.isTrackingLogicalChildNodes(this)) {\n      return this[utils.NATIVE_PREFIX + 'children'];\n    }\n    return utils.createPolyfilledHTMLCollection(\n      Array.prototype.filter.call(utils.childNodesArray(this), (n) => {\n        return n.nodeType === Node.ELEMENT_NODE;\n      })\n    );\n  },\n\n  /** @this {Element} */\n  get childElementCount() {\n    let children = this[utils.SHADY_PREFIX + 'children'];\n    if (children) {\n      return children.length;\n    }\n    return 0;\n  },\n\n  /** @this {Element} */\n  append(...args) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      null\n    );\n  },\n\n  /** @this {Element} */\n  prepend(...args) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      this[utils.SHADY_PREFIX + 'firstChild']\n    );\n  },\n\n  /** @this {Element} */\n  ['replaceChildren'](...args) {\n    let child;\n    while ((child = this[utils.SHADY_PREFIX + 'firstChild']) !== null) {\n      this[utils.SHADY_PREFIX + 'removeChild'](child);\n    }\n    this[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      null\n    );\n  },\n});\n\n/**\n * Performs the equivalent of `querySelectorAll` within Shady DOM's logical\n * model of the tree for a selector list.\n *\n * See <./logicalQuerySelectorAll.md> for implementation details.\n *\n * @param {!ParentNode} contextNode\n * @param {string} selectorList\n * @return {!Array<!Element>}\n */\nconst logicalQuerySelectorAll = (contextNode, selectorList) => {\n  /**\n   * @type {!Array<!ComplexSelectorParts>}\n   */\n  const complexSelectors = parseSelectorList(selectorList);\n\n  if (complexSelectors.length < 1) {\n    return [];\n  }\n\n  /**\n   * Determines if a single compound selector matches an element. If the\n   * selector contains `:scope` (as a substring), then the selector only is only\n   * considered matching if `element` is `contextNode`.\n   *\n   * @param {!Element} element\n   * @param {string} compoundSelector\n   * @return {boolean}\n   */\n  const matchesCompoundSelector = (element, compoundSelector) => {\n    return (\n      (element === contextNode || compoundSelector.indexOf(':scope') === -1) &&\n      utils.matchesSelector(element, compoundSelector)\n    );\n  };\n\n  /**\n   * An object used to track the current position of a potential selector match.\n   *\n   * - `target` is the element that would be considered matching if the cursor\n   * eventually results in a complete match.\n   *\n   * - `complexSelectorParts` is the parsed representation of the complex\n   * selector that this cursor is attempting to match.\n   *\n   * - `index` is the index into `.complexSelectorParts.compoundSelectors` of\n   * the last successfully matched compound selector.\n   *\n   * - `matchedElement` is the element that successfully matched the compound\n   * selector in `.complexSelectorParts.compoundSelectors` at `index`.\n   *\n   * @typedef {{\n   *   target: !Element,\n   *   complexSelectorParts: !ComplexSelectorParts,\n   *   matchedElement: !Element,\n   *   index: number,\n   * }}\n   */\n  let SelectorMatchingCursor; // eslint-disable-line @typescript-eslint/no-unused-vars\n\n  /**\n   * The list of `SelectorMatchingCursor`s, initialized with cursors pointing at\n   * all descendants of `contextNode` that match the last compound selector in\n   * any complex selector in `selectorList`.\n   *\n   * @type {!Array<!SelectorMatchingCursor>}\n   */\n  let cursors = utils.flat(\n    query(contextNode, (_element) => true).map((element) => {\n      return utils.flat(\n        complexSelectors.map((complexSelectorParts) => {\n          const {compoundSelectors} = complexSelectorParts;\n          // Selectors are matched by iterating their compound selectors in\n          // reverse order for efficiency. In particular, when finding\n          // candidates for the descendant combinator, iterating forwards would\n          // imply needing to walk all descendants of the last matched element\n          // for possible candidates, but iterating backwards only requires\n          // walking up the ancestor chain.\n          const index = compoundSelectors.length - 1;\n          if (matchesCompoundSelector(element, compoundSelectors[index])) {\n            return {\n              target: element,\n              complexSelectorParts,\n              matchedElement: element,\n              index,\n            };\n          } else {\n            return [];\n          }\n        })\n      );\n    })\n  );\n\n  // At each step, any remaining cursors that have not finished matching (i.e.\n  // with `cursor.index > 0`) should be replaced with new cursors for any valid\n  // candidates that match the next compound selector.\n  while (cursors.some((cursor) => cursor.index > 0)) {\n    cursors = utils.flat(\n      cursors.map((cursor) => {\n        // Cursors with `index` of 0 have already matched and should not be\n        // replaced or removed.\n        if (cursor.index <= 0) {\n          return cursor;\n        }\n\n        const {\n          target,\n          matchedElement,\n          complexSelectorParts,\n          index: lastIndex,\n        } = cursor;\n        const index = lastIndex - 1;\n        const combinator = complexSelectorParts.combinators[index];\n        const compoundSelector = complexSelectorParts.compoundSelectors[index];\n\n        if (combinator === ' ') {\n          const results = [];\n\n          // For `a b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are all ancestors of each\n          // cursor's `matchedElement`.\n          for (\n            let ancestor = matchedElement[utils.SHADY_PREFIX + 'parentElement'];\n            ancestor;\n            ancestor = ancestor[utils.SHADY_PREFIX + 'parentElement']\n          ) {\n            if (matchesCompoundSelector(ancestor, compoundSelector)) {\n              results.push({\n                target,\n                complexSelectorParts,\n                matchedElement: ancestor,\n                index,\n              });\n            }\n          }\n\n          return results;\n        } else if (combinator === '>') {\n          const parent = matchedElement[utils.SHADY_PREFIX + 'parentElement'];\n\n          // For `a > b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are the parents of each\n          // cursor's `matchedElement`.\n          if (matchesCompoundSelector(parent, compoundSelector)) {\n            return {\n              target,\n              complexSelectorParts,\n              matchedElement: parent,\n              index,\n            };\n          }\n\n          return [];\n        } else if (combinator === '+') {\n          const sibling =\n            matchedElement[utils.SHADY_PREFIX + 'previousElementSibling'];\n\n          // For `a + b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are the immediately\n          // preceding siblings of each cursor's `matchedElement`.\n          if (sibling && matchesCompoundSelector(sibling, compoundSelector)) {\n            return {\n              target,\n              complexSelectorParts,\n              matchedElement: sibling,\n              index,\n            };\n          }\n\n          return [];\n        } else if (combinator === '~') {\n          const results = [];\n\n          // For `a ~ b`, where existing cursors have `matchedElement`s matching\n          // `b`, the candidates to test against `a` are all preceding siblings\n          // of each cursor's `matchedElement`.\n          for (\n            let sibling =\n              matchedElement[utils.SHADY_PREFIX + 'previousElementSibling'];\n            sibling;\n            sibling = sibling[utils.SHADY_PREFIX + 'previousElementSibling']\n          ) {\n            if (matchesCompoundSelector(sibling, compoundSelector)) {\n              results.push({\n                target,\n                complexSelectorParts,\n                matchedElement: sibling,\n                index,\n              });\n            }\n          }\n\n          return results;\n        } else {\n          // As of writing, there are no other combinators:\n          // <https://drafts.csswg.org/selectors/#combinators>\n          throw new Error(`Unrecognized combinator: '${combinator}'.`);\n        }\n      })\n    );\n  }\n\n  // Map remaining cursors to their `target` and deduplicate.\n  return utils.deduplicate(cursors.map(({target}) => target));\n};\n\nconst querySelectorImplementation =\n  utils.settings['querySelectorImplementation'];\n\nexport const QueryPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {!ParentNode}\n   * @param {string} selector\n   */\n  querySelector(selector) {\n    if (querySelectorImplementation === 'native') {\n      // Polyfilled `ShadowRoot`s don't have a native `querySelectorAll`.\n      const target =\n        this instanceof ShadowRoot\n          ? /** @type {!ShadowRoot} */ (this).host\n          : this;\n      const candidates = Array.prototype.slice.call(\n        target[utils.NATIVE_PREFIX + 'querySelectorAll'](selector)\n      );\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      // This could use `find`, but Closure doesn't polyfill it.\n      for (const candidate of candidates) {\n        if (candidate[utils.SHADY_PREFIX + 'getRootNode']() == root) {\n          return candidate;\n        }\n      }\n      return null;\n    } else if (querySelectorImplementation === 'selectorEngine') {\n      return logicalQuerySelectorAll(this, selector)[0] || null;\n    } else if (querySelectorImplementation === undefined) {\n      // match selector and halt on first result.\n      let result = query(\n        this,\n        function (n) {\n          return utils.matchesSelector(n, selector);\n        },\n        function (n) {\n          return Boolean(n);\n        }\n      )[0];\n      return result || null;\n    } else {\n      throw new Error(\n        'Unrecognized value of ShadyDOM.querySelectorImplementation: ' +\n          `'${querySelectorImplementation}'`\n      );\n    }\n  },\n\n  /**\n   * @this {!ParentNode}\n   * @param {string} selector\n   * @param {boolean} useNative\n   */\n  querySelectorAll(selector, useNative) {\n    if (useNative || querySelectorImplementation === 'native') {\n      // Polyfilled `ShadowRoot`s don't have a native `querySelectorAll`.\n      const target =\n        this instanceof ShadowRoot\n          ? /** @type {!ShadowRoot} */ (this).host\n          : this;\n      const candidates = Array.prototype.slice.call(\n        target[utils.NATIVE_PREFIX + 'querySelectorAll'](selector)\n      );\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      return utils.createPolyfilledHTMLCollection(\n        candidates.filter(\n          (e) => e[utils.SHADY_PREFIX + 'getRootNode']() == root\n        )\n      );\n    } else if (querySelectorImplementation === 'selectorEngine') {\n      return utils.createPolyfilledHTMLCollection(\n        logicalQuerySelectorAll(this, selector)\n      );\n    } else if (querySelectorImplementation === undefined) {\n      return utils.createPolyfilledHTMLCollection(\n        query(this, function (n) {\n          return utils.matchesSelector(n, selector);\n        })\n      );\n    } else {\n      throw new Error(\n        'Unrecognized value of ShadyDOM.querySelectorImplementation: ' +\n          `'${querySelectorImplementation}'`\n      );\n    }\n  },\n});\n\n// In preferPerformance mode, create a custom `ParentNodeDocumentOrFragment`\n// that optionally does not mixin querySelector/All; this is a performance\n// optimization. In noPatch, we need to keep the query patches here in order to\n// ensure the query API is available on the wrapper\nexport const ParentNodeDocumentOrFragmentPatches =\n  utils.settings.preferPerformance && !utils.settings.noPatch\n    ? utils.assign({}, ParentNodePatches)\n    : ParentNodePatches;\n\nutils.assign(ParentNodePatches, QueryPatches);\n","/**\n@license\nCopyright (c) 2020 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ChildNodePatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  after(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    const nextSibling = this[utils.SHADY_PREFIX + 'nextSibling'];\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      nextSibling\n    );\n  },\n\n  /** @this {Element} */\n  before(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      this\n    );\n  },\n\n  /** @this {Element} */\n  remove() {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    parentNode[utils.SHADY_PREFIX + 'removeChild'](this);\n  },\n\n  /** @this {Element} */\n  replaceWith(...args) {\n    const parentNode = this[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode === null) {\n      return;\n    }\n    const nextSibling = this[utils.SHADY_PREFIX + 'nextSibling'];\n    parentNode[utils.SHADY_PREFIX + 'removeChild'](this);\n    parentNode[utils.SHADY_PREFIX + 'insertBefore'](\n      utils.convertNodesIntoANode(...args),\n      nextSibling\n    );\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {scopeClassAttribute} from '../style-scoping.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {attachShadow, ownerShadyRootForNode} from '../attach-shadow.js';\n// prettier-ignore\nimport {eventPropertyNamesForElement, wrappedDescriptorForEventProperty} from '../patch-events.js';\n\nconst doc = window.document;\n\n/**\n * Should be called whenever an attribute changes. If the `slot` attribute\n * changes, provokes rendering if necessary. If a `<slot>` element's `name`\n * attribute changes, updates the root's slot map and renders.\n * @param {Node} node\n * @param {string} name\n */\nfunction distributeAttributeChange(node, name) {\n  if (name === 'slot') {\n    const parent = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (utils.hasShadowRootWithSlot(parent)) {\n      shadyDataForNode(parent).root._asyncRender();\n    }\n  } else if (node.localName === 'slot' && name === 'name') {\n    let root = ownerShadyRootForNode(node);\n    if (root) {\n      root._updateSlotName(node);\n      root._asyncRender();\n    }\n  }\n}\n\nexport const ElementPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get previousElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.previousSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'previousSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'previousElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get nextElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.nextSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'nextSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'nextElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get slot() {\n    return this.getAttribute('slot');\n  },\n\n  /** @this {Element} */\n  set slot(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('slot', value);\n  },\n\n  /** @this {Element} */\n  get className() {\n    return this.getAttribute('class') || '';\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('class', value);\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {string} value\n   */\n  setAttribute(attr, value) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n    } else if (!scopeClassAttribute(this, attr, value)) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n      distributeAttributeChange(this, attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   */\n  removeAttribute(attr) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    } else if (!scopeClassAttribute(this, attr, '')) {\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n      distributeAttributeChange(this, attr);\n    } else if (this.getAttribute(attr) === '') {\n      // When attr='class', scopeClassAttribute() will handle the change as a\n      // side-effect and return `true`, allowing us to get to this branch,\n      // which cleans up the 'class' attribute if it's empty and we were\n      // supposed to have removed it.\n      this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {boolean | undefined} force\n   */\n  toggleAttribute(attr, force) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n    } else if (!scopeClassAttribute(this, attr, '')) {\n      const result = this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n      distributeAttributeChange(this, attr);\n      return result;\n    } else if (this.getAttribute(attr) === '' && !force) {\n      // When attr='class', scopeClassAttribute() will handle the change as a\n      // side-effect and return `true`, allowing us to get to this branch,\n      // which cleans up the 'class' attribute if it's empty and we were\n      // supposed to have removed it.\n      // We check for `force` being falsey because we only want to clean up on\n      // removal of the attribute.\n      return this[utils.NATIVE_PREFIX + 'toggleAttribute'](attr, force);\n    }\n  },\n});\n\nif (!utils.settings.preferPerformance) {\n  eventPropertyNamesForElement.forEach((property) => {\n    ElementPatches[property] = wrappedDescriptorForEventProperty(property);\n  });\n}\n\nexport const ElementShadowPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {Element}\n   * @param {!{mode: string}} options\n   */\n  attachShadow(options) {\n    const root = attachShadow(this, options);\n    // TODO(sorvell): Workaround for CE not seeing shadowRoot in `on-demand`\n    // noPatch mode. CE's attachShadow patch is overwritten by this patch\n    // and cannot set its own special tracking for shadowRoot. It does this\n    // to be able to see closed shadowRoots.\n    // This is necessary so that the CE polyfill can traverse into nodes\n    // with shadowRoot that will under `on-demand` have their childNodes patched.\n    this['__CE_shadowRoot'] = root;\n    return root;\n  },\n\n  // Note: Can be patched on element prototype on all browsers.\n  // Must be patched on instance on browsers that support native Shadow DOM\n  // but do not have builtin accessors (old Chrome).\n  /** @this {Element} */\n  get shadowRoot() {\n    const nodeData = shadyDataForNode(this);\n    return (nodeData && nodeData.publicRoot) || null;\n  },\n});\n\nutils.assign(ElementPatches, ElementShadowPatches);\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {getInnerHTML} from '../innerHTML.js';\nimport {clearNode} from './Node.js';\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nexport const ElementOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Element} */\n  get innerHTML() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const content =\n        this.localName === 'template'\n          ? /** @type {HTMLTemplateElement} */ (this).content\n          : this;\n      return getInnerHTML(content, utils.childNodesArray);\n    } else {\n      return this[utils.NATIVE_PREFIX + 'innerHTML'];\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set innerHTML(value) {\n    if (this.localName === 'template') {\n      this[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n    } else {\n      clearNode(this);\n      const containerName = this.localName || 'div';\n      let htmlContainer;\n      if (!this.namespaceURI || this.namespaceURI === inertDoc.namespaceURI) {\n        htmlContainer = inertDoc.createElement(containerName);\n      } else {\n        htmlContainer = inertDoc.createElementNS(\n          this.namespaceURI,\n          containerName\n        );\n      }\n      if (utils.settings.hasDescriptors) {\n        htmlContainer[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n      } else {\n        htmlContainer.innerHTML = value;\n      }\n      let firstChild;\n      while ((firstChild = htmlContainer[utils.SHADY_PREFIX + 'firstChild'])) {\n        this[utils.SHADY_PREFIX + 'insertBefore'](firstChild);\n      }\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {eventPropertyNamesForHTMLElement, wrappedDescriptorForEventProperty} from '../patch-events.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const HTMLElementPatches = utils.getOwnPropertyDescriptors({\n  /** @this {HTMLElement} */\n  blur() {\n    const nodeData = shadyDataForNode(this);\n    let root = nodeData && nodeData.root;\n    let shadowActive = root && root.activeElement;\n    if (shadowActive) {\n      shadowActive[utils.SHADY_PREFIX + 'blur']();\n    } else {\n      this[utils.NATIVE_PREFIX + 'blur']();\n    }\n  },\n});\n\nif (!utils.settings.preferPerformance) {\n  eventPropertyNamesForHTMLElement.forEach((property) => {\n    HTMLElementPatches[property] = wrappedDescriptorForEventProperty(property);\n  });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {addEventListener, removeEventListener} from '../patch-events.js';\n\nexport const SlotPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {HTMLSlotElement}\n   * @param {Object=} options\n   */\n  assignedNodes(options) {\n    if (this.localName === 'slot') {\n      // Force any containing shadowRoot to flush so that distribution occurs\n      // and this node has assignedNodes.\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      if (root && utils.isShadyRoot(root)) {\n        root._render();\n      }\n      const nodeData = shadyDataForNode(this);\n      return nodeData\n        ? (options && options.flatten\n            ? nodeData.flattenedNodes\n            : nodeData.assignedNodes) || []\n        : [];\n    }\n  },\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    // NOTE, check if this is a `slot` because these patches are installed on\n    // Element where browsers don't have `<slot>`\n    if (this.localName !== 'slot' || type === 'slotchange') {\n      addEventListener.call(this, type, fn, optionsOrCapture);\n    } else {\n      if (typeof optionsOrCapture !== 'object') {\n        optionsOrCapture = {\n          capture: Boolean(optionsOrCapture),\n        };\n      }\n      const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n      if (!parent) {\n        throw new Error(\n          'ShadyDOM cannot attach event to slot unless it has a `parentNode`'\n        );\n      }\n      optionsOrCapture.__shadyTarget = this;\n      parent[utils.SHADY_PREFIX + 'addEventListener'](\n        type,\n        fn,\n        optionsOrCapture\n      );\n    }\n  },\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    // NOTE, check if this is a `slot` because these patches are installed on\n    // Element where browsers don't have `<slot>`\n    if (this.localName !== 'slot' || type === 'slotchange') {\n      removeEventListener.call(this, type, fn, optionsOrCapture);\n    } else {\n      if (typeof optionsOrCapture !== 'object') {\n        optionsOrCapture = {\n          capture: Boolean(optionsOrCapture),\n        };\n      }\n      const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n      if (!parent) {\n        throw new Error(\n          'ShadyDOM cannot attach event to slot unless it has a `parentNode`'\n        );\n      }\n      optionsOrCapture.__shadyTarget = this;\n      parent[utils.SHADY_PREFIX + 'removeEventListener'](\n        type,\n        fn,\n        optionsOrCapture\n      );\n    }\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\nimport {query} from './ParentNode.js';\n\nexport const DocumentOrFragmentPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {Element}\n   * @param {string} id\n   */\n  getElementById(id) {\n    if (id === '') {\n      return null;\n    }\n    let result = query(\n      this,\n      function (n) {\n        return n.id == id;\n      },\n      function (n) {\n        return Boolean(n);\n      }\n    )[0];\n    return result || null;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nfunction getDocumentActiveElement() {\n  if (utils.settings.hasDescriptors) {\n    return document[utils.NATIVE_PREFIX + 'activeElement'];\n  } else {\n    return document.activeElement;\n  }\n}\n\n// Get the element within the given set of roots.\nfunction getElInRoot(roots, el) {\n  let elRoot;\n  while (\n    el &&\n    !roots.has((elRoot = el[utils.SHADY_PREFIX + 'getRootNode']()))\n  ) {\n    el = elRoot.host;\n  }\n  return el;\n}\n\nfunction getAncestorRoots(docOrRoot) {\n  const roots = new Set();\n  roots.add(docOrRoot);\n  while (utils.isShadyRoot(docOrRoot) && docOrRoot.host) {\n    docOrRoot = docOrRoot.host[utils.SHADY_PREFIX + 'getRootNode']();\n    roots.add(docOrRoot);\n  }\n  return roots;\n}\n\nconst USE_NATIVE_DOCUMENT_EFP = 'useNativeDocumentEFP';\n\nconst elementsFromPointProperty =\n  utils.NATIVE_PREFIX +\n  utils.getPropertyName(Document.prototype, 'elementsFromPoint');\n\nexport const DocumentOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /** @this {Document|ShadowRoot} */\n  get activeElement() {\n    let active = getDocumentActiveElement();\n    // In IE11, activeElement might be an empty object if the document is\n    // contained in an iframe.\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10998788/\n    if (!active || !active.nodeType) {\n      return null;\n    }\n    let isShadyRoot = !!utils.isShadyRoot(this);\n    if (this !== document) {\n      // If this node isn't a document or shady root, then it doesn't have\n      // an active element.\n      if (!isShadyRoot) {\n        return null;\n      }\n      // If this shady root's host is the active element or the active\n      // element is not a descendant of the host (in the composed tree),\n      // then it doesn't have an active element.\n      if (\n        this.host === active ||\n        !this.host[utils.NATIVE_PREFIX + 'contains'](active)\n      ) {\n        return null;\n      }\n    }\n    // This node is either the document or a shady root of which the active\n    // element is a (composed) descendant of its host; iterate upwards to\n    // find the active element's most shallow host within it.\n    let activeRoot = ownerShadyRootForNode(active);\n    while (activeRoot && activeRoot !== this) {\n      active = activeRoot.host;\n      activeRoot = ownerShadyRootForNode(active);\n    }\n    if (this === document) {\n      // This node is the document, so activeRoot should be null.\n      return activeRoot ? null : active;\n    } else {\n      // This node is a non-document shady root, and it should be\n      // activeRoot.\n      return activeRoot === this ? active : null;\n    }\n  },\n\n  /** @this {Document|ShadowRoot} */\n  elementsFromPoint(x, y) {\n    const nativeResult = document[elementsFromPointProperty](x, y);\n    // support optionally opt-ing out for document\n    if (this === document && utils.settings[USE_NATIVE_DOCUMENT_EFP]) {\n      return nativeResult;\n    }\n    const nativeArray = utils.arrayFrom(nativeResult);\n    // Filter native result to return the element in this root\n    // OR an above root.\n    // Set containing this root and its ancestor roots.\n    const ancestorRoots = getAncestorRoots(this);\n    // Use a Set since the elements can repeat.\n    const rootedResult = new Set();\n    for (let i = 0; i < nativeArray.length; i++) {\n      rootedResult.add(getElInRoot(ancestorRoots, nativeArray[i]));\n    }\n    // Note, for IE compat avoid Array.from(set).\n    const r = [];\n    rootedResult.forEach((x) => r.push(x));\n    return r;\n  },\n\n  /** @this {Document|ShadowRoot} */\n  elementFromPoint(x, y) {\n    // support optionally opt-ing out for document\n    return this === document && utils.settings[USE_NATIVE_DOCUMENT_EFP]\n      ? this[utils.NATIVE_PREFIX + 'elementFromPoint'](x, y)\n      : this[utils.SHADY_PREFIX + 'elementsFromPoint'](x, y)[0] || null;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nconst doc = window.document;\n\nexport const DocumentPatches = utils.getOwnPropertyDescriptors({\n  // note: Though not technically correct, we fast path `importNode`\n  // when called on a node not owned by the main document.\n  // This allows, for example, elements that cannot\n  // contain custom elements and are therefore not likely to contain shadowRoots\n  // to cloned natively. This is a fairly significant performance win.\n  /**\n   * @this {Document}\n   * @param {Node} node\n   * @param {boolean} deep\n   */\n  importNode(node, deep) {\n    // A template element normally has no children with shadowRoots, so make\n    // sure we always make a deep copy to correctly construct the template.content\n    if (node.ownerDocument !== doc || node.localName === 'template') {\n      return this[utils.NATIVE_PREFIX + 'importNode'](node, deep);\n    }\n    let n = this[utils.NATIVE_PREFIX + 'importNode'](node, false);\n    if (deep) {\n      for (\n        let c = node[utils.SHADY_PREFIX + 'firstChild'], nc;\n        c;\n        c = c[utils.SHADY_PREFIX + 'nextSibling']\n      ) {\n        nc = this[utils.SHADY_PREFIX + 'importNode'](c, true);\n        n[utils.SHADY_PREFIX + 'appendChild'](nc);\n      }\n    }\n    return n;\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\n// prettier-ignore\nimport {addEventListener, removeEventListener, dispatchEvent} from '../patch-events.js';\n\nexport const WindowPatches = utils.getOwnPropertyDescriptors({\n  // Ensure that `dispatchEvent` is patched directly on Window since on\n  // IE11, Window does not descend from EventTarget.\n  dispatchEvent,\n\n  // NOTE: ensure these methods are bound to `window` so that `this` is correct\n  // when called directly from global context without a receiver; e.g.\n  // `addEventListener(...)`.\n  addEventListener: addEventListener.bind(window),\n\n  removeEventListener: removeEventListener.bind(window),\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {EventTargetPatches} from './patches/EventTarget.js';\nimport {NodePatches} from './patches/Node.js';\nimport {SlotablePatches} from './patches/Slotable.js';\n// prettier-ignore\nimport {ParentNodePatches, ParentNodeDocumentOrFragmentPatches} from './patches/ParentNode.js';\nimport {ChildNodePatches} from './patches/ChildNode.js';\nimport {ElementPatches, ElementShadowPatches} from './patches/Element.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {HTMLElementPatches} from './patches/HTMLElement.js';\nimport {SlotPatches} from './patches/Slot.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {DocumentPatches} from './patches/Document.js';\nimport {WindowPatches} from './patches/Window.js';\n\n// Some browsers (IE/Edge) have non-standard HTMLElement accessors.\nconst NonStandardHTMLElement = {};\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'parentElement')) {\n  NonStandardHTMLElement.parentElement = NodePatches.parentElement;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'contains')) {\n  NonStandardHTMLElement.contains = NodePatches.contains;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'children')) {\n  NonStandardHTMLElement.children = ParentNodePatches.children;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'innerHTML')) {\n  NonStandardHTMLElement.innerHTML = ElementOrShadowRootPatches.innerHTML;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'className')) {\n  NonStandardHTMLElement.className = ElementPatches.className;\n}\n\n// Avoid patching `innerHTML` if it does not exist on Element (IE)\n// and we can patch accessors (hasDescriptors).\nconst ElementShouldHaveInnerHTML =\n  !utils.settings.hasDescriptors || 'innerHTML' in Element.prototype;\n\n// setup patching\nconst patchMap = {\n  EventTarget: [EventTargetPatches],\n  Node: [NodePatches, !window.EventTarget ? EventTargetPatches : null],\n  Text: [SlotablePatches],\n  Comment: [SlotablePatches],\n  CDATASection: [SlotablePatches],\n  ProcessingInstruction: [SlotablePatches],\n  Element: [\n    ElementPatches,\n    ParentNodePatches,\n    ChildNodePatches,\n    SlotablePatches,\n    ElementShouldHaveInnerHTML ? ElementOrShadowRootPatches : null,\n    !window.HTMLSlotElement ? SlotPatches : null,\n  ],\n  HTMLElement: [HTMLElementPatches, NonStandardHTMLElement],\n  HTMLSlotElement: [SlotPatches],\n  DocumentFragment: [\n    ParentNodeDocumentOrFragmentPatches,\n    DocumentOrFragmentPatches,\n  ],\n  Document: [\n    DocumentPatches,\n    ParentNodeDocumentOrFragmentPatches,\n    DocumentOrFragmentPatches,\n    DocumentOrShadowRootPatches,\n  ],\n  Window: [WindowPatches],\n  CharacterData: [ChildNodePatches],\n  XMLHttpRequest: [!window.EventTarget ? EventTargetPatches : null],\n};\n\nconst getPatchPrototype = (name) => window[name] && window[name].prototype;\n\n// Note, must avoid patching accessors on prototypes when descriptors are not correct\n// because the CustomElements polyfill checks if these exist before patching instances.\n// CustomElements polyfill *only* cares about these accessors.\nconst disallowedNativePatches = utils.settings.hasDescriptors\n  ? null\n  : ['innerHTML', 'textContent'];\n\n/**\n * Patch a group of accessors on an object.\n * @param {!Object} proto\n * @param {!Array<Object>} list\n * @param {string=} prefix\n * @param {Array=} disallowed\n */\nfunction applyPatchList(proto, list, prefix, disallowed) {\n  list.forEach(\n    (patch) =>\n      proto && patch && utils.patchProperties(proto, patch, prefix, disallowed)\n  );\n}\n\n/** @param {string=} prefix */\nexport const applyPatches = (prefix) => {\n  const disallowed = prefix ? null : disallowedNativePatches;\n  for (let p in patchMap) {\n    const proto = getPatchPrototype(p);\n    applyPatchList(proto, patchMap[p], prefix, disallowed);\n  }\n};\n\nconst PROTO_IS_PATCHED = utils.SHADY_PREFIX + 'protoIsPatched';\n\n// This property is stored directly on these objects, rather than in a local\n// Map, because IE11 has a bug around `defineProperty`/`hasOwnProperty` which\n// breaks Closure Compiler's WeakMap polyfill when using both certain native\n// prototypes (e.g. of CDATASection) and their instances as keys - even if\n// they're isolated to different WeakMaps. Closure's WeakMap polyfill is used\n// transitively by its own Map and Set polyfills, so this bug applies to any\n// situation where either of Map or Set are polyfilled also.\nconst PATCHED_PROTO = utils.SHADY_PREFIX + 'patchedProto';\n\n// Patch non-element prototypes up front so that we don't have to check\n// the type of Node when patching an can always assume we're patching an element.\n['Text', 'Comment', 'CDATASection', 'ProcessingInstruction'].forEach((name) => {\n  const ctor = window[name];\n  const patchedProto = Object.create(ctor.prototype);\n  patchedProto[PROTO_IS_PATCHED] = true;\n  applyPatchList(patchedProto, patchMap.EventTarget);\n  applyPatchList(patchedProto, patchMap.Node);\n  if (patchMap[name]) {\n    applyPatchList(patchedProto, patchMap[name]);\n  }\n  ctor.prototype[PATCHED_PROTO] = patchedProto;\n});\n\nexport const patchElementProto = (proto) => {\n  proto[PROTO_IS_PATCHED] = true;\n  applyPatchList(proto, patchMap.EventTarget);\n  applyPatchList(proto, patchMap.Node);\n  applyPatchList(proto, patchMap.Element);\n  applyPatchList(proto, patchMap.HTMLElement);\n  applyPatchList(proto, patchMap.HTMLSlotElement);\n  return proto;\n};\n\nexport const patchNodeProto = (node) => {\n  if (node[PROTO_IS_PATCHED] || utils.isShadyRoot(node)) {\n    return;\n  }\n  const nativeProto = Object.getPrototypeOf(node);\n  // Note, this hasOwnProperty check is critical to avoid seeing a patched\n  // prototype lower in the prototype chain, e.g. if an <s> element has been\n  // patched, without this check, an <input> element would get the wrong patch.\n  let proto =\n    nativeProto.hasOwnProperty(PATCHED_PROTO) && nativeProto[PATCHED_PROTO];\n  if (!proto) {\n    proto = Object.create(nativeProto);\n    patchElementProto(proto);\n    nativeProto[PATCHED_PROTO] = proto;\n  }\n  Object.setPrototypeOf(node, proto);\n};\n\nexport const patchShadowOnElement = () => {\n  utils.patchProperties(Element.prototype, ElementShadowPatches);\n};\n\nexport const addShadyPrefixedProperties = () => {\n  // perform shady patches\n  applyPatches(utils.SHADY_PREFIX);\n\n  // install `_activeElement` because some browsers (older Chrome/Safari) do not have\n  // a 'configurable' `activeElement` accesssor.\n  const descriptor = DocumentOrShadowRootPatches.activeElement;\n  Object.defineProperty(document, '_activeElement', descriptor);\n\n  // On Window, we're patching `addEventListener` which is a weird auto-bound\n  // property that is not directly on the Window prototype.\n  utils.patchProperties(Window.prototype, WindowPatches, utils.SHADY_PREFIX);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\n// prettier-ignore\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchNodeProto} from './patch-prototypes.js';\n\nconst OutsideAccessors = 1;\nconst InsideAcccessors = 2;\n\nconst patchOnDemand = utils.settings.patchOnDemand;\nconst hasDescriptors = utils.settings.hasDescriptors;\n\nfunction patchNode(node, type) {\n  if (patchOnDemand) {\n    patchNodeProto(node);\n  }\n  if (!hasDescriptors) {\n    if (type === OutsideAccessors) {\n      patchOutsideElementAccessors(node);\n    } else if (type === InsideAcccessors) {\n      patchInsideElementAccessors(node);\n    }\n  }\n}\n\nfunction linkNode(node, container, containerData, ref_node) {\n  patchNode(node, OutsideAccessors);\n  ref_node = ref_node || null;\n  const nodeData = ensureShadyDataForNode(node);\n  const ref_nodeData = ref_node ? ensureShadyDataForNode(ref_node) : null;\n  // update ref_node.previousSibling <-> node\n  nodeData.previousSibling = ref_node\n    ? ref_nodeData.previousSibling\n    : container[utils.SHADY_PREFIX + 'lastChild'];\n  let psd = shadyDataForNode(nodeData.previousSibling);\n  if (psd) {\n    psd.nextSibling = node;\n  }\n  // update node <-> ref_node\n  let nsd = shadyDataForNode((nodeData.nextSibling = ref_node));\n  if (nsd) {\n    nsd.previousSibling = node;\n  }\n  // update node <-> container\n  nodeData.parentNode = container;\n  if (ref_node) {\n    if (ref_node === containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  } else {\n    containerData.lastChild = node;\n    if (!containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  }\n  // remove caching of childNodes\n  containerData.childNodes = null;\n}\n\nexport const recordInsertBefore = (node, container, ref_node) => {\n  patchNode(container, InsideAcccessors);\n  const containerData = ensureShadyDataForNode(container);\n  if (containerData.firstChild !== undefined) {\n    containerData.childNodes = null;\n  }\n  // handle document fragments\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // Note, documentFragments should not have logical DOM so there's\n    // no need update that. It is possible to append a ShadowRoot, but we're\n    // choosing not to support that.\n    const first = node[utils.NATIVE_PREFIX + 'firstChild'];\n    for (let n = first; n; n = n[utils.NATIVE_PREFIX + 'nextSibling']) {\n      linkNode(n, container, containerData, ref_node);\n    }\n  } else {\n    linkNode(node, container, containerData, ref_node);\n  }\n};\n\nexport const recordRemoveChild = (node, container) => {\n  const nodeData = ensureShadyDataForNode(node);\n  const containerData = ensureShadyDataForNode(container);\n  if (node === containerData.firstChild) {\n    containerData.firstChild = nodeData.nextSibling;\n  }\n  if (node === containerData.lastChild) {\n    containerData.lastChild = nodeData.previousSibling;\n  }\n  let p = nodeData.previousSibling;\n  let n = nodeData.nextSibling;\n  if (p) {\n    ensureShadyDataForNode(p).nextSibling = n;\n  }\n  if (n) {\n    ensureShadyDataForNode(n).previousSibling = p;\n  }\n  // When an element is removed, logical data is no longer tracked.\n  // Explicitly set `undefined` here to indicate this. This is disginguished\n  // from `null` which is set if info is null.\n  nodeData.parentNode = nodeData.previousSibling = nodeData.nextSibling = undefined;\n  if (containerData.childNodes !== undefined) {\n    // remove caching of childNodes\n    containerData.childNodes = null;\n  }\n};\n\n/**\n * @param  {!Node|DocumentFragment} node\n * @param  {!Node|DocumentFragment=} adoptedParent\n */\nexport const recordChildNodes = (node, adoptedParent) => {\n  const nodeData = ensureShadyDataForNode(node);\n  if (!adoptedParent && nodeData.firstChild !== undefined) {\n    return;\n  }\n  // remove caching of childNodes\n  nodeData.childNodes = null;\n  const first = (nodeData.firstChild =\n    node[utils.NATIVE_PREFIX + 'firstChild']);\n  nodeData.lastChild = node[utils.NATIVE_PREFIX + 'lastChild'];\n  patchNode(node, InsideAcccessors);\n  for (let n = first, previous; n; n = n[utils.NATIVE_PREFIX + 'nextSibling']) {\n    const sd = ensureShadyDataForNode(n);\n    sd.parentNode = adoptedParent || node;\n    sd.nextSibling = n[utils.NATIVE_PREFIX + 'nextSibling'];\n    sd.previousSibling = previous || null;\n    previous = n;\n    patchNode(n, OutsideAccessors);\n  }\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ShadowRootPatches = utils.getOwnPropertyDescriptors({\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture),\n      };\n    }\n    // Note, `__shadyTarget` may already be set if an event was added on a <slot> child\n    optionsOrCapture.__shadyTarget = optionsOrCapture.__shadyTarget || this;\n    this.host[utils.SHADY_PREFIX + 'addEventListener'](\n      type,\n      fn,\n      optionsOrCapture\n    );\n  },\n\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture),\n      };\n    }\n    // Note, `__shadyTarget` may already be set if an event was added on a <slot> child\n    optionsOrCapture.__shadyTarget = optionsOrCapture.__shadyTarget || this;\n    this.host[utils.SHADY_PREFIX + 'removeEventListener'](\n      type,\n      fn,\n      optionsOrCapture\n    );\n  },\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {NodePatches} from './patches/Node.js';\n// prettier-ignore\nimport {OutsideDescriptors, InsideDescriptors, TextContentInnerHTMLDescriptors} from './patch-instances.js';\nimport {ParentNodePatches} from './patches/ParentNode.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {ShadowRootPatches} from './patches/ShadowRoot.js';\n\n/**\n * @param {!Object} proto\n * @param {string=} prefix\n */\nconst patchShadyAccessors = (proto, prefix) => {\n  utils.patchProperties(proto, ShadowRootPatches, prefix);\n  utils.patchProperties(proto, DocumentOrShadowRootPatches, prefix);\n  utils.patchProperties(proto, ElementOrShadowRootPatches, prefix);\n  // We ensure ParentNode accessors since these do not exist in Edge/IE on DocumentFragments.\n  utils.patchProperties(proto, ParentNodePatches, prefix);\n  // Ensure `shadowRoot` has basic descriptors when we cannot rely\n  // on them coming from DocumentFragment.\n  //\n  // Case 1, noPatching: Because we want noPatch ShadyRoots to have native property\n  // names so that they do not have to be wrapped...\n  // When we do *not* patch Node/DocumentFragment.prototype\n  // we must manually install those properties on ShadyRoot's prototype.\n  // Note, it's important to only install these in this mode so as not to stomp\n  // over CustomElements polyfill's patches on Node/DocumentFragment methods.\n  if (utils.settings.noPatch && !prefix) {\n    utils.patchProperties(proto, NodePatches, prefix);\n    utils.patchProperties(proto, DocumentOrFragmentPatches, prefix);\n  }\n  // Case 2, bad descriptors: Ensure accessors are on ShadowRoot.\n  // These descriptors are normally used for instance patching but because\n  // ShadyRoot can always be patched, just do it to the prototype.\n  else if (!utils.settings.hasDescriptors) {\n    utils.patchProperties(proto, OutsideDescriptors);\n    utils.patchProperties(proto, InsideDescriptors);\n    utils.patchProperties(proto, TextContentInnerHTMLDescriptors);\n  }\n};\n\nexport const patchShadyRoot = (proto) => {\n  proto.__proto__ = DocumentFragment.prototype;\n\n  // patch both prefixed and not, even when noPatch == true.\n  patchShadyAccessors(proto, utils.SHADY_PREFIX);\n  patchShadyAccessors(proto);\n\n  // Ensure native properties are all safely wrapped since ShadowRoot is not an\n  // actual DocumentFragment instance.\n  Object.defineProperties(proto, {\n    nodeType: {\n      value: Node.DOCUMENT_FRAGMENT_NODE,\n      configurable: true,\n    },\n    nodeName: {\n      value: '#document-fragment',\n      configurable: true,\n    },\n    nodeValue: {\n      value: null,\n      configurable: true,\n    },\n  });\n\n  // make undefined\n  ['localName', 'namespaceURI', 'prefix'].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      value: undefined,\n      configurable: true,\n    });\n  });\n\n  // defer properties to host\n  ['ownerDocument', 'baseURI', 'isConnected'].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      /** @this {ShadowRoot} */\n      get() {\n        return this.host[prop];\n      },\n      configurable: true,\n    });\n  });\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n// prettier-ignore\nimport {eventPropertyNamesForElement, eventPropertyNamesForHTMLElement} from './patch-events.js';\n\n/** @implements {IWrapper} */\nclass Wrapper {\n  /** @param {!Node} node */\n  constructor(node) {\n    this.node = node;\n  }\n\n  // node\n  addEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'addEventListener'](\n      name,\n      fn,\n      options\n    );\n  }\n\n  removeEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'removeEventListener'](\n      name,\n      fn,\n      options\n    );\n  }\n\n  appendChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'appendChild'](node);\n  }\n\n  insertBefore(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n  }\n\n  removeChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'removeChild'](node);\n  }\n\n  replaceChild(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChild'](node, ref_node);\n  }\n\n  cloneNode(deep) {\n    return this.node[utils.SHADY_PREFIX + 'cloneNode'](deep);\n  }\n\n  getRootNode(options) {\n    return this.node[utils.SHADY_PREFIX + 'getRootNode'](options);\n  }\n\n  contains(node) {\n    return this.node[utils.SHADY_PREFIX + 'contains'](node);\n  }\n\n  dispatchEvent(event) {\n    return this.node[utils.SHADY_PREFIX + 'dispatchEvent'](event);\n  }\n\n  // element\n  setAttribute(name, value) {\n    this.node[utils.SHADY_PREFIX + 'setAttribute'](name, value);\n  }\n\n  // NOTE: not needed, just here for balance\n  getAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'getAttribute'](name);\n  }\n\n  // NOTE: not needed, just here for balance\n  hasAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'hasAttribute'](name);\n  }\n\n  removeAttribute(name) {\n    this.node[utils.SHADY_PREFIX + 'removeAttribute'](name);\n  }\n\n  toggleAttribute(name, force) {\n    return this.node[utils.SHADY_PREFIX + 'toggleAttribute'](name, force);\n  }\n\n  attachShadow(options) {\n    return this.node[utils.SHADY_PREFIX + 'attachShadow'](options);\n  }\n\n  /** @return {!Node|undefined} */\n  get activeElement() {\n    if (\n      utils.isShadyRoot(this.node) ||\n      this.node.nodeType === Node.DOCUMENT_NODE\n    ) {\n      const e = this.node[utils.SHADY_PREFIX + 'activeElement'];\n      return e;\n    }\n    return undefined;\n  }\n\n  /**\n   * Installed for compatibility with browsers (older Chrome/Safari) that do\n   * not have a configurable `activeElement` accessor. Enables noPatch and\n   * patch mode both to consistently use ShadyDOM.wrap(document)._activeElement.\n   * @override\n   * @return {!Node|undefined}\n   */\n  get _activeElement() {\n    return this.activeElement;\n  }\n\n  // NOTE: not needed, just here for balance\n  /** @override */\n  focus() {\n    this.node[utils.NATIVE_PREFIX + 'focus']();\n  }\n\n  blur() {\n    this.node[utils.SHADY_PREFIX + 'blur']();\n  }\n\n  // document\n  importNode(node, deep) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'importNode'](node, deep);\n    }\n  }\n\n  getElementById(id) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'getElementById'](id);\n    }\n  }\n\n  elementsFromPoint(x, y) {\n    return this.node[utils.SHADY_PREFIX + 'elementsFromPoint'](x, y);\n  }\n\n  elementFromPoint(x, y) {\n    return this.node[utils.SHADY_PREFIX + 'elementFromPoint'](x, y);\n  }\n\n  // query\n  querySelector(selector) {\n    return this.node[utils.SHADY_PREFIX + 'querySelector'](selector);\n  }\n\n  querySelectorAll(selector, useNative) {\n    return this.node[utils.SHADY_PREFIX + 'querySelectorAll'](\n      selector,\n      useNative\n    );\n  }\n\n  // slot\n  assignedNodes(options) {\n    if (this.node.localName === 'slot') {\n      return this.node[utils.SHADY_PREFIX + 'assignedNodes'](options);\n    }\n  }\n\n  get host() {\n    if (utils.isShadyRoot(this.node)) {\n      return /** @type {!ShadowRoot} */ (this.node).host;\n    }\n    return undefined;\n  }\n\n  get parentNode() {\n    return this.node[utils.SHADY_PREFIX + 'parentNode'];\n  }\n\n  get firstChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstChild'];\n  }\n\n  get lastChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastChild'];\n  }\n\n  get nextSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextSibling'];\n  }\n\n  get previousSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousSibling'];\n  }\n\n  get childNodes() {\n    return this.node[utils.SHADY_PREFIX + 'childNodes'];\n  }\n\n  get parentElement() {\n    return this.node[utils.SHADY_PREFIX + 'parentElement'];\n  }\n\n  get firstElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstElementChild'];\n  }\n\n  get lastElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastElementChild'];\n  }\n\n  get nextElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextElementSibling'];\n  }\n\n  get previousElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousElementSibling'];\n  }\n\n  get children() {\n    return this.node[utils.SHADY_PREFIX + 'children'];\n  }\n\n  get childElementCount() {\n    return this.node[utils.SHADY_PREFIX + 'childElementCount'];\n  }\n\n  get shadowRoot() {\n    return this.node[utils.SHADY_PREFIX + 'shadowRoot'];\n  }\n\n  get assignedSlot() {\n    return this.node[utils.SHADY_PREFIX + 'assignedSlot'];\n  }\n\n  get isConnected() {\n    return this.node[utils.SHADY_PREFIX + 'isConnected'];\n  }\n\n  get innerHTML() {\n    return this.node[utils.SHADY_PREFIX + 'innerHTML'];\n  }\n\n  set innerHTML(value) {\n    this.node[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  }\n\n  get textContent() {\n    return this.node[utils.SHADY_PREFIX + 'textContent'];\n  }\n\n  set textContent(value) {\n    this.node[utils.SHADY_PREFIX + 'textContent'] = value;\n  }\n\n  get slot() {\n    return this.node[utils.SHADY_PREFIX + 'slot'];\n  }\n\n  set slot(value) {\n    this.node[utils.SHADY_PREFIX + 'slot'] = value;\n  }\n\n  get className() {\n    return this.node[utils.SHADY_PREFIX + 'className'];\n  }\n\n  set className(value) {\n    this.node[utils.SHADY_PREFIX + 'className'] = value;\n  }\n\n  append(...args) {\n    return this.node[utils.SHADY_PREFIX + 'append'](...args);\n  }\n\n  prepend(...args) {\n    return this.node[utils.SHADY_PREFIX + 'prepend'](...args);\n  }\n\n  replaceChildren(...args) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChildren'](...args);\n  }\n\n  after(...args) {\n    return this.node[utils.SHADY_PREFIX + 'after'](...args);\n  }\n\n  before(...args) {\n    return this.node[utils.SHADY_PREFIX + 'before'](...args);\n  }\n\n  remove() {\n    return this.node[utils.SHADY_PREFIX + 'remove']();\n  }\n\n  replaceWith(...args) {\n    return this.node[utils.SHADY_PREFIX + 'replaceWith'](...args);\n  }\n}\n\nconst addEventPropertyWrapper = (name) => {\n  Object.defineProperty(Wrapper.prototype, name, {\n    /** @this {Wrapper} */\n    get() {\n      return this.node[utils.SHADY_PREFIX + name];\n    },\n    /** @this {Wrapper} */\n    set(value) {\n      this.node[utils.SHADY_PREFIX + name] = value;\n    },\n    configurable: true,\n  });\n};\n\neventPropertyNamesForElement.forEach((name) => addEventPropertyWrapper(name));\neventPropertyNamesForHTMLElement.forEach((name) =>\n  addEventPropertyWrapper(name)\n);\n\nexport {Wrapper};\n\nconst wrapperMap = new WeakMap();\n\nexport function wrap(obj) {\n  if (utils.isShadyRoot(obj) || obj instanceof Wrapper) {\n    return obj;\n  }\n  let wrapper = wrapperMap.get(obj);\n  if (!wrapper) {\n    wrapper = new Wrapper(obj);\n    wrapperMap.set(obj, wrapper);\n  }\n  return wrapper;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nimport * as utils from './utils.js';\nimport {flush, enqueue} from './flush.js';\n// prettier-ignore\nimport {observeChildren, unobserveChildren, filterMutations} from './observe-changes.js';\n// prettier-ignore\nimport {addNativePrefixedProperties, nativeMethods, nativeTree} from './patch-native.js';\n// prettier-ignore\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchEvents, patchClick, composedPath} from './patch-events.js';\nimport {ShadyRoot} from './attach-shadow.js';\nimport {wrap, Wrapper} from './wrapper.js';\n// prettier-ignore\nimport {addShadyPrefixedProperties, applyPatches, patchShadowOnElement, patchElementProto} from './patch-prototypes.js';\n\nif (utils.settings.inUse) {\n  const patch = utils.settings.hasDescriptors\n    ? (n) => n\n    : (node) => {\n        patchInsideElementAccessors(node);\n        patchOutsideElementAccessors(node);\n        return node;\n      };\n\n  let ShadyDOM = {\n    // TODO(sorvell): remove when Polymer does not depend on this.\n    'inUse': utils.settings.inUse,\n    // NOTE: old browsers without prototype accessors (very old Chrome\n    // and Safari) need manually patched accessors to properly set\n    // `innerHTML` and `textContent` when an element is:\n    // (1) inside a shadowRoot\n    // (2) does not have special (slot) children itself\n    // (3) and setting the property needs to provoke distribution (because\n    // a nested slot is added/removed)\n    'patch': patch,\n    'isShadyRoot': utils.isShadyRoot,\n    'enqueue': enqueue,\n    'flush': flush,\n    'flushInitial': (root) => {\n      root._flushInitial();\n    },\n    'settings': utils.settings,\n    'filterMutations': filterMutations,\n    'observeChildren': observeChildren,\n    'unobserveChildren': unobserveChildren,\n    // Set to true to defer native custom elements connection until the\n    // document has fully parsed. This enables custom elements that create\n    // shadowRoots to be defined while the document is loading. Elements\n    // customized as they are created by the parser will successfully\n    // render with this flag on.\n    'deferConnectionCallbacks': utils.settings['deferConnectionCallbacks'],\n    // Set to true to speed up the polyfill slightly at the cost of correctness\n    // * does not patch querySelector/All on Document or DocumentFragment\n    // * does not wrap connected/disconnected callbacks to de-dup these\n    // when using native customElements\n    // * does not wait to process children of elements with shadowRoots\n    // meaning shadowRoots should not be created while an element is parsing\n    // (e.g. if a custom element that creates a shadowRoot is defined before\n    // a candidate element in the document below it.\n    'preferPerformance': utils.settings['preferPerformance'],\n    // Integration point with ShadyCSS to disable styling MutationObserver,\n    // as ShadyDOM will now handle dynamic scoping.\n    'handlesDynamicScoping': true,\n    // Ensure the node is wrapped. This should be used when `noPatch` is set\n    // to ensure Shadow DOM compatible DOM operation.\n    // Note, wrap falls back to patch so that it ensures API \"always just works\"\n    'wrap': utils.settings.noPatch ? wrap : patch,\n    // When code should be compatible with `noPatch` `true` and `on-demand`\n    // settings, `wrapIfNeeded` can be used for optimal performance (v. `wrap`)\n    // for all DOM operations except the following: `appendChild` and\n    // `insertBefore` (when the node is being moved from a location where it\n    // was logically positioned in the DOM); when setting `className`/`class`;\n    // when calling `querySelector|All`; when setting `textContent` or\n    // `innerHTML`; `addEventListener`, `removeEventListener` and\n    // `dispatchEvent`; and all scope specific API's like `getRootNode`,\n    // `isConnected`, `slot`, `assignedSlot`, `assignedNodes`. Note,\n    // `wrapIfNeeded` falls back to a pass through to preserve optimal\n    // performance.\n    'wrapIfNeeded': utils.settings.noPatch === true ? wrap : (n) => n,\n    'Wrapper': Wrapper,\n    'composedPath': composedPath,\n    // Set to true to avoid patching regular platform property names. When set,\n    // Shadow DOM compatible behavior is only available when accessing DOM\n    // API using `ShadyDOM.wrap`, e.g. `ShadyDOM.wrap(element).shadowRoot`.\n    // This setting provides a small performance boost, but requires all DOM API\n    // access that requires Shadow DOM behavior to be proxied via `ShadyDOM.wrap`.\n    //\n    // WARNING: When `noPatch` is set and the Custom Elements polyfill is\n    // needed, the Custom Elements polyfill must be loaded before this\n    // polyfill; however, when `noPatch` is not used, this polyfill should be\n    // loaded before the Custom Elements polyfill. This is because\n    // ShadyDOM captures DOM mutation methods and when `noPatch` is used,\n    // ShadyDOM must call the mutation methods patched by the Custom Elements\n    // polyfill or custom elements will not function as expected. When `noPatch`\n    // is not used, the Custom Elements polyfill patches call through to the\n    // ShadyDOM patches so ShadyDOM should be loaded first.\n    'noPatch': utils.settings.noPatch,\n    'patchOnDemand': utils.settings.patchOnDemand,\n    'nativeMethods': nativeMethods,\n    'nativeTree': nativeTree,\n    'patchElementProto': patchElementProto,\n    // Use this setting to choose the implementation of `querySelector` and\n    // `querySelectorAll`. The options provide different tradeoffs between\n    // accuracy and performance, as explained below. More specifically, the\n    // logical tree exposed by Shady DOM through the DOM APIs it wraps doesn't\n    // match the structure of the tree seen by the browser (the 'real tree'), so\n    // the degree to which the browser itself is used to match selectors affects\n    // this tradeoff.\n    //\n    // - `undefined` (default): Shady DOM will walk the logical descendants of\n    // the context element and call `matches` with the given selector to find\n    // matching elements.\n    //\n    //   This option is a balance between accuracy and performance. This option\n    //   will be able to match all logical descendants of the context element\n    //   (i.e. including descendants of unassigned nodes) but selectors are\n    //   matched against the real tree, so complex selectors may fail to match\n    //   since their combinators will attempt to match against the structure of\n    //   the real tree. Generally, you should only pass compound selectors when\n    //   using the default implementation. This implementation also breaks the\n    //   semantics of `:scope` because the wrapped `querySelector` call is\n    //   translated into many `matches` calls on different elements.\n    //\n    // - `'native'`: Shady DOM's wrapper for (e.g.) `querySelector` will call\n    // into the native `querySelector` function and then filter out results that\n    // are not in the same shadow root in the logical tree.\n    //\n    //   This is the fastest option. This option will not match elements that\n    //   are logical descendants of unassigned nodes because they will not be in\n    //   the real tree, against which the browser matches the selector. Like the\n    //   default option, this option may not correctly match complex selectors\n    //   (i.e. those with combinators) due to the structural differences between\n    //   the real tree and the logical tree. This option preserves the semantics\n    //   of `:scope` because the context element of the call to the wrapper is\n    //   also the context element of the call to the native function.\n    //\n    // - `'selectorEngine'`: Shady DOM's wrapper for (e.g.) `querySelector` will\n    // partially parse the given selector list and perform the tree-traversal\n    // steps of a selector engine against the logical tree.\n    //\n    //   This is the slowest and most accurate option. This option is able to\n    //   find all logical descendants of the context element by manually walking\n    //   the tree. This option is also able to correctly match complex selectors\n    //   because it does not rely on the browser to handle combinators. Despite\n    //   using `matches` to match compound selectors during selector evaluation,\n    //   this option preserves the semantics of `:scope` by only considering\n    //   compound selectors containing `:scope` to be matching if the context\n    //   element of the `matches` call is also the context element of the\n    //   wrapper call.\n    //\n    //   However, the parser used for this option is not strictly correct.\n    //   Notable caveats include:\n    //\n    //     - The parser assumes the selector list it's given is syntactically\n    //     correct. When given a selector that would not parse under a full\n    //     implementation, this implementation may fail silently.\n    //\n    //     - Nested selectors are _not_ taken into consideration while walking\n    //     the tree. Each outer-most compound selector is tested against\n    //     candidate elements as a whole, without modification. This means that\n    //     selectors nested in arguments of functional pseudo-classes, such as\n    //     `a > b` in `:is(a > b)`, are still matched by the browser against the\n    //     real tree, not Shady DOM's logical tree.\n    //\n    //     - `:scope` is only supported at the top-level. Particularly, if the\n    //     text `:scope` appears anywhere within a compound selector, then the\n    //     selector engine will only allow that compound selector to match the\n    //     context element. Having the text `:scope` inside a string\n    //     (`x[y=\":scope\"]`) or an argument to a functional pseudo-selector\n    //     (`:not(:scope > x)`) will likely break your selector.\n    //\n    //     - The `:host` and `:host-context` pseudo-classes are not supported.\n    //\n    //     - Comments are not supported. (e.g. `a /* b */ c`)\n    //\n    //     - The (draft) column combinator is not supported. (e.g. `a || b`)\n    'querySelectorImplementation':\n      utils.settings['querySelectorImplementation'],\n  };\n\n  window['ShadyDOM'] = ShadyDOM;\n\n  // Modifies native prototypes for Node, Element, etc. to\n  // make native platform behavior available at prefixed names, e.g.\n  // `utils.NATIVE_PREFIX + 'firstChild'` or `__shady_native_firstChild`.\n  // This allows the standard names to be safely patched while retaining the\n  // ability for native behavior to be used. This polyfill manipulates DOM\n  // by using this saved native behavior.\n  // Note, some browsers do not have proper element descriptors for\n  // accessors; in this case, native behavior for these accessors is simulated\n  // via a TreeWalker.\n  addNativePrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to make ShadowDOM\n  // behavior available at prefixed names, e.g.\n  // `utils.SHADY_PREFIX + 'firstChild` or `__shady_firstChild`. This is done\n  // so this polyfill can perform Shadow DOM style DOM manipulation.\n  // Because patching normal platform property names is optional, these prefixed\n  // names are used internally.\n  addShadyPrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to patch\n  // regular platform property names to have Shadow DOM compatible API behavior.\n  // This applies the utils.SHADY_PREFIX behavior to normal names. For example,\n  // if `noPatch` is not set, then `el.__shady_firstChild` is equivalent to\n  // `el.firstChild`.\n  // NOTE, on older browsers (old Chrome/Safari) native accessors cannot be\n  // patched on prototypes (e.g. Node.prototype.firstChild cannot be modified).\n  // On these browsers, instance level patching is performed where needed; this\n  // instance patching is only done when `noPatch` is *not* set.\n  if (!utils.settings.noPatch) {\n    applyPatches();\n    // Patch click event behavior only if we're patching\n    patchClick();\n  } else if (utils.settings.patchOnDemand) {\n    // In `on-demand` patching, do patch `attachShadow` and `shadowRoot`.\n    // These are the only patched properties in `on-demand` mode and these\n    // patches kick off patching \"on-demand\" for other nodes.\n    patchShadowOnElement();\n  }\n\n  // For simplicity, patch events unconditionally.\n  // Patches the event system to have Shadow DOM compatible behavior (e.g.\n  // event retargeting). When `noPatch` is set, retargeting is only available\n  // when adding event listeners and dispatching events via `ShadyDOM.wrap`\n  // (e.g. `ShadyDOM.wrap(element).addEventListener(...)`).\n  patchEvents();\n\n  window.ShadowRoot = /** @type {function(new:ShadowRoot)} */ (ShadyRoot);\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n"],"sourceRoot":""}